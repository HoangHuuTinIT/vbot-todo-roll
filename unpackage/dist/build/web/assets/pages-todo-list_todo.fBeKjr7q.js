import{u as e,r as a,a as t,c as l,o,b as s,$ as n,d as u,e as r,s as i,f as c,h as d,g,n as v,T as f,i as m,j as p,k as A,l as h,w as C,m as y,t as k,p as _,q as T,v as P,x as b,y as L,z as O,A as S,B as x,C as M,D,E as U,F as E,G as R,H as F,I,J as w,K as N,L as Q,M as z,N as B,O as Y,P as q,S as V,Q as G,R as J,U as H}from"./index-oCJZCX07.js";import{b as Z,g as K,a as X,s as $,T as j,u as W,c as ee,d as ae,_ as te,A as le,e as oe,G as se,f as ne,h as ue}from"./GlobalNotification.BIU3JjIo.js";import{_ as re,C as ie}from"./ConfirmModal.0th1WrSn.js";import{u as ce,_ as de,D as ge,C as ve}from"./useCustomerFilter.kBqJJNiQ.js";const fe=()=>{const{t:p}=e(),A=a([]),h=a([]),C=e=>{const a=`[${(new Date).toLocaleTimeString()}] ${e}`;console.log(a),h.value.unshift(a),h.value.length>50&&h.value.pop()};let y=0;const{startPage:k,pageNo:_,pageSize:T,totalCount:P,totalPages:b,activePage:L,resetPagination:O}=((e=15)=>{const t=a(1),o=a(1),s=a(e),n=a(0),u=a(1),r=l((()=>0===n.value?1:Math.ceil(n.value/s.value)));return{startPage:t,pageNo:o,pageSize:s,totalCount:n,totalPages:r,activePage:u,resetPagination:()=>{t.value=1,o.value=1,u.value=1,n.value=0}}})(15),S=a(!1),x=a(!1),M=a(!1),D=a(!1),U=a(!1);t();const E=a(!1),R=a([]),F=a(!1),I=a(!1),w=a(""),N=a(!1),Q=a(null),z=l((()=>[p("common.all"),p("todo.status_todo"),p("todo.status_progress"),p("todo.status_done"),p("todo.status_overdue")])),B=["",j.NEW,j.IN_PROGRESS,j.DONE,j.OVERDUE],Y=a(0),q=a([]),V=l((()=>{const e=q.value.map((e=>e.UserName||p("common.unknown_member")));return[p("common.all"),...e]})),G=a(0),J=l((()=>{const e=q.value.map((e=>e.UserName||p("common.hidden_member")));return[p("common.all"),...e]})),H=a(0),te=l((()=>[p("common.all"),p("source.call"),p("source.customer"),p("source.conversation"),p("source.message")])),le=["",f.CALL,f.CUSTOMER,f.CONVERSATION,f.CHAT_MESSAGE],oe=a(0),se=a({title:"",jobCode:"",createdFrom:"",createdTo:"",dueDateFrom:"",dueDateTo:"",customerCode:"",notifyFrom:"",notifyTo:""}),ne=async()=>{if(!(q.value.length>0))try{const e=await m();q.value=e}catch(e){console.error("Lỗi lấy danh sách thành viên filter:",e)}},{customerList:ue,loadingCustomer:re,loadingMore:ie,fetchCustomers:de,loadMoreCustomers:ge}=ce(),ve=async(e="init")=>{if(console.log(`[getTodoList] Called with direction=${e}. isLoadingPrev=${M.value}, startPage=${k.value}, pageNo=${_.value}`),"next"===e&&(x.value||_.value>b.value))return;if("prev"===e&&(M.value||k.value<=1))return void C(`[getTodoList] SKIPPING prev load: isLoadingPrev=${M.value}, startPage=${k.value}`);let a;"next"===e?x.value=!0:"prev"===e?M.value=!0:(S.value=!0,A.value=[]);try{a=y;let t=1;if(t="next"===e?_.value:"prev"===e?k.value-1:_.value,a!==y)return;let l="";if(G.value>0){l=q.value[G.value-1].memberUID||""}let o="";if(H.value>0){o=q.value[H.value-1].memberUID||""}const s=Z(se.value,B[Y.value],le[oe.value],l,o),[n,u]=await Promise.all([K({...s,pageNo:t,pageSize:T.value}),"init"===e||0===P.value?X(s):Promise.resolve(P.value)]);if(a!==y)return void console.log(`[getTodoList] Bỏ qua kết quả do phiên cũ (Session: ${a}, Current: ${y})`);"next"===e?A.value=[...A.value,...n||[]]:"prev"===e?n&&n.length>0&&(A.value=[...n,...A.value],k.value=t):(A.value=n||[],k.value=t),"init"!==e&&0!==P.value||(P.value=u||0)}catch(t){console.error(t),$(p("common.error_load"))}finally{void 0!==a&&y===a&&(S.value=!1,x.value=!1,M.value=!1,i())}},fe=()=>{U.value=!1};o((()=>{0===A.value.length&&(ve("init"),de({}))}));const me=e=>{if(console.log("[ListTodo] Received refresh event:",e),"create"===e.type)O(),ve("init");else if("update"===e.type&&e.data){const a=A.value.findIndex((a=>{var t;return a.id===(null==(t=e.data)?void 0:t.id)}));-1!==a&&e.data&&(A.value[a]={...A.value[a],...e.data})}};s((()=>{n("refresh-todo-list",me)})),u((()=>{r("refresh-todo-list",me)}));return{todos:A,isLoading:S,isLoadingMore:x,isLoadingPrev:M,isRefreshing:D,onLoadMore:()=>{_.value<b.value&&!x.value&&!S.value&&(_.value+=1,ve("next"))},onLoadPrev:async()=>{C(`[onLoadPrev] Triggered. startPage=${k.value}, isLoadingPrev=${M.value}, isLoading=${S.value}`),k.value>1&&!M.value&&!S.value?(C("[onLoadPrev] calling getTodoList('prev')"),await ve("prev")):C("[onLoadPrev] Ignored. Condition failed.")},onRefresh:async()=>{D.value=!0,O(),await ve("init"),D.value=!1},pageNo:_,startPage:k,pageSize:T,totalCount:P,totalPages:b,activePage:L,isFilterOpen:U,filter:se,isConfirmDeleteOpen:N,itemToDelete:Q,pageSizeOptions:[5,10,15,20],statusOptions:z,statusIndex:Y,onStatusChange:e=>{Y.value=e.detail.value},creatorOptions:V,creatorIndex:G,onCreatorChange:e=>{G.value=e.detail.value},assigneeOptions:J,assigneeIndex:H,onAssigneeChange:e=>{H.value=e.detail.value},sourceOptions:te,sourceIndex:oe,onSourceChange:e=>{oe.value=e.detail.value},addNewTask:()=>{v({url:"/pages/todo/create_todo"})},openFilter:()=>{U.value=!0,ne()},closeFilter:fe,resetFilter:()=>{se.value={title:"",jobCode:"",createdFrom:"",createdTo:"",dueDateFrom:"",dueDateTo:"",customerCode:"",notifyFrom:"",notifyTo:""},Y.value=0,G.value=0,H.value=0,oe.value=0,w.value="",O(),ve("init"),fe()},applyFilter:()=>{O(),ve("init"),fe()},showActionMenu:e=>{g({itemList:[p("common.delete")],itemColor:"#ff3b30",success:a=>{0===a.tapIndex&&(e=>{Q.value=e,N.value=!0})(e)}})},cancelDelete:()=>{N.value=!1,Q.value=null},confirmDelete:async()=>{if(!Q.value)return;const e=Q.value.id;try{await ae(e),ee(p("common.success_delete")),N.value=!1,A.value=A.value.filter((a=>a.id!==e)),P.value=Math.max(0,P.value-1),Q.value=null}catch(a){console.error("Delete Error:",a),$(p("common.fail_delete"))}},showCustomerModal:I,loadingCustomer:re,customerList:ue,selectedCustomerName:w,openCustomerPopup:()=>{I.value=!0,ne(),0===ue.value.length&&de({})},onCustomerSelect:e=>{se.value.customerCode=e.uid,w.value=e.name,I.value=!1},onFilterCustomerInModal:e=>{de(e)},onUpdatePageSize:e=>{T.value=e,O(),ve("init")},jumpToPage:async e=>{if(e===L.value&&A.value.length>0)return null;y++,S.value=!0,M.value=!1,x.value=!1,A.value=[];try{const a=Math.max(1,e-1),t=Math.min(b.value,e+1);console.log(`[JumpToPage] Target: ${e}. Loading Range: ${a} to ${t}. Total Pages: ${b.value}`);let l="";if(G.value>0){l=q.value[G.value-1].memberUID||""}let o="";if(H.value>0){o=q.value[H.value-1].memberUID||""}const s=Z(se.value,B[Y.value],le[oe.value],l,o);let n=[],u=[],r=[];if(a<e){console.log(`[JumpToPage] 1. Requesting PREV page ${a}...`);const e=await K({...s,pageNo:a,pageSize:T.value});Array.isArray(e)&&(n=e)}console.log(`[JumpToPage] 2. Requesting TARGET page ${e}...`);const c=await K({...s,pageNo:e,pageSize:T.value});if(Array.isArray(c)&&(u=c),t>e){console.log(`[JumpToPage] 3. Requesting NEXT page ${t}...`);const e=await K({...s,pageNo:t,pageSize:T.value});Array.isArray(e)&&(r=e)}let d=[];n.length>0&&(d=[...d,...n]),u.length>0&&(d=[...d,...u]),r.length>0&&(d=[...d,...r]),console.log(`[JumpToPage] Sequential Load Stats: Prev(${n.length}) + Target(${u.length}) + Next(${r.length}) = Total(${d.length})`),A.value=d,k.value=a,_.value=t,L.value=e,console.log(`[JumpToPage] DONE. State updated: startPage=${k.value}, pageNo=${_.value}, activePage=${L.value}`);let g=0;return a<e&&(g=n.length),C(`[JumpToPage] Calculated jumpToIndex=${g}. beforeList.length=${n.length}`),g}catch(a){return console.error("Jump Page Error",a),$(p("common.error_load")),null}finally{S.value=!1,i()}},updateActivePage:e=>{L.value=e},rawMemberList:q,fetchCustomers:de,loadingMore:ie,loadMoreCustomers:ge,isQuickCompleteOpen:E,quickTodos:R,isLoadingQuick:F,openQuickComplete:async()=>{E.value=!0,F.value=!0;try{const e=await K({pageNo:1,pageSize:100,status:""});Array.isArray(e)?R.value=e.filter((e=>e.status!==j.DONE)):R.value=[]}catch(e){console.error("Lỗi lấy danh sách hoàn thành nhanh:",e),$(p("common.error_load"))}finally{F.value=!1}},closeQuickComplete:()=>{E.value=!1},handleQuickMarkDone:async e=>{c({title:p("common.processing")});try{const a={...e,status:j.DONE,preFixCode:"TODO",description:e.description||"",files:"",tagCodes:""};if(await W(a)){ee(p("common.msg_completed")),R.value=R.value.filter((a=>a.id!==e.id));const a=A.value.findIndex((a=>a.id===e.id));-1!==a&&(A.value[a].status=j.DONE)}}catch(a){console.error("Lỗi quick complete:",a),$(p("common.error_update"))}finally{d()}},goToDetail:e=>{v({url:`/pages/todo/todo_detail?id=${e.id}`})},debugLogs:h,addLog:C}},me=te(p({__name:"StatusBadge",props:{status:{}},setup(a){const{t:t}=e(),o=a,s=l((()=>{switch(o.status){case j.NEW:return t("todo.status_todo");case j.IN_PROGRESS:return t("todo.status_progress");case j.DONE:return t("todo.status_done");case j.OVERDUE:return t("todo.status_overdue");default:return o.status||"Unknown"}})),n=l((()=>{switch(o.status){case j.NEW:return"status-new";case j.IN_PROGRESS:return"status-progress";case j.DONE:return"status-done";case j.OVERDUE:return"status-overdue";default:return"status-default"}}));return(e,a)=>{const t=T;return A(),h(t,{class:_(["badge-base",n.value])},{default:C((()=>[y(k(s.value),1)])),_:1},8,["class"])}}}),[["__scopeId","data-v-b5871335"]]),pe=te(p({__name:"list_todo",setup(e){const o=J(),n=t(),u=l((()=>n.isDark)),r=a(0),i=a(0),c=a(!0),d=()=>{N().length>1?Q({delta:1}):history.back()},g=a(20);s((()=>{const e=P();e.statusBarHeight&&(g.value=e.statusBarHeight),v()}));const v=()=>{u.value?b({frontColor:"#ffffff",backgroundColor:"#000000"}):b({frontColor:"#000000",backgroundColor:"#ffffff"})};L(u,(()=>{v()}));const{activePage:f,onLoadMore:m,onChangePageSize:p,jumpToPage:Z,updateActivePage:K,todos:X,isLoading:$,isFilterOpen:j,filter:W,isConfirmDeleteOpen:ee,itemToDelete:ae,pageSizeOptions:te,currentPage:ce,totalPages:pe,onPageSizeChange:Ae,changePage:he,statusOptions:Ce,statusIndex:ye,onStatusChange:ke,creatorOptions:_e,creatorIndex:Te,onCreatorChange:Pe,customerOptions:be,customerIndex:Le,onCustomerChange:Oe,assigneeOptions:Se,assigneeIndex:xe,onAssigneeChange:Me,sourceOptions:De,sourceIndex:Ue,onSourceChange:Ee,addNewTask:Re,openFilter:Fe,closeFilter:Ie,resetFilter:we,applyFilter:Ne,showActionMenu:Qe,cancelDelete:ze,confirmDelete:Be,goToDetail:Ye,showCustomerModal:qe,loadingCustomer:Ve,customerList:Ge,selectedCustomerName:Je,openCustomerPopup:He,onCustomerSelect:Ze,onFilterCustomerInModal:Ke,pageNo:Xe,pageSize:$e,totalCount:je,onChangePage:We,onUpdatePageSize:ea,rawMemberList:aa,loadingMore:ta,loadMoreCustomers:la,isQuickCompleteOpen:oa,quickTodos:sa,isLoadingQuick:na,openQuickComplete:ua,closeQuickComplete:ra,handleQuickMarkDone:ia,startPage:ca,isLoadingPrev:da,isLoadingMore:ga,onLoadPrev:va,isRefreshing:fa,onRefresh:ma,debugLogs:pa,addLog:Aa}=fe(),ha=a(!1),Ca=a(!1),ya=async()=>{if(Aa(`[UI] ScrollToUpper: startPage=${ca.value}, loading=${$.value}, prev=${da.value}, restore=${ha.value}, lock=${Ca.value}`),da.value||$.value||ca.value<=1||ha.value||Ca.value)return;console.log("Trigger Load Prev Page:",ca.value-1),ha.value=!0,Ca.value=!0;z().in(o).select(".list-view-content-measurer").boundingClientRect((e=>{if(!e)return ha.value=!1,void(Ca.value=!1);const a=e.height;va().then((()=>{Aa("[UI] onLoadPrev success. Calculating new height..."),B((()=>{setTimeout((()=>{z().in(o).select(".list-view-content-measurer").boundingClientRect((e=>{if(!e)return ha.value=!1,void(Ca.value=!1);const t=e.height,l=t-a;console.log(`Old: ${a}, New: ${t}, Diff: ${l}`),c.value=!1,r.value=l,requestAnimationFrame((()=>{requestAnimationFrame((()=>{c.value=!0,ha.value=!1}))})),setTimeout((()=>{Ca.value=!1}),800)})).exec()}),50)}))})).catch((e=>{Aa(`[UI] Load Prev Error: ${e}`),ha.value=!1,Ca.value=!1})).finally((()=>{setTimeout((()=>{ha.value&&(Aa("[UI] Forcing Unlock (Safety Timeout)"),ha.value=!1,Ca.value=!1,c.value=!0)}),2e3)}))})).exec()},ka=a(!1),_a=a(null),Ta=a(!1),Pa=l((()=>te.map((e=>String(e))))),ba=l((()=>{const e=te.indexOf($e.value);return-1!==e?e:0})),La=()=>{Ta.value=!Ta.value},Oa=()=>{console.log("Load more triggered..."),m()},Sa=e=>{const a=e.detail.value;te[a]&&(r.value=i.value,setTimeout((()=>{r.value=0}),10),ea(te[a]))},xa=e=>{if(i.value=e.detail.scrollTop,0===X.value.length)return;const a=e.detail.scrollHeight||0,t=a>0?a/X.value.length:120,l=Math.floor(e.detail.scrollTop/t);if(l>=0){const e=Math.min(l,X.value.length-1);Math.ceil(X.value.length/$e.value);const a=Math.floor(e/$e.value),t=ca.value+a;t>0&&t<=pe.value&&(K(t),f.value=t)}};return(e,a)=>{const t=T,l=O(S("uni-icons"),ue),s=Y,n=q,v=V,m=G,p=H;return A(),h(t,{class:_(["container",{"theme-dark":u.value}])},{default:C((()=>[x(t,{class:"header"},{default:C((()=>[x(t,{class:"status-bar-spacer",style:M({height:g.value+"px"})},null,8,["style"]),x(t,{class:"nav-bar"},{default:C((()=>[x(t,{class:"header-left",onClick:d},{default:C((()=>[x(l,{type:"left",size:"24",color:u.value?"#ffffff":"#333333"},null,8,["color"])])),_:1}),x(s,{class:"header-title"},{default:C((()=>[y(k(e.$t("todo.page_title")),1)])),_:1}),x(t,{class:"header-right"},{default:C((()=>[x(t,{class:"icon-btn",onClick:D(ua),style:{"margin-right":"15px"}},{default:C((()=>[x(n,{src:re,class:"filter-icon",mode:"aspectFit"})])),_:1},8,["onClick"]),x(t,{class:"icon-btn",onClick:D(Fe)},{default:C((()=>[x(n,{src:de,class:"filter-icon"})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),x(t,{class:"content"},{default:C((()=>[x(t,{class:"list-wrapper"},{default:C((()=>[x(v,{"scroll-y":"",class:"list-view","upper-threshold":50,"lower-threshold":200,onScrolltolower:Oa,onScrolltoupper:ya,onScroll:xa,"scroll-top":r.value,"scroll-with-animation":c.value,"refresher-enabled":1===D(ca)&&!D(da)&&!ha.value&&!Ca.value,"refresher-threshold":50,"refresher-background":"transparent","refresher-triggered":D(fa),onRefresherrefresh:D(ma)},{default:C((()=>[x(t,{class:"list-view-content-measurer"},{default:C((()=>[D(da)?(A(),h(t,{key:0,class:"loading-state load-prev py-2"},{default:C((()=>[U("",!0),x(s,null,{default:C((()=>[y(k(e.$t("common.loading"))+"...",1)])),_:1})])),_:1})):U("",!0),!D(da)&&D($)&&0===D(X).length?(A(),h(t,{key:1,class:"loading-state"},{default:C((()=>[x(s,null,{default:C((()=>[y(k(e.$t("common.loading")),1)])),_:1})])),_:1})):0===D(X).length?(A(),h(t,{key:2,class:"empty-state"},{default:C((()=>[x(n,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFPElEQVR4nO2cS6gcRRSGj++Fj/iIghvRlS4U37oVcSOI4EpRUVSIoguXikRxl7gw8Z1FQDcicjdZuHEhXCHjdabO3zPDdUS4EGN8gDdqFHxEMUnL0R6Z1FRPz6O6q6b7fFCLO7d76pz6+9TpekwRKYqiKIqiKIqiKIqiKIqSCzM/AeAHAGldCzP/DOABipnBYHAOgPdCNxaqK/LQbaEYMcZcCeCzCBoprThSdlNsALgHwC+hGwdhyrFut3stxcDq6urpAHbmPDlot9tX0JKTJMkjzHy8QJRWmqanBDUUwGUAOjkGvj4YDM6kJccY86gthvwt3RQzn7A+fyiYoQBuZ+ZNR1T8aoy5j2pA4ogMEUHeIOX/zPyO5f/3vV7v/EqNlLBk5mdyQvgLY8zV1AAxhE6ncxGAH61rXqGqALCVmT/MyRfv9vv9s6khYgwB8JSd4DudznVUNsaYm5n5oEOIPwE8TTUhmUEMIU3TUx15tNwEnyTJNmb+yxEZhwDcSg0VY0iSJDc5uvCHyTetVutcZn4/p4v6YH19/QJquBhDAOy17t30muABXMXMn7sGQcz8ooQq1YRkQTGEtbW1Cx1zd6/5MvBBZv7NERWbxpg7qEYkHsQYwsyP2w+vMeb6uY3b2Ng4C8CrOQO9jwFcSjUi8SiGIL0GM39qtdsncyX4bNTddkTFiUykM6hGJJ7FGPneGyUyRr9X6prpS4wxd2dz+2lTCzMfl2kS8gCAPXZXP/ULULZ+cdJos2mFPYoxTPDMfNiq482pbgbwbOgGQfiyjzwjAlt1SDd2Q2F02Eo2tBxb6G0of85vzarHTBwuAHjOZSDVHLhFmdxY89VzDYC/R+th5sdyR+F5uYNqDnIixWceGalrn1XPgZmio8mCMPNhScglL259N3Zhu90+b9KbFdUcTM4ne8pcaQRw/9jFzLx9klFUczDB92x59pbKBp1ZdPykgmC0tKy/O/Mm+LzIyM1PdnS4RuhUc2D5Kyt8jumObaWL4YoOmUpvuiD034P6hvW5tNPWUufGADxvR0ev17vctyAAXgJwtCB5pnOUL40xd3qwb8xfWUxy7KLZW0pkZEZsYeYj1k0HfXdZWfj7FiIdsfnbRezL2sLprzzldqMWLVHPJUZmxAvTOt1UQVLHdIfsvlxZWTnNqxhZOE49ve7B4R0Afl+mLmuIzGnZCR7Ak/9fsKgYgitxlylI7KDAX5kqtxr6SL/fv8Tb4lbejK5Ejb5lYcxfWUxyrGe8vXBkDHEk83+FGG5TUUGK1zOyCNjt2kI786RkkiT3iiii+qgQQ1SQqdczquniVRA3ssLnSPAqSEh/AbylgpTMLP7aCd6VQ4IaWAcwo7/MfJuMgQB8Iz9GUkEi81cF8YwKEhlQQeICKkhcQAWJC6ggcQEVJC6ggsQFVJC4gAoSF1BB4gIqSFxABYkLLOCva5tTVAYuI5jTXzmOyT6Ax8c+MW8GLiuYw185ypCZP7LvLeWYWBWkGAAvO8TYRWWggkxGfvXkEGN/aadbqCD5yPGvjm2xh7rd7sVUFirIxCOXDljXH5UDy6hMVJBxZMe763zJmQ+SmQcVJHASd1SugoRM4jYqSOAkbqOCBE7iNioIhU3i0xhYZ+DwN2gSn8bAOoPxhg+bxIsMpJqD8cY/KYkz81eVJvEiA6l5gqRBk3iRgdRgQZIQSbzIQGquILtoCUK4KWV/NIdFR9AYaeBS7Ui8CPmpVgSNkgYqfxSep1s1cn4IgK8jaJy04iI+3xW6/RVFURRFURRFURRFURSFIuUfTlagzTWYibQAAAAASUVORK5CYII=",mode:"aspectFit",class:"empty-icon"}),x(s,{class:"empty-text"},{default:C((()=>[y(k(e.$t("common.no_data")),1)])),_:1})])),_:1})):(A(),h(t,{key:3},{default:C((()=>[(A(!0),E(F,null,R(D(X),((a,l)=>(A(),h(t,{key:a.id||l,class:"card-item",onClick:e=>D(Ye)(a)},{default:C((()=>[x(t,{class:_(["status-bar",a.statusClass])},null,8,["class"]),x(t,{class:"card-body"},{default:C((()=>[x(t,{class:"card-row top-row"},{default:C((()=>[x(s,{class:"card-title"},{default:C((()=>[y("#"+k(a.code)+" - "+k(a.title),1)])),_:2},1024),x(t,{class:"action-btn",onClick:I((e=>(e=>{_a.value=e,ka.value=!0})(a)),["stop"])},{default:C((()=>[x(s,{class:"dots"},{default:C((()=>[y("⋮")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024),x(t,{class:"card-info-row"},{default:C((()=>[x(n,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEOklEQVR4nO1aS4scVRS+4iOCZqExgksfCzU+oigqGPCxyt52NTBM1/2+6p62/4Ktu5CMiZsEXwvjXsaML9y6EUJiMAkmbs0qOgYdN84YHPl6TplLMzP1uFWVCc4HBU3XrXPq3PM+t5zbxv8AJFc3u9yNAm4LskURK4D3fi+AA865m1xb6HQ6t3nvXyE5AvAZyfPraOO83RuRfFnP5AixaM8dbVwYY/gRgCt5JrXO9RvJD9I0fXKSLoCU5D/B2maESZLkCQBfhy8G4HuSc2mavqb7/X7/LpK36tJv/ad7AN4heWZCqK96vd5jE8K80Zgw09PTt5M8TPKqEV8CcJDkw2Vp6RmSh0TDaF3VRojHRsKYz8SB5IMAzhnRFTHVTsfSTZLkbm0OgL+N9g/9fv+BSWHkMzLlWCFeCJzvx/XsOhbe+70kLxiPX0k+F/BnNE/v/fMA/jAG81NTU3e4hjA7O3unRTbx+j0UJtqcbHdE+ONOp3Ozaxij0egWAMeN5y/e+/ujCMrpAp+Yb0OIUBiSJzKfGQ6HO1xVWHQa+0ST5pRjZhftHQ5VIiLHUjhUJFnPyUh+S/JUr9e71zWIXq/3lN5Bl/d+T2kCJL+xnZjb4P5Ji+vnmhYGwBF7ly9KPagMbEloaaM8MTMzs5vkWWOgkHlfXS++QZ4ZJ81SeYTkh0XsUprIgkHTmiE5Z3zeL/SAKlIr5laLlB1taSZJkkdMkCubVc3/geSrWQFYlEmoGZXqTWmGtmFpmr6UuxjAW1XCXRuagTk9gDdzF2dJSOV2WUZNa8Z7/3qWnHMXK/lp8WRvsBU0k67ltvEm5S7OHF0hryrDCc2o3L8EYH9VehlI3mOmtejyQHJZiwtFhhxhTIisIfrZRWI4HO4wesutCWK0LgVt6kqszwxNEAB/5S7OmqfBYLArhqnR2m/CrNSRNGmmpbaisLOTfNzVBDOzbDx0si1nn68afgsIc4rkd7HhF8CnuYtJvr1Z1Xs9gTIJUenfBDnjthhgId17v69QZAimhqVnVU3Be78nyyEa+BV6iOR7Ue1lA8DadFLvdKxUe5k1VjEZvi4MBoNdAP7UO5WebQH40nbgsLvOIPmumdVC1SF11vTHjSkjQPJpG6WuVC1kQ7u8oNGMaxndbncnyZ9MGwdjJ+/j8b/GmBqauZYwWps2LthGno4a0AlJkjyksaUJc7wNYUZrU8ZPjOflcDIfBQDPBmcYJ5o0s263uzPQhHg+UysDEybTzEWF6CYcm9d84nLtQoRmZsdrqxbRjtRR7ouGQiyuHfScrs2ccgLAXMB0yc4NH61SdigyWrIbN1+KTtGOXQbqV0h+PnFYeVZaUrmt3KOqQJ2mLu26/tM9rQl6+lU7VluoNKSu+bjsWDCdLHxZAXi0iWO82A8G9mnAp8bHPg5YtBnAsn5LC3ZPHwy8WLiK3Ya78fAvzLfHeGD3ADEAAAAASUVORK5CYII=",class:"icon-small"}),x(s,{class:"card-date"},{default:C((()=>[y(k(e.$t("todo.created_at"))+": "+k(a.createdAtFormatted),1)])),_:2},1024)])),_:2},1024),a.dueDateFormatted?(A(),h(t,{key:0,class:"card-info-row"},{default:C((()=>[x(n,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA60lEQVR4nO2aQQ6DMAwE/SPCNekDeur/z214x1ZGBSFKSkShOM2u5ANYrDNYcS4RyRQu7RXBPRAc+vDuru9yvz/bf1RvPBSZFJNC/EcN5qln6/7lgcC3N4Sme2vvLOaF9g7J9m86XfPCH1mHsAXiNOJqaw9r/U7+SOXrAfG2xi82g+iBNS12xIHo8/03g1gTCFIaCAoL+XsQKUQgiDGhehBY2cwvEQQf8r/OqQgCgjiCgFMrVAQiBnIqgoAgjiDg1AoVgYiBnIogIIgjCDi1QgUg1gSCGBNqAIlnbegvIiaucBQFExevcFBiQ0+HIVZjd/jiCwAAAABJRU5ErkJggg==",class:"icon-small"}),x(s,{class:"card-date text-danger"},{default:C((()=>[y(k(e.$t("todo.expired_at"))+": "+k(a.dueDateFormatted),1)])),_:2},1024)])),_:2},1024)):U("",!0),a.notifyAtFormatted?(A(),h(t,{key:1,class:"card-info-row"},{default:C((()=>[x(n,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEmUlEQVR4nO1YXYhVVRReZlmT/VLRP2JUlBVFEFFBD/WkBYk5Vi8mZRLZFOM43bPXGThpUI5PEr0Y/YBEGRT0Zw85FRKUhZmp9RJWZtpLZY1mBekXa+91ztn3nnPuzJy5M3MvnA8O3LPut9fP2XuvvfYiqlChQoUKgggziDFIBgeIsZ8Yz1hZx8FgDTFQ9xg8TR0HtrMACnEzGdyiweyfHOMGt1MvulqiK56FovfxoBddFOK2IsPnk8FfxPiO+jCztJEQsynECm85/UmM3733BynAmaX192Gm9ZFxmFbivLxAnlNDb5QOQMYaHM3sjexe+ZsM1lKEM0rZYrypup6t/8PgXDL4lxj/0QCu9OT3ksHj1I3pTRUbLLBfyDkps/o8GcynELMowsn2kd8iM1ivHHFkD9VwbVPd3ZhufRBfUntzrK+Mf8jgHD/Cx9SJtxJZhJOIsVcN3lVoKMCdySwYvJo/3Q0QDuM1HXOQBnBNk480X3k/Ug9O9OTvqG+P+uTPNcN0e7LlquBLinBcQRCXEuMP5a2mMQHTiPGUOrOX+nFqLk1sG3ylvIcTeYh71O5nseDiZFP6GYuxTQffXeiLwUYdu9E6NmZgmt1Xzs66Qpp8YMf5IpGJry6RHKMncFFKMnivYQ3KwF8LT+MAl+uSOmIzXlmIE7LWRU+As3I5sqTizGdwRSJnbFLZQnF6rTodeYH0KOHFQgcY/TruhdJBpLo2ZNd7AwxeznAMnlTZoLx8aF8CzPMIryhhKRWB8cGIS2+0CHHfiKmfsUztbahLNE42JE7vViVzvEB2KuG6Jor3aIKYPe5ABnBZko6LwLheOTsSmcHV6vtuIfxiX/y0mSfLKnbnxniqgBgRTlMnhws5/bhAnf45I7M1nNusaMhYTiZnSXEgraudRqOvF13KOZIvk3Kh0em84KY6kD5bYwnncCKTisEL5IC+pCmUsc/KbH5uk0BCzEoOz3TMhelyizf7AK7yCNs1k93YNoEEuEk52zKbnbFLFAxl0i/jJY20p20CYa0H/XMrTr8Gm4UwmHMgPpSWHm0TyOvJfSaVrVLZGnF6oSrZlBACXGJrGINDhel1MgOJcIr1RXzyzy2D99ND2RWNxzJFo8EnSlo85YEwluiX39KQsYbTotERtypxkTf4gWQjNZbxEc5W/m8tC8RVsqAaTs9crBjf6D6+P1PGMz7N20hve87OIIPv1eEFdcpD3Kr87S0MxGXPADfUyWXZxOXLMpzgyd9V35bnX3Xra65FNsgIxxf0rNa1MJD1maQjENvig79a5KhwV4iGq67ffJCLfTPIV0l7VgUtmRJgzFX7++qutGNqPoylHSTr1E3pt+VuhQWQfci2zSMOPlK+HTSaBp1rSPyQ2XitAmOpfqSfmhasTRt0ozMUH55fj9giKoNu2/qJ70KDNCGQusslg6O2lztRCCbajtzM4kNr8p4drQ/E4OMpCOQjmjK4sgH2Gpr9z90fpKnX9jDalWHUcv4L9L8hansw7tAUKpVCzc6MaxLUVCaBzKWOgMHqJut+FXUUAszT2+ewPkOdMxMVKlSoQBOM/wGpjQxvGNthDwAAAABJRU5ErkJggg==",class:"icon-small"}),x(s,{class:"card-date text-primary"},{default:C((()=>[y(k(e.$t("todo.notify_at"))+": "+k(a.notifyAtFormatted),1)])),_:2},1024)])),_:2},1024)):U("",!0),x(t,{class:"card-row bot-row"},{default:C((()=>[x(t,{class:"code-tag"},{default:C((()=>[y("#"+k(a.code),1)])),_:2},1024),x(me,{status:a.status},null,8,["status"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),D(ga)?(A(),h(t,{key:0,class:"loading-more"},{default:C((()=>[x(s,{class:"loading-text"},{default:C((()=>[y(k(e.$t("common.loading_more"))+"...",1)])),_:1})])),_:1})):U("",!0),x(t,{style:{height:"20px"}})])),_:1}))])),_:1})])),_:1},8,["scroll-top","scroll-with-animation","refresher-enabled","refresher-triggered","onRefresherrefresh"]),x(t,{class:_(["pagination-drawer",{expanded:Ta.value}])},{default:C((()=>[x(t,{class:"pagination-handle",onClick:La},{default:C((()=>[x(s,{class:"current-page-badge"},{default:C((()=>[y(k(D(f)),1)])),_:1}),y(),Ta.value?(A(),h(s,{key:1,class:"handle-icon"},{default:C((()=>[y("›")])),_:1})):(A(),h(s,{key:0,class:"handle-icon"},{default:C((()=>[y("‹")])),_:1}))])),_:1}),Ta.value?(A(),h(v,{key:0,"scroll-y":"",class:"pagination-list"},{default:C((()=>[x(t,{class:"page-title"},{default:C((()=>[y(k(e.$t("common.page")),1)])),_:1}),(A(!0),E(F,null,R(D(pe),(e=>(A(),h(t,{key:e,class:_(["page-number-item",{active:e===D(f),loaded:e<=D(Xe)}]),onClick:a=>{return t=e,Ta.value=!1,void Z(t).then((e=>{null!==e&&B((()=>{setTimeout((()=>{0===e?(r.value=i.value,setTimeout((()=>{r.value=0}),10)):z().in(o).selectAll(".card-item").boundingClientRect((a=>{if(Array.isArray(a)&&a.length>e){let t=0;for(let l=0;l<e;l++)t+=a[l].height+15;t+=15,t+=5,r.value=i.value,setTimeout((()=>{r.value=t}),10)}else{const a=135*e+5;r.value=i.value,setTimeout((()=>{r.value=a}),10)}})).exec()}),100)}))}));var t}},{default:C((()=>[y(k(e),1)])),_:2},1032,["class","onClick"])))),128)),x(t,{style:{height:"20px"}})])),_:1})):U("",!0)])),_:1},8,["class"])])),_:1}),x(t,{class:"pagination-footer"},{default:C((()=>[x(le,{range:Pa.value||D(te),value:ba.value,onChange:Sa,title:e.$t("common.page_unit")},{default:C((()=>[x(t,{class:"page-size-selector"},{default:C((()=>[x(s,{class:"size-text"},{default:C((()=>[y(k(D($e))+" / "+k(e.$t("common.page_unit")),1)])),_:1}),x(s,{class:"dropdown-arrow"},{default:C((()=>[y("▼")])),_:1})])),_:1})])),_:1},8,["range","value","title"]),x(s,{class:"total-text"},{default:C((()=>[y(k(e.$t("common.total"))+": "+k(D(je)),1)])),_:1}),x(t,{class:"add-task-simple",onClick:D(Re)},{default:C((()=>[x(s,{class:"plus-icon"},{default:C((()=>[y("+")])),_:1}),x(s,{class:"add-text"},{default:C((()=>[y(k(e.$t("todo.add_task")),1)])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1}),D(j)?(A(),h(t,{key:0,class:"filter-overlay",onClick:I(D(Ie),["stop"])},{default:C((()=>[x(t,{class:"filter-panel",onClick:a[8]||(a[8]=I((()=>{}),["stop"]))},{default:C((()=>[x(t,{class:"filter-header"},{default:C((()=>[x(s,{class:"filter-title"},{default:C((()=>[y(k(e.$t("todo.filter_title")),1)])),_:1}),x(s,{class:"close-btn",onClick:D(Ie)},{default:C((()=>[y("✕")])),_:1},8,["onClick"])])),_:1}),x(v,{"scroll-y":"",class:"filter-body"},{default:C((()=>[x(t,{class:"f-group"},{default:C((()=>[x(s,{class:"f-label"},{default:C((()=>[y(k(e.$t("todo.search_label")),1)])),_:1}),x(m,{class:"f-input",modelValue:D(W).title,"onUpdate:modelValue":a[0]||(a[0]=e=>D(W).title=e),placeholder:e.$t("todo.search_placeholder"),"placeholder-class":"input-placeholder"},null,8,["modelValue","placeholder"])])),_:1}),x(t,{class:"f-group"},{default:C((()=>[x(s,{class:"f-label"},{default:C((()=>[y(k(e.$t("todo.code_prefix")),1)])),_:1}),x(m,{class:"f-input",modelValue:D(W).jobCode,"onUpdate:modelValue":a[1]||(a[1]=e=>D(W).jobCode=e),placeholder:e.$t("todo.job_code_placeholder"),"placeholder-class":"input-placeholder"},null,8,["modelValue","placeholder"])])),_:1}),x(t,{class:"f-group"},{default:C((()=>[x(s,{class:"f-label"},{default:C((()=>[y(k(e.$t("todo.status")),1)])),_:1}),x(le,{range:D(Ce),value:D(ye),onChange:D(ke),title:e.$t("todo.status")},{default:C((()=>[x(t,{class:"f-picker"},{default:C((()=>[y(k(D(Ce)[D(ye)])+" ",1),x(s,{class:"arrow"},{default:C((()=>[y("▼")])),_:1})])),_:1})])),_:1},8,["range","value","onChange","title"])])),_:1}),x(t,{class:"f-group"},{default:C((()=>[x(s,{class:"f-label"},{default:C((()=>[y(k(e.$t("todo.creator")),1)])),_:1}),x(le,{range:D(_e),value:D(Te),onChange:D(Pe),title:e.$t("todo.creator")},{default:C((()=>[x(t,{class:"f-picker"},{default:C((()=>[y(k(D(_e)[D(Te)])+" ",1),x(s,{class:"arrow"},{default:C((()=>[y("▼")])),_:1})])),_:1})])),_:1},8,["range","value","onChange","title"])])),_:1}),x(t,{class:"f-group"},{default:C((()=>[x(s,{class:"f-label"},{default:C((()=>[y(k(e.$t("todo.customer")),1)])),_:1}),x(t,{class:"f-input",onClick:D(He),style:{"justify-content":"space-between"}},{default:C((()=>[x(s,{class:_(D(Je)?"text-filled":"text-empty")},{default:C((()=>[y(k(D(Je)||e.$t("todo.select_customer")),1)])),_:1},8,["class"]),x(s,{class:"arrow"},{default:C((()=>[y("›")])),_:1})])),_:1},8,["onClick"])])),_:1}),x(t,{class:"f-group"},{default:C((()=>[x(s,{class:"f-label"},{default:C((()=>[y(k(e.$t("todo.assignee")),1)])),_:1}),x(le,{range:D(Se),value:D(xe),onChange:D(Me),title:e.$t("todo.assignee")},{default:C((()=>[x(t,{class:"f-picker"},{default:C((()=>[y(k(D(Se)[D(xe)])+" ",1),x(s,{class:"arrow"},{default:C((()=>[y("▼")])),_:1})])),_:1})])),_:1},8,["range","value","onChange","title"])])),_:1}),x(t,{class:"f-group"},{default:C((()=>[x(s,{class:"f-label"},{default:C((()=>[y(k(e.$t("todo.source")),1)])),_:1}),x(le,{range:D(De),value:D(Ue),onChange:D(Ee),title:e.$t("todo.source")},{default:C((()=>[x(t,{class:"f-picker"},{default:C((()=>[y(k(D(De)[D(Ue)])+" ",1),x(s,{class:"arrow"},{default:C((()=>[y("▼")])),_:1})])),_:1})])),_:1},8,["range","value","onChange","title"])])),_:1}),x(ge,{title:e.$t("todo.time_create"),startDate:D(W).createdFrom,"onUpdate:startDate":a[2]||(a[2]=e=>D(W).createdFrom=e),endDate:D(W).createdTo,"onUpdate:endDate":a[3]||(a[3]=e=>D(W).createdTo=e)},null,8,["title","startDate","endDate"]),x(ge,{title:e.$t("todo.time_expired"),startDate:D(W).dueDateFrom,"onUpdate:startDate":a[4]||(a[4]=e=>D(W).dueDateFrom=e),endDate:D(W).dueDateTo,"onUpdate:endDate":a[5]||(a[5]=e=>D(W).dueDateTo=e)},null,8,["title","startDate","endDate"]),x(ge,{title:e.$t("todo.time_notify"),startDate:D(W).notifyFrom,"onUpdate:startDate":a[6]||(a[6]=e=>D(W).notifyFrom=e),endDate:D(W).notifyTo,"onUpdate:endDate":a[7]||(a[7]=e=>D(W).notifyTo=e)},null,8,["title","startDate","endDate"]),x(t,{style:{height:"20px"}})])),_:1}),x(t,{class:"filter-footer"},{default:C((()=>[x(oe,{type:"secondary",label:e.$t("common.reset"),onClick:D(we)},null,8,["label","onClick"]),x(oe,{type:"primary",label:e.$t("common.apply"),onClick:D(Ne)},null,8,["label","onClick"])])),_:1})])),_:1})])),_:1},8,["onClick"])):U("",!0),D(oa)?(A(),h(t,{key:1,class:"filter-overlay",onClick:I(D(ra),["stop"])},{default:C((()=>[x(t,{class:"filter-panel quick-panel",onClick:a[9]||(a[9]=I((()=>{}),["stop"]))},{default:C((()=>[x(t,{class:"filter-header"},{default:C((()=>[x(s,{class:"filter-title"},{default:C((()=>[y(k(e.$t("todo.quick_done_title")),1)])),_:1}),x(s,{class:"close-btn",onClick:D(ra)},{default:C((()=>[y("✕")])),_:1},8,["onClick"])])),_:1}),x(v,{"scroll-y":"",class:"filter-body"},{default:C((()=>[D(na)?(A(),h(t,{key:0,class:"loading-state",style:{height:"200px"}},{default:C((()=>[x(s,null,{default:C((()=>[y(k(e.$t("common.loading")),1)])),_:1})])),_:1})):0===D(sa).length?(A(),h(t,{key:1,class:"empty-state",style:{height:"200px"}},{default:C((()=>[x(s,{class:"empty-text"},{default:C((()=>[y(k(e.$t("todo.msg_no_task_quick_done")),1)])),_:1})])),_:1})):(A(),h(t,{key:2,class:"quick-list"},{default:C((()=>[(A(!0),E(F,null,R(D(sa),(a=>(A(),h(t,{key:a.id,class:"quick-item"},{default:C((()=>[x(t,{class:"quick-info"},{default:C((()=>[x(t,{class:"quick-code"},{default:C((()=>[y("#"+k(a.code),1)])),_:2},1024),x(t,{class:"quick-title"},{default:C((()=>[y(k(a.title),1)])),_:2},1024)])),_:2},1024),x(t,{class:"quick-action"},{default:C((()=>[x(p,{class:"btn-complete",onClick:I((e=>D(ia)(a)),["stop"])},{default:C((()=>[x(s,null,{default:C((()=>[y(k(e.$t("todo.done_action")),1)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128)),x(t,{style:{height:"40px"}})])),_:1}))])),_:1})])),_:1})])),_:1},8,["onClick"])):U("",!0),x(ve,{visible:D(qe),loading:D(Ve),loadingMore:D(ta),customers:D(Ge),managers:D(aa),onClose:a[10]||(a[10]=e=>qe.value=!1),onSelect:D(Ze),onFilter:D(Ke),onLoadMore:D(la)},null,8,["visible","loading","loadingMore","customers","managers","onSelect","onFilter","onLoadMore"]),x(ie,{visible:D(ee),"onUpdate:visible":a[11]||(a[11]=e=>w(ee)?ee.value=e:null),title:e.$t("common.notification"),message:D(ae)?e.$t("todo.confirm_delete_msg").replace("{title}",D(ae).title):"","confirm-type":"danger","cancel-label":e.$t("common.cancel"),"confirm-label":e.$t("common.delete"),onConfirm:D(Be),onCancel:D(ze)},null,8,["visible","title","message","cancel-label","confirm-label","onConfirm","onCancel"]),x(t,{class:_(["custom-sheet-mask",{show:ka.value}]),onClick:a[15]||(a[15]=e=>ka.value=!1)},{default:C((()=>[x(t,{class:"custom-sheet-panel",onClick:a[14]||(a[14]=I((()=>{}),["stop"]))},{default:C((()=>[x(t,{class:"sheet-item delete",onClick:a[12]||(a[12]=e=>{return a="delete",ka.value=!1,void("delete"===a&&(ae.value=_a.value,ee.value=!0));var a})},{default:C((()=>[x(s,null,{default:C((()=>[y(k(e.$t("common.delete")),1)])),_:1})])),_:1}),x(t,{class:"sheet-gap"}),x(t,{class:"sheet-item cancel",onClick:a[13]||(a[13]=e=>ka.value=!1)},{default:C((()=>[x(s,null,{default:C((()=>[y(k(e.$t("common.cancel")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["class"]),x(se),x(ne)])),_:1},8,["class"])}}}),[["__scopeId","data-v-fb8ff6e3"]]);export{pe as default};
