import{u as e,r as a,a as t,c as l,o,b as s,$ as n,d as u,e as i,s as r,f as c,h as d,g,T as v,i as f,j as m,k as p,l as A,w as h,m as C,t as y,n as k,p as _,q as T,v as P,x as b,y as L,z as O,A as S,B as x,C as M,D,E as U,F as w,G as E,H as R,I as F,J as I,K as N,L as Q,M as z,N as B,O as Y,S as q,P as V,Q as G,R as J}from"./index-bOplQ8aJ.js";import{b as H,g as Z,a as K,s as X,T as $,u as j,c as W,d as ee,n as ae,_ as te,A as le,e as oe,G as se,f as ne,h as ue}from"./GlobalNotification.DFpq9c0l.js";import{_ as ie,C as re}from"./ConfirmModal.Bty-0qSl.js";import{u as ce,_ as de,D as ge,C as ve}from"./useCustomerFilter.CsAF-8Ia.js";const fe=()=>{const{t:m}=e(),p=a([]),A=a([]),h=e=>{const a=`[${(new Date).toLocaleTimeString()}] ${e}`;console.log(a),A.value.unshift(a),A.value.length>50&&A.value.pop()};let C=0;const{startPage:y,pageNo:k,pageSize:_,totalCount:T,totalPages:P,activePage:b,resetPagination:L}=((e=15)=>{const t=a(1),o=a(1),s=a(e),n=a(0),u=a(1),i=l((()=>0===n.value?1:Math.ceil(n.value/s.value)));return{startPage:t,pageNo:o,pageSize:s,totalCount:n,totalPages:i,activePage:u,resetPagination:()=>{t.value=1,o.value=1,u.value=1,n.value=0}}})(15),O=a(!1),S=a(!1),x=a(!1),M=a(!1),D=a(!1);t();const U=a(!1),w=a([]),E=a(!1),R=a(!1),F=a(""),I=a(!1),N=a(null),Q=l((()=>[m("common.all"),m("todo.status_todo"),m("todo.status_progress"),m("todo.status_done"),m("todo.status_overdue")])),z=["",$.NEW,$.IN_PROGRESS,$.DONE,$.OVERDUE],B=a(0),Y=a([]),q=l((()=>{const e=Y.value.map((e=>e.UserName||m("common.unknown_member")));return[m("common.all"),...e]})),V=a(0),G=l((()=>{const e=Y.value.map((e=>e.UserName||m("common.hidden_member")));return[m("common.all"),...e]})),J=a(0),te=l((()=>[m("common.all"),m("source.call"),m("source.customer"),m("source.conversation"),m("source.message")])),le=["",v.CALL,v.CUSTOMER,v.CONVERSATION,v.CHAT_MESSAGE],oe=a(0),se=a({title:"",jobCode:"",createdFrom:"",createdTo:"",dueDateFrom:"",dueDateTo:"",customerCode:"",notifyFrom:"",notifyTo:""}),ne=async()=>{if(!(Y.value.length>0))try{const e=await f();Y.value=e}catch(e){console.error("Lỗi lấy danh sách thành viên filter:",e)}},{customerList:ue,loadingCustomer:ie,loadingMore:re,fetchCustomers:de,loadMoreCustomers:ge}=ce(),ve=async(e="init")=>{if(console.log(`[getTodoList] Called with direction=${e}. isLoadingPrev=${x.value}, startPage=${y.value}, pageNo=${k.value}`),"next"===e&&(S.value||k.value>P.value))return;if("prev"===e&&(x.value||y.value<=1))return void h(`[getTodoList] SKIPPING prev load: isLoadingPrev=${x.value}, startPage=${y.value}`);let a;"next"===e?S.value=!0:"prev"===e?x.value=!0:(O.value=!0,p.value=[]);try{a=C;let t=1;if(t="next"===e?k.value:"prev"===e?y.value-1:k.value,a!==C)return;let l="";if(V.value>0){l=Y.value[V.value-1].memberUID||""}let o="";if(J.value>0){o=Y.value[J.value-1].memberUID||""}const s=H(se.value,z[B.value],le[oe.value],l,o),[n,u]=await Promise.all([Z({...s,pageNo:t,pageSize:_.value}),"init"===e||0===T.value?K(s):Promise.resolve(T.value)]);if(a!==C)return void console.log(`[getTodoList] Bỏ qua kết quả do phiên cũ (Session: ${a}, Current: ${C})`);"next"===e?p.value=[...p.value,...n||[]]:"prev"===e?n&&n.length>0&&(p.value=[...n,...p.value],y.value=t):(p.value=n||[],y.value=t),"init"!==e&&0!==T.value||(T.value=u||0)}catch(t){console.error(t),X(m("common.error_load"))}finally{void 0!==a&&C===a&&(O.value=!1,S.value=!1,x.value=!1,r())}},fe=()=>{D.value=!1};o((()=>{0===p.value.length&&(ve("init"),de({}))}));const me=e=>{if(console.log("[ListTodo] Received refresh event:",e),"create"===e.type)L(),ve("init");else if("update"===e.type&&e.data){const a=p.value.findIndex((a=>{var t;return a.id===(null==(t=e.data)?void 0:t.id)}));-1!==a&&e.data&&(p.value[a]={...p.value[a],...e.data})}};s((()=>{n("refresh-todo-list",me)})),u((()=>{i("refresh-todo-list",me)}));return{todos:p,isLoading:O,isLoadingMore:S,isLoadingPrev:x,isRefreshing:M,onLoadMore:()=>{k.value<P.value&&!S.value&&!O.value&&(k.value+=1,ve("next"))},onLoadPrev:async()=>{h(`[onLoadPrev] Triggered. startPage=${y.value}, isLoadingPrev=${x.value}, isLoading=${O.value}`),y.value>1&&!x.value&&!O.value?(h("[onLoadPrev] calling getTodoList('prev')"),await ve("prev")):h("[onLoadPrev] Ignored. Condition failed.")},onRefresh:async()=>{M.value=!0,L(),await ve("init"),M.value=!1},pageNo:k,startPage:y,pageSize:_,totalCount:T,totalPages:P,activePage:b,isFilterOpen:D,filter:se,isConfirmDeleteOpen:I,itemToDelete:N,pageSizeOptions:[5,10,15,20],statusOptions:Q,statusIndex:B,onStatusChange:e=>{B.value=e.detail.value},creatorOptions:q,creatorIndex:V,onCreatorChange:e=>{V.value=e.detail.value},assigneeOptions:G,assigneeIndex:J,onAssigneeChange:e=>{J.value=e.detail.value},sourceOptions:te,sourceIndex:oe,onSourceChange:e=>{oe.value=e.detail.value},addNewTask:()=>{ae("/pages/todo/create_todo")},openFilter:()=>{D.value=!0,ne()},closeFilter:fe,resetFilter:()=>{se.value={title:"",jobCode:"",createdFrom:"",createdTo:"",dueDateFrom:"",dueDateTo:"",customerCode:"",notifyFrom:"",notifyTo:""},B.value=0,V.value=0,J.value=0,oe.value=0,F.value="",L(),ve("init"),fe()},applyFilter:()=>{L(),ve("init"),fe()},showActionMenu:e=>{g({itemList:[m("common.delete")],itemColor:"#ff3b30",success:a=>{0===a.tapIndex&&(e=>{N.value=e,I.value=!0})(e)}})},cancelDelete:()=>{I.value=!1,N.value=null},confirmDelete:async()=>{if(!N.value)return;const e=N.value.id;try{await ee(e),W(m("common.success_delete")),I.value=!1,p.value=p.value.filter((a=>a.id!==e)),T.value=Math.max(0,T.value-1),N.value=null}catch(a){console.error("Delete Error:",a),X(m("common.fail_delete"))}},showCustomerModal:R,loadingCustomer:ie,customerList:ue,selectedCustomerName:F,openCustomerPopup:()=>{R.value=!0,ne(),0===ue.value.length&&de({})},onCustomerSelect:e=>{se.value.customerCode=e.uid,F.value=e.name,R.value=!1},onFilterCustomerInModal:e=>{de(e)},onUpdatePageSize:e=>{_.value=e,L(),ve("init")},jumpToPage:async e=>{if(e===b.value&&p.value.length>0)return null;C++,O.value=!0,x.value=!1,S.value=!1,p.value=[];try{const a=Math.max(1,e-1),t=Math.min(P.value,e+1);console.log(`[JumpToPage] Target: ${e}. Loading Range: ${a} to ${t}. Total Pages: ${P.value}`);let l="";if(V.value>0){l=Y.value[V.value-1].memberUID||""}let o="";if(J.value>0){o=Y.value[J.value-1].memberUID||""}const s=H(se.value,z[B.value],le[oe.value],l,o);let n=[],u=[],i=[];if(a<e){console.log(`[JumpToPage] 1. Requesting PREV page ${a}...`);const e=await Z({...s,pageNo:a,pageSize:_.value});Array.isArray(e)&&(n=e)}console.log(`[JumpToPage] 2. Requesting TARGET page ${e}...`);const c=await Z({...s,pageNo:e,pageSize:_.value});if(Array.isArray(c)&&(u=c),t>e){console.log(`[JumpToPage] 3. Requesting NEXT page ${t}...`);const e=await Z({...s,pageNo:t,pageSize:_.value});Array.isArray(e)&&(i=e)}let d=[];n.length>0&&(d=[...d,...n]),u.length>0&&(d=[...d,...u]),i.length>0&&(d=[...d,...i]),console.log(`[JumpToPage] Sequential Load Stats: Prev(${n.length}) + Target(${u.length}) + Next(${i.length}) = Total(${d.length})`),p.value=d,y.value=a,k.value=t,b.value=e,console.log(`[JumpToPage] DONE. State updated: startPage=${y.value}, pageNo=${k.value}, activePage=${b.value}`);let g=0;return a<e&&(g=n.length),h(`[JumpToPage] Calculated jumpToIndex=${g}. beforeList.length=${n.length}`),g}catch(a){return console.error("Jump Page Error",a),X(m("common.error_load")),null}finally{O.value=!1,r()}},updateActivePage:e=>{b.value=e},rawMemberList:Y,fetchCustomers:de,loadingMore:re,loadMoreCustomers:ge,isQuickCompleteOpen:U,quickTodos:w,isLoadingQuick:E,openQuickComplete:async()=>{U.value=!0,E.value=!0;try{const e=await Z({pageNo:1,pageSize:100,status:""});Array.isArray(e)?w.value=e.filter((e=>e.status!==$.DONE)):w.value=[]}catch(e){console.error("Lỗi lấy danh sách hoàn thành nhanh:",e),X(m("common.error_load"))}finally{E.value=!1}},closeQuickComplete:()=>{U.value=!1},handleQuickMarkDone:async e=>{c({title:m("common.processing")});try{const a={...e,status:$.DONE,preFixCode:"TODO",description:e.description||"",files:"",tagCodes:""};if(await j(a)){W(m("common.msg_completed")),w.value=w.value.filter((a=>a.id!==e.id));const a=p.value.findIndex((a=>a.id===e.id));-1!==a&&(p.value[a].status=$.DONE)}}catch(a){console.error("Lỗi quick complete:",a),X(m("common.error_update"))}finally{d()}},goToDetail:e=>{ae(`/pages/todo/todo_detail?id=${e.id}`)},debugLogs:A,addLog:h}},me=te(m({__name:"StatusBadge",props:{status:{}},setup(a){const{t:t}=e(),o=a,s=l((()=>{switch(o.status){case $.NEW:return t("todo.status_todo");case $.IN_PROGRESS:return t("todo.status_progress");case $.DONE:return t("todo.status_done");case $.OVERDUE:return t("todo.status_overdue");default:return o.status||"Unknown"}})),n=l((()=>{switch(o.status){case $.NEW:return"status-new";case $.IN_PROGRESS:return"status-progress";case $.DONE:return"status-done";case $.OVERDUE:return"status-overdue";default:return"status-default"}}));return(e,a)=>{const t=_;return p(),A(t,{class:k(["badge-base",n.value])},{default:h((()=>[C(y(s.value),1)])),_:1},8,["class"])}}}),[["__scopeId","data-v-b5871335"]]),pe=te(m({__name:"list_todo",setup(e){const o=G(),n=t(),u=l((()=>n.isDark)),i=a(0),r=a(0),c=a(!0),d=()=>{I().length>1?N({delta:1}):void 0!==window.Android&&window.Android.closeMiniApp?window.Android.closeMiniApp():history.back()},g=a(20);s((()=>{const e=T();e.statusBarHeight&&(g.value=e.statusBarHeight),v()}));const v=()=>{u.value?P({frontColor:"#ffffff",backgroundColor:"#000000"}):P({frontColor:"#000000",backgroundColor:"#ffffff"})};b(u,(()=>{v()}));const{activePage:f,onLoadMore:m,onChangePageSize:H,jumpToPage:Z,updateActivePage:K,todos:X,isLoading:$,isFilterOpen:j,filter:W,isConfirmDeleteOpen:ee,itemToDelete:ae,pageSizeOptions:te,currentPage:ce,totalPages:pe,onPageSizeChange:Ae,changePage:he,statusOptions:Ce,statusIndex:ye,onStatusChange:ke,creatorOptions:_e,creatorIndex:Te,onCreatorChange:Pe,customerOptions:be,customerIndex:Le,onCustomerChange:Oe,assigneeOptions:Se,assigneeIndex:xe,onAssigneeChange:Me,sourceOptions:De,sourceIndex:Ue,onSourceChange:we,addNewTask:Ee,openFilter:Re,closeFilter:Fe,resetFilter:Ie,applyFilter:Ne,showActionMenu:Qe,cancelDelete:ze,confirmDelete:Be,goToDetail:Ye,showCustomerModal:qe,loadingCustomer:Ve,customerList:Ge,selectedCustomerName:Je,openCustomerPopup:He,onCustomerSelect:Ze,onFilterCustomerInModal:Ke,pageNo:Xe,pageSize:$e,totalCount:je,onChangePage:We,onUpdatePageSize:ea,rawMemberList:aa,loadingMore:ta,loadMoreCustomers:la,isQuickCompleteOpen:oa,quickTodos:sa,isLoadingQuick:na,openQuickComplete:ua,closeQuickComplete:ia,handleQuickMarkDone:ra,startPage:ca,isLoadingPrev:da,isLoadingMore:ga,onLoadPrev:va,isRefreshing:fa,onRefresh:ma,debugLogs:pa,addLog:Aa}=fe(),ha=a(!1),Ca=a(!1),ya=async()=>{if(Aa(`[UI] ScrollToUpper: startPage=${ca.value}, loading=${$.value}, prev=${da.value}, restore=${ha.value}, lock=${Ca.value}`),da.value||$.value||ca.value<=1||ha.value||Ca.value)return;console.log("Trigger Load Prev Page:",ca.value-1),ha.value=!0,Ca.value=!0;Q().in(o).select(".list-view-content-measurer").boundingClientRect((e=>{if(!e)return ha.value=!1,void(Ca.value=!1);const a=e.height;va().then((()=>{Aa("[UI] onLoadPrev success. Calculating new height..."),z((()=>{setTimeout((()=>{Q().in(o).select(".list-view-content-measurer").boundingClientRect((e=>{if(!e)return ha.value=!1,void(Ca.value=!1);const t=e.height,l=t-a;console.log(`Old: ${a}, New: ${t}, Diff: ${l}`),c.value=!1,i.value=l,requestAnimationFrame((()=>{requestAnimationFrame((()=>{c.value=!0,ha.value=!1}))})),setTimeout((()=>{Ca.value=!1}),800)})).exec()}),50)}))})).catch((e=>{Aa(`[UI] Load Prev Error: ${e}`),ha.value=!1,Ca.value=!1})).finally((()=>{setTimeout((()=>{ha.value&&(Aa("[UI] Forcing Unlock (Safety Timeout)"),ha.value=!1,Ca.value=!1,c.value=!0)}),2e3)}))})).exec()},ka=a(!1),_a=a(null),Ta=a(!1),Pa=l((()=>te.map((e=>String(e))))),ba=l((()=>{const e=te.indexOf($e.value);return-1!==e?e:0})),La=()=>{Ta.value=!Ta.value},Oa=()=>{console.log("Load more triggered..."),m()},Sa=e=>{const a=e.detail.value;te[a]&&(i.value=r.value,setTimeout((()=>{i.value=0}),10),ea(te[a]))},xa=e=>{if(r.value=e.detail.scrollTop,0===X.value.length)return;const a=e.detail.scrollHeight||0,t=a>0?a/X.value.length:120,l=Math.floor(e.detail.scrollTop/t);if(l>=0){const e=Math.min(l,X.value.length-1);Math.ceil(X.value.length/$e.value);const a=Math.floor(e/$e.value),t=ca.value+a;t>0&&t<=pe.value&&(K(t),f.value=t)}};return(e,a)=>{const t=_,l=L(O("uni-icons"),ue),s=B,n=Y,v=q,m=V,T=J;return p(),A(t,{class:k(["container",{"theme-dark":u.value}])},{default:h((()=>[S(t,{class:"header"},{default:h((()=>[S(t,{class:"status-bar-spacer",style:x({height:g.value+"px"})},null,8,["style"]),S(t,{class:"nav-bar"},{default:h((()=>[S(t,{class:"header-left",onClick:d},{default:h((()=>[S(l,{type:"left",size:"24",color:u.value?"#ffffff":"#333333"},null,8,["color"])])),_:1}),S(s,{class:"header-title"},{default:h((()=>[C(y(e.$t("todo.page_title")),1)])),_:1}),S(t,{class:"header-right"},{default:h((()=>[S(t,{class:"icon-btn",onClick:M(ua),style:{"margin-right":"15px"}},{default:h((()=>[S(n,{src:ie,class:"filter-icon",mode:"aspectFit"})])),_:1},8,["onClick"]),S(t,{class:"icon-btn",onClick:M(Re)},{default:h((()=>[S(n,{src:de,class:"filter-icon"})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),S(t,{class:"content"},{default:h((()=>[S(t,{class:"list-wrapper"},{default:h((()=>[S(v,{"scroll-y":"",class:"list-view","upper-threshold":50,"lower-threshold":200,onScrolltolower:Oa,onScrolltoupper:ya,onScroll:xa,"scroll-top":i.value,"scroll-with-animation":c.value,"refresher-enabled":1===M(ca)&&!M(da)&&!ha.value&&!Ca.value,"refresher-threshold":50,"refresher-background":"transparent","refresher-triggered":M(fa),onRefresherrefresh:M(ma)},{default:h((()=>[S(t,{class:"list-view-content-measurer"},{default:h((()=>[M(da)?(p(),A(t,{key:0,class:"loading-state load-prev py-2"},{default:h((()=>[D("",!0),S(s,null,{default:h((()=>[C(y(e.$t("common.loading"))+"...",1)])),_:1})])),_:1})):D("",!0),!M(da)&&M($)&&0===M(X).length?(p(),A(t,{key:1,class:"loading-state"},{default:h((()=>[S(s,null,{default:h((()=>[C(y(e.$t("common.loading")),1)])),_:1})])),_:1})):0===M(X).length?(p(),A(t,{key:2,class:"empty-state"},{default:h((()=>[S(n,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFPElEQVR4nO2cS6gcRRSGj++Fj/iIghvRlS4U37oVcSOI4EpRUVSIoguXikRxl7gw8Z1FQDcicjdZuHEhXCHjdabO3zPDdUS4EGN8gDdqFHxEMUnL0R6Z1FRPz6O6q6b7fFCLO7d76pz6+9TpekwRKYqiKIqiKIqiKIqiKIqSCzM/AeAHAGldCzP/DOABipnBYHAOgPdCNxaqK/LQbaEYMcZcCeCzCBoprThSdlNsALgHwC+hGwdhyrFut3stxcDq6urpAHbmPDlot9tX0JKTJMkjzHy8QJRWmqanBDUUwGUAOjkGvj4YDM6kJccY86gthvwt3RQzn7A+fyiYoQBuZ+ZNR1T8aoy5j2pA4ogMEUHeIOX/zPyO5f/3vV7v/EqNlLBk5mdyQvgLY8zV1AAxhE6ncxGAH61rXqGqALCVmT/MyRfv9vv9s6khYgwB8JSd4DudznVUNsaYm5n5oEOIPwE8TTUhmUEMIU3TUx15tNwEnyTJNmb+yxEZhwDcSg0VY0iSJDc5uvCHyTetVutcZn4/p4v6YH19/QJquBhDAOy17t30muABXMXMn7sGQcz8ooQq1YRkQTGEtbW1Cx1zd6/5MvBBZv7NERWbxpg7qEYkHsQYwsyP2w+vMeb6uY3b2Ng4C8CrOQO9jwFcSjUi8SiGIL0GM39qtdsncyX4bNTddkTFiUykM6hGJJ7FGPneGyUyRr9X6prpS4wxd2dz+2lTCzMfl2kS8gCAPXZXP/ULULZ+cdJos2mFPYoxTPDMfNiq482pbgbwbOgGQfiyjzwjAlt1SDd2Q2F02Eo2tBxb6G0of85vzarHTBwuAHjOZSDVHLhFmdxY89VzDYC/R+th5sdyR+F5uYNqDnIixWceGalrn1XPgZmio8mCMPNhScglL259N3Zhu90+b9KbFdUcTM4ne8pcaQRw/9jFzLx9klFUczDB92x59pbKBp1ZdPykgmC0tKy/O/Mm+LzIyM1PdnS4RuhUc2D5Kyt8jumObaWL4YoOmUpvuiD034P6hvW5tNPWUufGADxvR0ev17vctyAAXgJwtCB5pnOUL40xd3qwb8xfWUxy7KLZW0pkZEZsYeYj1k0HfXdZWfj7FiIdsfnbRezL2sLprzzldqMWLVHPJUZmxAvTOt1UQVLHdIfsvlxZWTnNqxhZOE49ve7B4R0Afl+mLmuIzGnZCR7Ak/9fsKgYgitxlylI7KDAX5kqtxr6SL/fv8Tb4lbejK5Ejb5lYcxfWUxyrGe8vXBkDHEk83+FGG5TUUGK1zOyCNjt2kI786RkkiT3iiii+qgQQ1SQqdczquniVRA3ssLnSPAqSEh/AbylgpTMLP7aCd6VQ4IaWAcwo7/MfJuMgQB8Iz9GUkEi81cF8YwKEhlQQeICKkhcQAWJC6ggcQEVJC6ggsQFVJC4gAoSF1BB4gIqSFxABYkLLOCva5tTVAYuI5jTXzmOyT6Ax8c+MW8GLiuYw185ypCZP7LvLeWYWBWkGAAvO8TYRWWggkxGfvXkEGN/aadbqCD5yPGvjm2xh7rd7sVUFirIxCOXDljXH5UDy6hMVJBxZMe763zJmQ+SmQcVJHASd1SugoRM4jYqSOAkbqOCBE7iNioIhU3i0xhYZ+DwN2gSn8bAOoPxhg+bxIsMpJqD8cY/KYkz81eVJvEiA6l5gqRBk3iRgdRgQZIQSbzIQGquILtoCUK4KWV/NIdFR9AYaeBS7Ui8CPmpVgSNkgYqfxSep1s1cn4IgK8jaJy04iI+3xW6/RVFURRFURRFURRFURSFIuUfTlagzTWYibQAAAAASUVORK5CYII=",mode:"aspectFit",class:"empty-icon"}),S(s,{class:"empty-text"},{default:h((()=>[C(y(e.$t("common.no_data")),1)])),_:1})])),_:1})):(p(),A(t,{key:3},{default:h((()=>[(p(!0),U(E,null,w(M(X),((a,l)=>(p(),A(t,{key:a.id||l,class:"card-item",onClick:e=>M(Ye)(a)},{default:h((()=>[S(t,{class:k(["status-bar",a.statusClass])},null,8,["class"]),S(t,{class:"card-body"},{default:h((()=>[S(t,{class:"card-row top-row"},{default:h((()=>[S(s,{class:"card-title"},{default:h((()=>[C("#"+y(a.code)+" - "+y(a.title),1)])),_:2},1024),S(t,{class:"action-btn",onClick:R((e=>(e=>{_a.value=e,ka.value=!0})(a)),["stop"])},{default:h((()=>[S(s,{class:"dots"},{default:h((()=>[C("⋮")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024),S(t,{class:"card-info-row"},{default:h((()=>[S(n,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEOklEQVR4nO1aS4scVRS+4iOCZqExgksfCzU+oigqGPCxyt52NTBM1/2+6p62/4Ktu5CMiZsEXwvjXsaML9y6EUJiMAkmbs0qOgYdN84YHPl6TplLMzP1uFWVCc4HBU3XrXPq3PM+t5zbxv8AJFc3u9yNAm4LskURK4D3fi+AA865m1xb6HQ6t3nvXyE5AvAZyfPraOO83RuRfFnP5AixaM8dbVwYY/gRgCt5JrXO9RvJD9I0fXKSLoCU5D/B2maESZLkCQBfhy8G4HuSc2mavqb7/X7/LpK36tJv/ad7AN4heWZCqK96vd5jE8K80Zgw09PTt5M8TPKqEV8CcJDkw2Vp6RmSh0TDaF3VRojHRsKYz8SB5IMAzhnRFTHVTsfSTZLkbm0OgL+N9g/9fv+BSWHkMzLlWCFeCJzvx/XsOhbe+70kLxiPX0k+F/BnNE/v/fMA/jAG81NTU3e4hjA7O3unRTbx+j0UJtqcbHdE+ONOp3Ozaxij0egWAMeN5y/e+/ujCMrpAp+Yb0OIUBiSJzKfGQ6HO1xVWHQa+0ST5pRjZhftHQ5VIiLHUjhUJFnPyUh+S/JUr9e71zWIXq/3lN5Bl/d+T2kCJL+xnZjb4P5Ji+vnmhYGwBF7ly9KPagMbEloaaM8MTMzs5vkWWOgkHlfXS++QZ4ZJ81SeYTkh0XsUprIgkHTmiE5Z3zeL/SAKlIr5laLlB1taSZJkkdMkCubVc3/geSrWQFYlEmoGZXqTWmGtmFpmr6UuxjAW1XCXRuagTk9gDdzF2dJSOV2WUZNa8Z7/3qWnHMXK/lp8WRvsBU0k67ltvEm5S7OHF0hryrDCc2o3L8EYH9VehlI3mOmtejyQHJZiwtFhhxhTIisIfrZRWI4HO4wesutCWK0LgVt6kqszwxNEAB/5S7OmqfBYLArhqnR2m/CrNSRNGmmpbaisLOTfNzVBDOzbDx0si1nn68afgsIc4rkd7HhF8CnuYtJvr1Z1Xs9gTIJUenfBDnjthhgId17v69QZAimhqVnVU3Be78nyyEa+BV6iOR7Ue1lA8DadFLvdKxUe5k1VjEZvi4MBoNdAP7UO5WebQH40nbgsLvOIPmumdVC1SF11vTHjSkjQPJpG6WuVC1kQ7u8oNGMaxndbncnyZ9MGwdjJ+/j8b/GmBqauZYwWps2LthGno4a0AlJkjyksaUJc7wNYUZrU8ZPjOflcDIfBQDPBmcYJ5o0s263uzPQhHg+UysDEybTzEWF6CYcm9d84nLtQoRmZsdrqxbRjtRR7ouGQiyuHfScrs2ccgLAXMB0yc4NH61SdigyWrIbN1+KTtGOXQbqV0h+PnFYeVZaUrmt3KOqQJ2mLu26/tM9rQl6+lU7VluoNKSu+bjsWDCdLHxZAXi0iWO82A8G9mnAp8bHPg5YtBnAsn5LC3ZPHwy8WLiK3Ya78fAvzLfHeGD3ADEAAAAASUVORK5CYII=",class:"icon-small"}),S(s,{class:"card-date"},{default:h((()=>[C(y(e.$t("todo.created_at"))+": "+y(a.createdAtFormatted),1)])),_:2},1024)])),_:2},1024),a.dueDateFormatted?(p(),A(t,{key:0,class:"card-info-row"},{default:h((()=>[S(n,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA60lEQVR4nO2aQQ6DMAwE/SPCNekDeur/z214x1ZGBSFKSkShOM2u5ANYrDNYcS4RyRQu7RXBPRAc+vDuru9yvz/bf1RvPBSZFJNC/EcN5qln6/7lgcC3N4Sme2vvLOaF9g7J9m86XfPCH1mHsAXiNOJqaw9r/U7+SOXrAfG2xi82g+iBNS12xIHo8/03g1gTCFIaCAoL+XsQKUQgiDGhehBY2cwvEQQf8r/OqQgCgjiCgFMrVAQiBnIqgoAgjiDg1AoVgYiBnIogIIgjCDi1QgUg1gSCGBNqAIlnbegvIiaucBQFExevcFBiQ0+HIVZjd/jiCwAAAABJRU5ErkJggg==",class:"icon-small"}),S(s,{class:"card-date text-danger"},{default:h((()=>[C(y(e.$t("todo.expired_at"))+": "+y(a.dueDateFormatted),1)])),_:2},1024)])),_:2},1024)):D("",!0),a.notifyAtFormatted?(p(),A(t,{key:1,class:"card-info-row"},{default:h((()=>[S(n,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEmUlEQVR4nO1YXYhVVRReZlmT/VLRP2JUlBVFEFFBD/WkBYk5Vi8mZRLZFOM43bPXGThpUI5PEr0Y/YBEGRT0Zw85FRKUhZmp9RJWZtpLZY1mBekXa+91ztn3nnPuzJy5M3MvnA8O3LPut9fP2XuvvfYiqlChQoUKgggziDFIBgeIsZ8Yz1hZx8FgDTFQ9xg8TR0HtrMACnEzGdyiweyfHOMGt1MvulqiK56FovfxoBddFOK2IsPnk8FfxPiO+jCztJEQsynECm85/UmM3733BynAmaX192Gm9ZFxmFbivLxAnlNDb5QOQMYaHM3sjexe+ZsM1lKEM0rZYrypup6t/8PgXDL4lxj/0QCu9OT3ksHj1I3pTRUbLLBfyDkps/o8GcynELMowsn2kd8iM1ivHHFkD9VwbVPd3ZhufRBfUntzrK+Mf8jgHD/Cx9SJtxJZhJOIsVcN3lVoKMCdySwYvJo/3Q0QDuM1HXOQBnBNk480X3k/Ug9O9OTvqG+P+uTPNcN0e7LlquBLinBcQRCXEuMP5a2mMQHTiPGUOrOX+nFqLk1sG3ylvIcTeYh71O5nseDiZFP6GYuxTQffXeiLwUYdu9E6NmZgmt1Xzs66Qpp8YMf5IpGJry6RHKMncFFKMnivYQ3KwF8LT+MAl+uSOmIzXlmIE7LWRU+As3I5sqTizGdwRSJnbFLZQnF6rTodeYH0KOHFQgcY/TruhdJBpLo2ZNd7AwxeznAMnlTZoLx8aF8CzPMIryhhKRWB8cGIS2+0CHHfiKmfsUztbahLNE42JE7vViVzvEB2KuG6Jor3aIKYPe5ABnBZko6LwLheOTsSmcHV6vtuIfxiX/y0mSfLKnbnxniqgBgRTlMnhws5/bhAnf45I7M1nNusaMhYTiZnSXEgraudRqOvF13KOZIvk3Kh0em84KY6kD5bYwnncCKTisEL5IC+pCmUsc/KbH5uk0BCzEoOz3TMhelyizf7AK7yCNs1k93YNoEEuEk52zKbnbFLFAxl0i/jJY20p20CYa0H/XMrTr8Gm4UwmHMgPpSWHm0TyOvJfSaVrVLZGnF6oSrZlBACXGJrGINDhel1MgOJcIr1RXzyzy2D99ND2RWNxzJFo8EnSlo85YEwluiX39KQsYbTotERtypxkTf4gWQjNZbxEc5W/m8tC8RVsqAaTs9crBjf6D6+P1PGMz7N20hve87OIIPv1eEFdcpD3Kr87S0MxGXPADfUyWXZxOXLMpzgyd9V35bnX3Xra65FNsgIxxf0rNa1MJD1maQjENvig79a5KhwV4iGq67ffJCLfTPIV0l7VgUtmRJgzFX7++qutGNqPoylHSTr1E3pt+VuhQWQfci2zSMOPlK+HTSaBp1rSPyQ2XitAmOpfqSfmhasTRt0ozMUH55fj9giKoNu2/qJ70KDNCGQusslg6O2lztRCCbajtzM4kNr8p4drQ/E4OMpCOQjmjK4sgH2Gpr9z90fpKnX9jDalWHUcv4L9L8hansw7tAUKpVCzc6MaxLUVCaBzKWOgMHqJut+FXUUAszT2+ewPkOdMxMVKlSoQBOM/wGpjQxvGNthDwAAAABJRU5ErkJggg==",class:"icon-small"}),S(s,{class:"card-date text-primary"},{default:h((()=>[C(y(e.$t("todo.notify_at"))+": "+y(a.notifyAtFormatted),1)])),_:2},1024)])),_:2},1024)):D("",!0),S(t,{class:"card-row bot-row"},{default:h((()=>[S(t,{class:"code-tag"},{default:h((()=>[C("#"+y(a.code),1)])),_:2},1024),S(me,{status:a.status},null,8,["status"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),M(ga)?(p(),A(t,{key:0,class:"loading-more"},{default:h((()=>[S(s,{class:"loading-text"},{default:h((()=>[C(y(e.$t("common.loading_more"))+"...",1)])),_:1})])),_:1})):D("",!0),S(t,{style:{height:"20px"}})])),_:1}))])),_:1})])),_:1},8,["scroll-top","scroll-with-animation","refresher-enabled","refresher-triggered","onRefresherrefresh"]),S(t,{class:k(["pagination-drawer",{expanded:Ta.value}])},{default:h((()=>[S(t,{class:"pagination-handle",onClick:La},{default:h((()=>[S(s,{class:"current-page-badge"},{default:h((()=>[C(y(M(f)),1)])),_:1}),C(),Ta.value?(p(),A(s,{key:1,class:"handle-icon"},{default:h((()=>[C("›")])),_:1})):(p(),A(s,{key:0,class:"handle-icon"},{default:h((()=>[C("‹")])),_:1}))])),_:1}),Ta.value?(p(),A(v,{key:0,"scroll-y":"",class:"pagination-list"},{default:h((()=>[S(t,{class:"page-title"},{default:h((()=>[C(y(e.$t("common.page")),1)])),_:1}),(p(!0),U(E,null,w(M(pe),(e=>(p(),A(t,{key:e,class:k(["page-number-item",{active:e===M(f),loaded:e<=M(Xe)}]),onClick:a=>{return t=e,Ta.value=!1,void Z(t).then((e=>{null!==e&&z((()=>{setTimeout((()=>{0===e?(i.value=r.value,setTimeout((()=>{i.value=0}),10)):Q().in(o).selectAll(".card-item").boundingClientRect((a=>{if(Array.isArray(a)&&a.length>e){let t=0;for(let l=0;l<e;l++)t+=a[l].height+15;t+=15,t+=5,i.value=r.value,setTimeout((()=>{i.value=t}),10)}else{const a=135*e+5;i.value=r.value,setTimeout((()=>{i.value=a}),10)}})).exec()}),100)}))}));var t}},{default:h((()=>[C(y(e),1)])),_:2},1032,["class","onClick"])))),128)),S(t,{style:{height:"20px"}})])),_:1})):D("",!0)])),_:1},8,["class"])])),_:1}),S(t,{class:"pagination-footer"},{default:h((()=>[S(le,{range:Pa.value||M(te),value:ba.value,onChange:Sa,title:e.$t("common.page_unit")},{default:h((()=>[S(t,{class:"page-size-selector"},{default:h((()=>[S(s,{class:"size-text"},{default:h((()=>[C(y(M($e))+" / "+y(e.$t("common.page_unit")),1)])),_:1}),S(s,{class:"dropdown-arrow"},{default:h((()=>[C("▼")])),_:1})])),_:1})])),_:1},8,["range","value","title"]),S(s,{class:"total-text"},{default:h((()=>[C(y(e.$t("common.total"))+": "+y(M(je)),1)])),_:1}),S(t,{class:"add-task-simple",onClick:M(Ee)},{default:h((()=>[S(s,{class:"plus-icon"},{default:h((()=>[C("+")])),_:1}),S(s,{class:"add-text"},{default:h((()=>[C(y(e.$t("todo.add_task")),1)])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1}),M(j)?(p(),A(t,{key:0,class:"filter-overlay",onClick:R(M(Fe),["stop"])},{default:h((()=>[S(t,{class:"filter-panel",onClick:a[8]||(a[8]=R((()=>{}),["stop"]))},{default:h((()=>[S(t,{class:"filter-header"},{default:h((()=>[S(s,{class:"filter-title"},{default:h((()=>[C(y(e.$t("todo.filter_title")),1)])),_:1}),S(s,{class:"close-btn",onClick:M(Fe)},{default:h((()=>[C("✕")])),_:1},8,["onClick"])])),_:1}),S(v,{"scroll-y":"",class:"filter-body"},{default:h((()=>[S(t,{class:"f-group"},{default:h((()=>[S(s,{class:"f-label"},{default:h((()=>[C(y(e.$t("todo.search_label")),1)])),_:1}),S(m,{class:"f-input",modelValue:M(W).title,"onUpdate:modelValue":a[0]||(a[0]=e=>M(W).title=e),placeholder:e.$t("todo.search_placeholder"),"placeholder-class":"input-placeholder"},null,8,["modelValue","placeholder"])])),_:1}),S(t,{class:"f-group"},{default:h((()=>[S(s,{class:"f-label"},{default:h((()=>[C(y(e.$t("todo.code_prefix")),1)])),_:1}),S(m,{class:"f-input",modelValue:M(W).jobCode,"onUpdate:modelValue":a[1]||(a[1]=e=>M(W).jobCode=e),placeholder:e.$t("todo.job_code_placeholder"),"placeholder-class":"input-placeholder"},null,8,["modelValue","placeholder"])])),_:1}),S(t,{class:"f-group"},{default:h((()=>[S(s,{class:"f-label"},{default:h((()=>[C(y(e.$t("todo.status")),1)])),_:1}),S(le,{range:M(Ce),value:M(ye),onChange:M(ke),title:e.$t("todo.status")},{default:h((()=>[S(t,{class:"f-picker"},{default:h((()=>[C(y(M(Ce)[M(ye)])+" ",1),S(s,{class:"arrow"},{default:h((()=>[C("▼")])),_:1})])),_:1})])),_:1},8,["range","value","onChange","title"])])),_:1}),S(t,{class:"f-group"},{default:h((()=>[S(s,{class:"f-label"},{default:h((()=>[C(y(e.$t("todo.creator")),1)])),_:1}),S(le,{range:M(_e),value:M(Te),onChange:M(Pe),title:e.$t("todo.creator")},{default:h((()=>[S(t,{class:"f-picker"},{default:h((()=>[C(y(M(_e)[M(Te)])+" ",1),S(s,{class:"arrow"},{default:h((()=>[C("▼")])),_:1})])),_:1})])),_:1},8,["range","value","onChange","title"])])),_:1}),S(t,{class:"f-group"},{default:h((()=>[S(s,{class:"f-label"},{default:h((()=>[C(y(e.$t("todo.customer")),1)])),_:1}),S(t,{class:"f-input",onClick:M(He),style:{"justify-content":"space-between"}},{default:h((()=>[S(s,{class:k(M(Je)?"text-filled":"text-empty")},{default:h((()=>[C(y(M(Je)||e.$t("todo.select_customer")),1)])),_:1},8,["class"]),S(s,{class:"arrow"},{default:h((()=>[C("›")])),_:1})])),_:1},8,["onClick"])])),_:1}),S(t,{class:"f-group"},{default:h((()=>[S(s,{class:"f-label"},{default:h((()=>[C(y(e.$t("todo.assignee")),1)])),_:1}),S(le,{range:M(Se),value:M(xe),onChange:M(Me),title:e.$t("todo.assignee")},{default:h((()=>[S(t,{class:"f-picker"},{default:h((()=>[C(y(M(Se)[M(xe)])+" ",1),S(s,{class:"arrow"},{default:h((()=>[C("▼")])),_:1})])),_:1})])),_:1},8,["range","value","onChange","title"])])),_:1}),S(t,{class:"f-group"},{default:h((()=>[S(s,{class:"f-label"},{default:h((()=>[C(y(e.$t("todo.source")),1)])),_:1}),S(le,{range:M(De),value:M(Ue),onChange:M(we),title:e.$t("todo.source")},{default:h((()=>[S(t,{class:"f-picker"},{default:h((()=>[C(y(M(De)[M(Ue)])+" ",1),S(s,{class:"arrow"},{default:h((()=>[C("▼")])),_:1})])),_:1})])),_:1},8,["range","value","onChange","title"])])),_:1}),S(ge,{title:e.$t("todo.time_create"),startDate:M(W).createdFrom,"onUpdate:startDate":a[2]||(a[2]=e=>M(W).createdFrom=e),endDate:M(W).createdTo,"onUpdate:endDate":a[3]||(a[3]=e=>M(W).createdTo=e)},null,8,["title","startDate","endDate"]),S(ge,{title:e.$t("todo.time_expired"),startDate:M(W).dueDateFrom,"onUpdate:startDate":a[4]||(a[4]=e=>M(W).dueDateFrom=e),endDate:M(W).dueDateTo,"onUpdate:endDate":a[5]||(a[5]=e=>M(W).dueDateTo=e)},null,8,["title","startDate","endDate"]),S(ge,{title:e.$t("todo.time_notify"),startDate:M(W).notifyFrom,"onUpdate:startDate":a[6]||(a[6]=e=>M(W).notifyFrom=e),endDate:M(W).notifyTo,"onUpdate:endDate":a[7]||(a[7]=e=>M(W).notifyTo=e)},null,8,["title","startDate","endDate"]),S(t,{style:{height:"20px"}})])),_:1}),S(t,{class:"filter-footer"},{default:h((()=>[S(oe,{type:"secondary",label:e.$t("common.reset"),onClick:M(Ie)},null,8,["label","onClick"]),S(oe,{type:"primary",label:e.$t("common.apply"),onClick:M(Ne)},null,8,["label","onClick"])])),_:1})])),_:1})])),_:1},8,["onClick"])):D("",!0),M(oa)?(p(),A(t,{key:1,class:"filter-overlay",onClick:R(M(ia),["stop"])},{default:h((()=>[S(t,{class:"filter-panel quick-panel",onClick:a[9]||(a[9]=R((()=>{}),["stop"]))},{default:h((()=>[S(t,{class:"filter-header"},{default:h((()=>[S(s,{class:"filter-title"},{default:h((()=>[C(y(e.$t("todo.quick_done_title")),1)])),_:1}),S(s,{class:"close-btn",onClick:M(ia)},{default:h((()=>[C("✕")])),_:1},8,["onClick"])])),_:1}),S(v,{"scroll-y":"",class:"filter-body"},{default:h((()=>[M(na)?(p(),A(t,{key:0,class:"loading-state",style:{height:"200px"}},{default:h((()=>[S(s,null,{default:h((()=>[C(y(e.$t("common.loading")),1)])),_:1})])),_:1})):0===M(sa).length?(p(),A(t,{key:1,class:"empty-state",style:{height:"200px"}},{default:h((()=>[S(s,{class:"empty-text"},{default:h((()=>[C(y(e.$t("todo.msg_no_task_quick_done")),1)])),_:1})])),_:1})):(p(),A(t,{key:2,class:"quick-list"},{default:h((()=>[(p(!0),U(E,null,w(M(sa),(a=>(p(),A(t,{key:a.id,class:"quick-item"},{default:h((()=>[S(t,{class:"quick-info"},{default:h((()=>[S(t,{class:"quick-code"},{default:h((()=>[C("#"+y(a.code),1)])),_:2},1024),S(t,{class:"quick-title"},{default:h((()=>[C(y(a.title),1)])),_:2},1024)])),_:2},1024),S(t,{class:"quick-action"},{default:h((()=>[S(T,{class:"btn-complete",onClick:R((e=>M(ra)(a)),["stop"])},{default:h((()=>[S(s,null,{default:h((()=>[C(y(e.$t("todo.done_action")),1)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128)),S(t,{style:{height:"40px"}})])),_:1}))])),_:1})])),_:1})])),_:1},8,["onClick"])):D("",!0),S(ve,{visible:M(qe),loading:M(Ve),loadingMore:M(ta),customers:M(Ge),managers:M(aa),onClose:a[10]||(a[10]=e=>qe.value=!1),onSelect:M(Ze),onFilter:M(Ke),onLoadMore:M(la)},null,8,["visible","loading","loadingMore","customers","managers","onSelect","onFilter","onLoadMore"]),S(re,{visible:M(ee),"onUpdate:visible":a[11]||(a[11]=e=>F(ee)?ee.value=e:null),title:e.$t("common.notification"),message:M(ae)?e.$t("todo.confirm_delete_msg",{title:M(ae).title}):"","confirm-type":"danger","cancel-label":e.$t("common.cancel"),"confirm-label":e.$t("common.delete"),onConfirm:M(Be),onCancel:M(ze)},null,8,["visible","title","message","cancel-label","confirm-label","onConfirm","onCancel"]),S(t,{class:k(["custom-sheet-mask",{show:ka.value}]),onClick:a[15]||(a[15]=e=>ka.value=!1)},{default:h((()=>[S(t,{class:"custom-sheet-panel",onClick:a[14]||(a[14]=R((()=>{}),["stop"]))},{default:h((()=>[S(t,{class:"sheet-item delete",onClick:a[12]||(a[12]=e=>{return a="delete",ka.value=!1,void("delete"===a&&(ae.value=_a.value,ee.value=!0));var a})},{default:h((()=>[S(s,null,{default:h((()=>[C(y(e.$t("common.delete")),1)])),_:1})])),_:1}),S(t,{class:"sheet-gap"}),S(t,{class:"sheet-item cancel",onClick:a[13]||(a[13]=e=>ka.value=!1)},{default:h((()=>[S(s,null,{default:h((()=>[C(y(e.$t("common.cancel")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["class"]),S(se),S(ne)])),_:1},8,["class"])}}}),[["__scopeId","data-v-dddf9dfb"]]);export{pe as default};
