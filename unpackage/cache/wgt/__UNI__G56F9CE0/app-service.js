if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";const t="/static/filter.png";function a(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}function n(e,t){return"string"==typeof e?t:e}const i=(t,a=0)=>(a,n=e.getCurrentInstance())=>{!e.isInSSRComponentSetup&&e.injectHook(t,a,n)},o=i("onShow",3),s=i("onHide",3),l=i("onLaunch",1),r=i("onLoad",2),c=i("onPullDownRefresh",2),d=(e,t)=>{const a=e.__vccOpts||e;for(const[n,i]of t)a[n]=i;return a},u=d({__name:"UserAvatar",props:{name:{type:String,default:""},avatarUrl:{type:String,default:""},avatarColor:{type:String,default:"#3b82f6"},size:{type:Number,default:40}},setup(t){const a=t,n=e.computed((()=>a.name?a.name.trim().charAt(0).toUpperCase():"?"));return(a,i)=>(e.openBlock(),e.createElementBlock("view",{class:"rounded-full flex items-center justify-center overflow-hidden shrink-0",style:e.normalizeStyle({width:t.size+"px",height:t.size+"px",backgroundColor:t.avatarColor||"#e0e0e0",borderRadius:"50%"})},[t.avatarUrl?(e.openBlock(),e.createElementBlock("image",{key:0,src:t.avatarUrl,class:"w-full h-full",mode:"aspectFill"},null,8,["src"])):(e.openBlock(),e.createElementBlock("text",{key:1,class:"text-white font-bold flex items-center justify-center",style:e.normalizeStyle({fontSize:.45*t.size+"px",lineHeight:"1",display:"flex"})},e.toDisplayString(n.value),5))],4))}},[["__scopeId","data-v-b6f3425e"]]),m={id:"2852637",name:"uniui图标库",font_family:"uniicons",css_prefix_text:"uniui-",description:"",glyphs:[{icon_id:"25027049",name:"yanse",font_class:"color",unicode:"e6cf",unicode_decimal:59087},{icon_id:"25027048",name:"wallet",font_class:"wallet",unicode:"e6b1",unicode_decimal:59057},{icon_id:"25015720",name:"settings-filled",font_class:"settings-filled",unicode:"e6ce",unicode_decimal:59086},{icon_id:"25015434",name:"shimingrenzheng-filled",font_class:"auth-filled",unicode:"e6cc",unicode_decimal:59084},{icon_id:"24934246",name:"shop-filled",font_class:"shop-filled",unicode:"e6cd",unicode_decimal:59085},{icon_id:"24934159",name:"staff-filled-01",font_class:"staff-filled",unicode:"e6cb",unicode_decimal:59083},{icon_id:"24932461",name:"VIP-filled",font_class:"vip-filled",unicode:"e6c6",unicode_decimal:59078},{icon_id:"24932462",name:"plus_circle_fill",font_class:"plus-filled",unicode:"e6c7",unicode_decimal:59079},{icon_id:"24932463",name:"folder_add-filled",font_class:"folder-add-filled",unicode:"e6c8",unicode_decimal:59080},{icon_id:"24932464",name:"yanse-filled",font_class:"color-filled",unicode:"e6c9",unicode_decimal:59081},{icon_id:"24932465",name:"tune-filled",font_class:"tune-filled",unicode:"e6ca",unicode_decimal:59082},{icon_id:"24932455",name:"a-rilidaka-filled",font_class:"calendar-filled",unicode:"e6c0",unicode_decimal:59072},{icon_id:"24932456",name:"notification-filled",font_class:"notification-filled",unicode:"e6c1",unicode_decimal:59073},{icon_id:"24932457",name:"wallet-filled",font_class:"wallet-filled",unicode:"e6c2",unicode_decimal:59074},{icon_id:"24932458",name:"paihangbang-filled",font_class:"medal-filled",unicode:"e6c3",unicode_decimal:59075},{icon_id:"24932459",name:"gift-filled",font_class:"gift-filled",unicode:"e6c4",unicode_decimal:59076},{icon_id:"24932460",name:"fire-filled",font_class:"fire-filled",unicode:"e6c5",unicode_decimal:59077},{icon_id:"24928001",name:"refreshempty",font_class:"refreshempty",unicode:"e6bf",unicode_decimal:59071},{icon_id:"24926853",name:"location-ellipse",font_class:"location-filled",unicode:"e6af",unicode_decimal:59055},{icon_id:"24926735",name:"person-filled",font_class:"person-filled",unicode:"e69d",unicode_decimal:59037},{icon_id:"24926703",name:"personadd-filled",font_class:"personadd-filled",unicode:"e698",unicode_decimal:59032},{icon_id:"24923351",name:"back",font_class:"back",unicode:"e6b9",unicode_decimal:59065},{icon_id:"24923352",name:"forward",font_class:"forward",unicode:"e6ba",unicode_decimal:59066},{icon_id:"24923353",name:"arrowthinright",font_class:"arrow-right",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923353",name:"arrowthinright",font_class:"arrowthinright",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrow-left",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrowthinleft",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923355",name:"arrowthinup",font_class:"arrow-up",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923355",name:"arrowthinup",font_class:"arrowthinup",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923356",name:"arrowthindown",font_class:"arrow-down",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923356",name:"arrowthindown",font_class:"arrowthindown",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923349",name:"arrowdown",font_class:"bottom",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923349",name:"arrowdown",font_class:"arrowdown",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923346",name:"arrowright",font_class:"right",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923346",name:"arrowright",font_class:"arrowright",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923347",name:"arrowup",font_class:"top",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923347",name:"arrowup",font_class:"arrowup",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923348",name:"arrowleft",font_class:"left",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923348",name:"arrowleft",font_class:"arrowleft",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923334",name:"eye",font_class:"eye",unicode:"e651",unicode_decimal:58961},{icon_id:"24923335",name:"eye-filled",font_class:"eye-filled",unicode:"e66a",unicode_decimal:58986},{icon_id:"24923336",name:"eye-slash",font_class:"eye-slash",unicode:"e6b3",unicode_decimal:59059},{icon_id:"24923337",name:"eye-slash-filled",font_class:"eye-slash-filled",unicode:"e6b4",unicode_decimal:59060},{icon_id:"24923305",name:"info-filled",font_class:"info-filled",unicode:"e649",unicode_decimal:58953},{icon_id:"24923299",name:"reload-01",font_class:"reload",unicode:"e6b2",unicode_decimal:59058},{icon_id:"24923195",name:"mic_slash_fill",font_class:"micoff-filled",unicode:"e6b0",unicode_decimal:59056},{icon_id:"24923165",name:"map-pin-ellipse",font_class:"map-pin-ellipse",unicode:"e6ac",unicode_decimal:59052},{icon_id:"24923166",name:"map-pin",font_class:"map-pin",unicode:"e6ad",unicode_decimal:59053},{icon_id:"24923167",name:"location",font_class:"location",unicode:"e6ae",unicode_decimal:59054},{icon_id:"24923064",name:"starhalf",font_class:"starhalf",unicode:"e683",unicode_decimal:59011},{icon_id:"24923065",name:"star",font_class:"star",unicode:"e688",unicode_decimal:59016},{icon_id:"24923066",name:"star-filled",font_class:"star-filled",unicode:"e68f",unicode_decimal:59023},{icon_id:"24899646",name:"a-rilidaka",font_class:"calendar",unicode:"e6a0",unicode_decimal:59040},{icon_id:"24899647",name:"fire",font_class:"fire",unicode:"e6a1",unicode_decimal:59041},{icon_id:"24899648",name:"paihangbang",font_class:"medal",unicode:"e6a2",unicode_decimal:59042},{icon_id:"24899649",name:"font",font_class:"font",unicode:"e6a3",unicode_decimal:59043},{icon_id:"24899650",name:"gift",font_class:"gift",unicode:"e6a4",unicode_decimal:59044},{icon_id:"24899651",name:"link",font_class:"link",unicode:"e6a5",unicode_decimal:59045},{icon_id:"24899652",name:"notification",font_class:"notification",unicode:"e6a6",unicode_decimal:59046},{icon_id:"24899653",name:"staff",font_class:"staff",unicode:"e6a7",unicode_decimal:59047},{icon_id:"24899654",name:"VIP",font_class:"vip",unicode:"e6a8",unicode_decimal:59048},{icon_id:"24899655",name:"folder_add",font_class:"folder-add",unicode:"e6a9",unicode_decimal:59049},{icon_id:"24899656",name:"tune",font_class:"tune",unicode:"e6aa",unicode_decimal:59050},{icon_id:"24899657",name:"shimingrenzheng",font_class:"auth",unicode:"e6ab",unicode_decimal:59051},{icon_id:"24899565",name:"person",font_class:"person",unicode:"e699",unicode_decimal:59033},{icon_id:"24899566",name:"email-filled",font_class:"email-filled",unicode:"e69a",unicode_decimal:59034},{icon_id:"24899567",name:"phone-filled",font_class:"phone-filled",unicode:"e69b",unicode_decimal:59035},{icon_id:"24899568",name:"phone",font_class:"phone",unicode:"e69c",unicode_decimal:59036},{icon_id:"24899570",name:"email",font_class:"email",unicode:"e69e",unicode_decimal:59038},{icon_id:"24899571",name:"personadd",font_class:"personadd",unicode:"e69f",unicode_decimal:59039},{icon_id:"24899558",name:"chatboxes-filled",font_class:"chatboxes-filled",unicode:"e692",unicode_decimal:59026},{icon_id:"24899559",name:"contact",font_class:"contact",unicode:"e693",unicode_decimal:59027},{icon_id:"24899560",name:"chatbubble-filled",font_class:"chatbubble-filled",unicode:"e694",unicode_decimal:59028},{icon_id:"24899561",name:"contact-filled",font_class:"contact-filled",unicode:"e695",unicode_decimal:59029},{icon_id:"24899562",name:"chatboxes",font_class:"chatboxes",unicode:"e696",unicode_decimal:59030},{icon_id:"24899563",name:"chatbubble",font_class:"chatbubble",unicode:"e697",unicode_decimal:59031},{icon_id:"24881290",name:"upload-filled",font_class:"upload-filled",unicode:"e68e",unicode_decimal:59022},{icon_id:"24881292",name:"upload",font_class:"upload",unicode:"e690",unicode_decimal:59024},{icon_id:"24881293",name:"weixin",font_class:"weixin",unicode:"e691",unicode_decimal:59025},{icon_id:"24881274",name:"compose",font_class:"compose",unicode:"e67f",unicode_decimal:59007},{icon_id:"24881275",name:"qq",font_class:"qq",unicode:"e680",unicode_decimal:59008},{icon_id:"24881276",name:"download-filled",font_class:"download-filled",unicode:"e681",unicode_decimal:59009},{icon_id:"24881277",name:"pengyouquan",font_class:"pyq",unicode:"e682",unicode_decimal:59010},{icon_id:"24881279",name:"sound",font_class:"sound",unicode:"e684",unicode_decimal:59012},{icon_id:"24881280",name:"trash-filled",font_class:"trash-filled",unicode:"e685",unicode_decimal:59013},{icon_id:"24881281",name:"sound-filled",font_class:"sound-filled",unicode:"e686",unicode_decimal:59014},{icon_id:"24881282",name:"trash",font_class:"trash",unicode:"e687",unicode_decimal:59015},{icon_id:"24881284",name:"videocam-filled",font_class:"videocam-filled",unicode:"e689",unicode_decimal:59017},{icon_id:"24881285",name:"spinner-cycle",font_class:"spinner-cycle",unicode:"e68a",unicode_decimal:59018},{icon_id:"24881286",name:"weibo",font_class:"weibo",unicode:"e68b",unicode_decimal:59019},{icon_id:"24881288",name:"videocam",font_class:"videocam",unicode:"e68c",unicode_decimal:59020},{icon_id:"24881289",name:"download",font_class:"download",unicode:"e68d",unicode_decimal:59021},{icon_id:"24879601",name:"help",font_class:"help",unicode:"e679",unicode_decimal:59001},{icon_id:"24879602",name:"navigate-filled",font_class:"navigate-filled",unicode:"e67a",unicode_decimal:59002},{icon_id:"24879603",name:"plusempty",font_class:"plusempty",unicode:"e67b",unicode_decimal:59003},{icon_id:"24879604",name:"smallcircle",font_class:"smallcircle",unicode:"e67c",unicode_decimal:59004},{icon_id:"24879605",name:"minus-filled",font_class:"minus-filled",unicode:"e67d",unicode_decimal:59005},{icon_id:"24879606",name:"micoff",font_class:"micoff",unicode:"e67e",unicode_decimal:59006},{icon_id:"24879588",name:"closeempty",font_class:"closeempty",unicode:"e66c",unicode_decimal:58988},{icon_id:"24879589",name:"clear",font_class:"clear",unicode:"e66d",unicode_decimal:58989},{icon_id:"24879590",name:"navigate",font_class:"navigate",unicode:"e66e",unicode_decimal:58990},{icon_id:"24879591",name:"minus",font_class:"minus",unicode:"e66f",unicode_decimal:58991},{icon_id:"24879592",name:"image",font_class:"image",unicode:"e670",unicode_decimal:58992},{icon_id:"24879593",name:"mic",font_class:"mic",unicode:"e671",unicode_decimal:58993},{icon_id:"24879594",name:"paperplane",font_class:"paperplane",unicode:"e672",unicode_decimal:58994},{icon_id:"24879595",name:"close",font_class:"close",unicode:"e673",unicode_decimal:58995},{icon_id:"24879596",name:"help-filled",font_class:"help-filled",unicode:"e674",unicode_decimal:58996},{icon_id:"24879597",name:"plus-filled",font_class:"paperplane-filled",unicode:"e675",unicode_decimal:58997},{icon_id:"24879598",name:"plus",font_class:"plus",unicode:"e676",unicode_decimal:58998},{icon_id:"24879599",name:"mic-filled",font_class:"mic-filled",unicode:"e677",unicode_decimal:58999},{icon_id:"24879600",name:"image-filled",font_class:"image-filled",unicode:"e678",unicode_decimal:59e3},{icon_id:"24855900",name:"locked-filled",font_class:"locked-filled",unicode:"e668",unicode_decimal:58984},{icon_id:"24855901",name:"info",font_class:"info",unicode:"e669",unicode_decimal:58985},{icon_id:"24855903",name:"locked",font_class:"locked",unicode:"e66b",unicode_decimal:58987},{icon_id:"24855884",name:"camera-filled",font_class:"camera-filled",unicode:"e658",unicode_decimal:58968},{icon_id:"24855885",name:"chat-filled",font_class:"chat-filled",unicode:"e659",unicode_decimal:58969},{icon_id:"24855886",name:"camera",font_class:"camera",unicode:"e65a",unicode_decimal:58970},{icon_id:"24855887",name:"circle",font_class:"circle",unicode:"e65b",unicode_decimal:58971},{icon_id:"24855888",name:"checkmarkempty",font_class:"checkmarkempty",unicode:"e65c",unicode_decimal:58972},{icon_id:"24855889",name:"chat",font_class:"chat",unicode:"e65d",unicode_decimal:58973},{icon_id:"24855890",name:"circle-filled",font_class:"circle-filled",unicode:"e65e",unicode_decimal:58974},{icon_id:"24855891",name:"flag",font_class:"flag",unicode:"e65f",unicode_decimal:58975},{icon_id:"24855892",name:"flag-filled",font_class:"flag-filled",unicode:"e660",unicode_decimal:58976},{icon_id:"24855893",name:"gear-filled",font_class:"gear-filled",unicode:"e661",unicode_decimal:58977},{icon_id:"24855894",name:"home",font_class:"home",unicode:"e662",unicode_decimal:58978},{icon_id:"24855895",name:"home-filled",font_class:"home-filled",unicode:"e663",unicode_decimal:58979},{icon_id:"24855896",name:"gear",font_class:"gear",unicode:"e664",unicode_decimal:58980},{icon_id:"24855897",name:"smallcircle-filled",font_class:"smallcircle-filled",unicode:"e665",unicode_decimal:58981},{icon_id:"24855898",name:"map-filled",font_class:"map-filled",unicode:"e666",unicode_decimal:58982},{icon_id:"24855899",name:"map",font_class:"map",unicode:"e667",unicode_decimal:58983},{icon_id:"24855825",name:"refresh-filled",font_class:"refresh-filled",unicode:"e656",unicode_decimal:58966},{icon_id:"24855826",name:"refresh",font_class:"refresh",unicode:"e657",unicode_decimal:58967},{icon_id:"24855808",name:"cloud-upload",font_class:"cloud-upload",unicode:"e645",unicode_decimal:58949},{icon_id:"24855809",name:"cloud-download-filled",font_class:"cloud-download-filled",unicode:"e646",unicode_decimal:58950},{icon_id:"24855810",name:"cloud-download",font_class:"cloud-download",unicode:"e647",unicode_decimal:58951},{icon_id:"24855811",name:"cloud-upload-filled",font_class:"cloud-upload-filled",unicode:"e648",unicode_decimal:58952},{icon_id:"24855813",name:"redo",font_class:"redo",unicode:"e64a",unicode_decimal:58954},{icon_id:"24855814",name:"images-filled",font_class:"images-filled",unicode:"e64b",unicode_decimal:58955},{icon_id:"24855815",name:"undo-filled",font_class:"undo-filled",unicode:"e64c",unicode_decimal:58956},{icon_id:"24855816",name:"more",font_class:"more",unicode:"e64d",unicode_decimal:58957},{icon_id:"24855817",name:"more-filled",font_class:"more-filled",unicode:"e64e",unicode_decimal:58958},{icon_id:"24855818",name:"undo",font_class:"undo",unicode:"e64f",unicode_decimal:58959},{icon_id:"24855819",name:"images",font_class:"images",unicode:"e650",unicode_decimal:58960},{icon_id:"24855821",name:"paperclip",font_class:"paperclip",unicode:"e652",unicode_decimal:58962},{icon_id:"24855822",name:"settings",font_class:"settings",unicode:"e653",unicode_decimal:58963},{icon_id:"24855823",name:"search",font_class:"search",unicode:"e654",unicode_decimal:58964},{icon_id:"24855824",name:"redo-filled",font_class:"redo-filled",unicode:"e655",unicode_decimal:58965},{icon_id:"24841702",name:"list",font_class:"list",unicode:"e644",unicode_decimal:58948},{icon_id:"24841489",name:"mail-open-filled",font_class:"mail-open-filled",unicode:"e63a",unicode_decimal:58938},{icon_id:"24841491",name:"hand-thumbsdown-filled",font_class:"hand-down-filled",unicode:"e63c",unicode_decimal:58940},{icon_id:"24841492",name:"hand-thumbsdown",font_class:"hand-down",unicode:"e63d",unicode_decimal:58941},{icon_id:"24841493",name:"hand-thumbsup-filled",font_class:"hand-up-filled",unicode:"e63e",unicode_decimal:58942},{icon_id:"24841494",name:"hand-thumbsup",font_class:"hand-up",unicode:"e63f",unicode_decimal:58943},{icon_id:"24841496",name:"heart-filled",font_class:"heart-filled",unicode:"e641",unicode_decimal:58945},{icon_id:"24841498",name:"mail-open",font_class:"mail-open",unicode:"e643",unicode_decimal:58947},{icon_id:"24841488",name:"heart",font_class:"heart",unicode:"e639",unicode_decimal:58937},{icon_id:"24839963",name:"loop",font_class:"loop",unicode:"e633",unicode_decimal:58931},{icon_id:"24839866",name:"pulldown",font_class:"pulldown",unicode:"e632",unicode_decimal:58930},{icon_id:"24813798",name:"scan",font_class:"scan",unicode:"e62a",unicode_decimal:58922},{icon_id:"24813786",name:"bars",font_class:"bars",unicode:"e627",unicode_decimal:58919},{icon_id:"24813788",name:"cart-filled",font_class:"cart-filled",unicode:"e629",unicode_decimal:58921},{icon_id:"24813790",name:"checkbox",font_class:"checkbox",unicode:"e62b",unicode_decimal:58923},{icon_id:"24813791",name:"checkbox-filled",font_class:"checkbox-filled",unicode:"e62c",unicode_decimal:58924},{icon_id:"24813794",name:"shop",font_class:"shop",unicode:"e62f",unicode_decimal:58927},{icon_id:"24813795",name:"headphones",font_class:"headphones",unicode:"e630",unicode_decimal:58928},{icon_id:"24813796",name:"cart",font_class:"cart",unicode:"e631",unicode_decimal:58929}]};const h=d({name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""}},data:()=>({icons:m.glyphs}),computed:{unicode(){let e=this.icons.find((e=>e.font_class===this.type));return e?unescape(`%u${e.unicode}`):""},iconSize(){return"number"==typeof(e=this.size)||/^[0-9]*$/g.test(e)?e+"px":e;var e}},methods:{_onClick(){this.$emit("click")}}},[["render",function(t,a,n,i,o,s){return e.openBlock(),e.createElementBlock("text",{style:e.normalizeStyle({color:n.color,"font-size":s.iconSize}),class:e.normalizeClass(["uni-icons",["uniui-"+n.type,n.customPrefix,n.customPrefix?n.type:""]]),onClick:a[0]||(a[0]=(...e)=>s._onClick&&s._onClick(...e))},null,6)}],["__scopeId","data-v-7c2f6cb0"]]);function p(e,t){return`${g(e)} ${f(e,t)}`}function g(e){e=w(e);const t=(e=new Date(e)).getFullYear(),a=e.getMonth()+1,n=e.getDate();return`${t}-${v(a)}-${v(n)}`}function f(e,t){e=w(e);const a=(e=new Date(e)).getHours(),n=e.getMinutes(),i=e.getSeconds();return t?`${v(a)}:${v(n)}`:`${v(a)}:${v(n)}:${v(i)}`}function v(e){return e<10&&(e=`0${e}`),e}function _(e){return e?"00:00":"00:00:00"}function y(e,t){return(e=new Date(w(e)))<=(t=new Date(w(t)))}function k(e){return e.match(/((19|20)\d{2})(-|\/)\d{1,2}(-|\/)\d{1,2}/g)}const b=/^\d{4}-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01])( [0-5]?[0-9]:[0-5]?[0-9]:[0-5]?[0-9])?$/;function w(e){return"string"==typeof e&&b.test(e)&&(e=e.replace(/-/g,"/")),e}const D=d({props:{weeks:{type:Object,default:()=>({})},calendar:{type:Object,default:()=>({})},selected:{type:Array,default:()=>[]},checkHover:{type:Boolean,default:!1}},methods:{choiceDate(e){this.$emit("change",e)},handleMousemove(e){this.$emit("handleMouse",e)}}},[["render",function(t,a,n,i,o,s){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-calendar-item__weeks-box",{"uni-calendar-item--disable":n.weeks.disable,"uni-calendar-item--before-checked-x":n.weeks.beforeMultiple,"uni-calendar-item--multiple":n.weeks.multiple,"uni-calendar-item--after-checked-x":n.weeks.afterMultiple}]),onClick:a[0]||(a[0]=e=>s.choiceDate(n.weeks)),onMouseenter:a[1]||(a[1]=e=>s.handleMousemove(n.weeks))},[e.createElementVNode("view",{class:e.normalizeClass(["uni-calendar-item__weeks-box-item",{"uni-calendar-item--checked":n.calendar.fullDate===n.weeks.fullDate&&(n.calendar.userChecked||!n.checkHover),"uni-calendar-item--checked-range-text":n.checkHover,"uni-calendar-item--before-checked":n.weeks.beforeMultiple,"uni-calendar-item--multiple":n.weeks.multiple,"uni-calendar-item--after-checked":n.weeks.afterMultiple,"uni-calendar-item--disable":n.weeks.disable}])},[n.selected&&n.weeks.extraInfo?(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-calendar-item__weeks-box-circle"})):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"uni-calendar-item__weeks-box-text uni-calendar-item__weeks-box-text-disable uni-calendar-item--checked-text"},e.toDisplayString(n.weeks.date),1)],2),e.createElementVNode("view",{class:e.normalizeClass({"uni-calendar-item--today":n.weeks.isToday})},null,2)],34)}],["__scopeId","data-v-ee11a364"]]);const S=d({name:"UniDatetimePicker",data:()=>({indicatorStyle:"height: 50px;",visible:!1,fixNvueBug:{},dateShow:!0,timeShow:!0,title:"日期和时间",time:"",year:1920,month:0,day:0,hour:0,minute:0,second:0,startYear:1920,startMonth:1,startDay:1,startHour:0,startMinute:0,startSecond:0,endYear:2120,endMonth:12,endDay:31,endHour:23,endMinute:59,endSecond:59}),props:{type:{type:String,default:"datetime"},value:{type:[String,Number],default:""},modelValue:{type:[String,Number],default:""},start:{type:[Number,String],default:""},end:{type:[Number,String],default:""},returnType:{type:String,default:"string"},disabled:{type:[Boolean,String],default:!1},border:{type:[Boolean,String],default:!0},hideSecond:{type:[Boolean,String],default:!1}},watch:{modelValue:{handler(e){e?(this.parseValue(w(e)),this.initTime(!1)):(this.time="",this.parseValue(Date.now()))},immediate:!0},type:{handler(e){"date"===e?(this.dateShow=!0,this.timeShow=!1,this.title="日期"):"time"===e?(this.dateShow=!1,this.timeShow=!0,this.title="时间"):(this.dateShow=!0,this.timeShow=!0,this.title="日期和时间")},immediate:!0},start:{handler(e){this.parseDatetimeRange(w(e),"start")},immediate:!0},end:{handler(e){this.parseDatetimeRange(w(e),"end")},immediate:!0},months(e){this.checkValue("month",this.month,e)},days(e){this.checkValue("day",this.day,e)},hours(e){this.checkValue("hour",this.hour,e)},minutes(e){this.checkValue("minute",this.minute,e)},seconds(e){this.checkValue("second",this.second,e)}},computed:{years(){return this.getCurrentRange("year")},months(){return this.getCurrentRange("month")},days(){return this.getCurrentRange("day")},hours(){return this.getCurrentRange("hour")},minutes(){return this.getCurrentRange("minute")},seconds(){return this.getCurrentRange("second")},ymd(){return[this.year-this.minYear,this.month-this.minMonth,this.day-this.minDay]},hms(){return[this.hour-this.minHour,this.minute-this.minMinute,this.second-this.minSecond]},currentDateIsStart(){return this.year===this.startYear&&this.month===this.startMonth&&this.day===this.startDay},currentDateIsEnd(){return this.year===this.endYear&&this.month===this.endMonth&&this.day===this.endDay},minYear(){return this.startYear},maxYear(){return this.endYear},minMonth(){return this.year===this.startYear?this.startMonth:1},maxMonth(){return this.year===this.endYear?this.endMonth:12},minDay(){return this.year===this.startYear&&this.month===this.startMonth?this.startDay:1},maxDay(){return this.year===this.endYear&&this.month===this.endMonth?this.endDay:this.daysInMonth(this.year,this.month)},minHour(){return"datetime"===this.type?this.currentDateIsStart?this.startHour:0:"time"===this.type?this.startHour:void 0},maxHour(){return"datetime"===this.type?this.currentDateIsEnd?this.endHour:23:"time"===this.type?this.endHour:void 0},minMinute(){return"datetime"===this.type?this.currentDateIsStart&&this.hour===this.startHour?this.startMinute:0:"time"===this.type?this.hour===this.startHour?this.startMinute:0:void 0},maxMinute(){return"datetime"===this.type?this.currentDateIsEnd&&this.hour===this.endHour?this.endMinute:59:"time"===this.type?this.hour===this.endHour?this.endMinute:59:void 0},minSecond(){return"datetime"===this.type?this.currentDateIsStart&&this.hour===this.startHour&&this.minute===this.startMinute?this.startSecond:0:"time"===this.type?this.hour===this.startHour&&this.minute===this.startMinute?this.startSecond:0:void 0},maxSecond(){return"datetime"===this.type?this.currentDateIsEnd&&this.hour===this.endHour&&this.minute===this.endMinute?this.endSecond:59:"time"===this.type?this.hour===this.endHour&&this.minute===this.endMinute?this.endSecond:59:void 0},selectTimeText(){return this.$t("uni-datetime-picker.selectTime")},okText(){return this.$t("uni-datetime-picker.ok")},clearText(){return this.$t("uni-datetime-picker.clear")},cancelText(){return this.$t("uni-datetime-picker.cancel")}},mounted(){},methods:{lessThanTen:e=>e<10?"0"+e:e,parseTimeType(e){if(e){let t=e.split(":");this.hour=Number(t[0]),this.minute=Number(t[1]),this.second=Number(t[2])}},initPickerValue(e){let t=null;e?t=this.compareValueWithStartAndEnd(e,this.start,this.end):(t=Date.now(),t=this.compareValueWithStartAndEnd(t,this.start,this.end)),this.parseValue(t)},compareValueWithStartAndEnd(e,t,a){let n=null;return e=this.superTimeStamp(e),t=this.superTimeStamp(t),a=this.superTimeStamp(a),n=t&&a?e<t?new Date(t):e>a?new Date(a):new Date(e):t&&!a?t<=e?new Date(e):new Date(t):!t&&a?e<=a?new Date(e):new Date(a):new Date(e),n},superTimeStamp(e){let t="";if("time"===this.type&&e&&"string"==typeof e){const e=new Date;t=e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" "}return Number(e)&&(e=parseInt(e),t=0),this.createTimeStamp(t+e)},parseValue(e){if(e){if("time"===this.type&&"string"==typeof e)this.parseTimeType(e);else{let t=null;t=new Date(e),"time"!==this.type&&(this.year=t.getFullYear(),this.month=t.getMonth()+1,this.day=t.getDate()),"date"!==this.type&&(this.hour=t.getHours(),this.minute=t.getMinutes(),this.second=t.getSeconds())}this.hideSecond&&(this.second=0)}},parseDatetimeRange(e,t){if(!e)return"start"===t&&(this.startYear=1920,this.startMonth=1,this.startDay=1,this.startHour=0,this.startMinute=0,this.startSecond=0),void("end"===t&&(this.endYear=2120,this.endMonth=12,this.endDay=31,this.endHour=23,this.endMinute=59,this.endSecond=59));if("time"===this.type){const a=e.split(":");this[t+"Hour"]=Number(a[0]),this[t+"Minute"]=Number(a[1]),this[t+"Second"]=Number(a[2])}else{if(!e)return void("start"===t?this.startYear=this.year-60:this.endYear=this.year+60);Number(e)&&(e=parseInt(e));const a=/[0-9]:[0-9]/;"datetime"!==this.type||"end"!==t||"string"!=typeof e||a.test(e)||(e+=" 23:59:59");const n=new Date(e);this[t+"Year"]=n.getFullYear(),this[t+"Month"]=n.getMonth()+1,this[t+"Day"]=n.getDate(),"datetime"===this.type&&(this[t+"Hour"]=n.getHours(),this[t+"Minute"]=n.getMinutes(),this[t+"Second"]=n.getSeconds())}},getCurrentRange(e){const t=[];for(let a=this["min"+this.capitalize(e)];a<=this["max"+this.capitalize(e)];a++)t.push(a);return t},capitalize:e=>e.charAt(0).toUpperCase()+e.slice(1),checkValue(e,t,a){-1===a.indexOf(t)&&(this[e]=a[0])},daysInMonth:(e,t)=>new Date(e,t,0).getDate(),fixIosDateFormat:e=>("string"==typeof e&&(e=e.replace(/-/g,"/")),e),createTimeStamp(e){if(e)return"number"==typeof e?e:(e=e.replace(/-/g,"/"),"date"===this.type&&(e+=" 00:00:00"),Date.parse(e))},createDomSting(){const e=this.year+"-"+this.lessThanTen(this.month)+"-"+this.lessThanTen(this.day);let t=this.lessThanTen(this.hour)+":"+this.lessThanTen(this.minute);return this.hideSecond||(t=t+":"+this.lessThanTen(this.second)),"date"===this.type?e:"time"===this.type?t:e+" "+t},initTime(e=!0){this.time=this.createDomSting(),e&&("timestamp"===this.returnType&&"time"!==this.type?(this.$emit("change",this.createTimeStamp(this.time)),this.$emit("input",this.createTimeStamp(this.time)),this.$emit("update:modelValue",this.createTimeStamp(this.time))):(this.$emit("change",this.time),this.$emit("input",this.time),this.$emit("update:modelValue",this.time)))},bindDateChange(e){const t=e.detail.value;this.year=this.years[t[0]],this.month=this.months[t[1]],this.day=this.days[t[2]]},bindTimeChange(e){const t=e.detail.value;this.hour=this.hours[t[0]],this.minute=this.minutes[t[1]],this.second=this.seconds[t[2]]},initTimePicker(){if(this.disabled)return;const e=w(this.time);this.initPickerValue(e),this.visible=!this.visible},tiggerTimePicker(e){this.visible=!this.visible},clearTime(){this.time="",this.$emit("change",this.time),this.$emit("input",this.time),this.$emit("update:modelValue",this.time),this.tiggerTimePicker()},setTime(){this.initTime(),this.tiggerTimePicker()}}},[["render",function(t,a,n,i,o,s){return e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker"},[e.createElementVNode("view",{onClick:a[0]||(a[0]=(...e)=>s.initTimePicker&&s.initTimePicker(...e))},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-datetime-picker-timebox-pointer",{"uni-datetime-picker-disabled":n.disabled,"uni-datetime-picker-timebox":n.border}])},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(o.time),1),o.time?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-datetime-picker-time"},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(s.selectTimeText),1)]))],2)]),!0)]),o.visible?(e.openBlock(),e.createElementBlock("view",{key:0,id:"mask",class:"uni-datetime-picker-mask",onClick:a[1]||(a[1]=(...e)=>s.tiggerTimePicker&&s.tiggerTimePicker(...e))})):e.createCommentVNode("",!0),o.visible?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["uni-datetime-picker-popup",[o.dateShow&&o.timeShow?"":"fix-nvue-height"]]),style:e.normalizeStyle(o.fixNvueBug)},[e.createElementVNode("view",{class:"uni-title"},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(s.selectTimeText),1)]),o.dateShow?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-datetime-picker__container-box"},[e.createElementVNode("picker-view",{class:"uni-datetime-picker-view","indicator-style":o.indicatorStyle,value:s.ymd,onChange:a[2]||(a[2]=(...e)=>s.bindDateChange&&s.bindDateChange(...e))},[e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.years,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(s.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.months,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(s.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.days,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(s.lessThanTen(t)),1)])))),128))])],40,["indicator-style","value"]),e.createElementVNode("text",{class:"uni-datetime-picker-sign sign-left"},"-"),e.createElementVNode("text",{class:"uni-datetime-picker-sign sign-right"},"-")])):e.createCommentVNode("",!0),o.timeShow?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-datetime-picker__container-box"},[e.createElementVNode("picker-view",{class:e.normalizeClass(["uni-datetime-picker-view",[n.hideSecond?"time-hide-second":""]]),"indicator-style":o.indicatorStyle,value:s.hms,onChange:a[3]||(a[3]=(...e)=>s.bindTimeChange&&s.bindTimeChange(...e))},[e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.hours,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(s.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.minutes,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(s.lessThanTen(t)),1)])))),128))]),n.hideSecond?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("picker-view-column",{key:0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.seconds,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(s.lessThanTen(t)),1)])))),128))]))],42,["indicator-style","value"]),e.createElementVNode("text",{class:e.normalizeClass(["uni-datetime-picker-sign",[n.hideSecond?"sign-center":"sign-left"]])},":",2),n.hideSecond?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-datetime-picker-sign sign-right"},":"))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"uni-datetime-picker-btn"},[e.createElementVNode("view",{onClick:a[4]||(a[4]=(...e)=>s.clearTime&&s.clearTime(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(s.clearText),1)]),e.createElementVNode("view",{class:"uni-datetime-picker-btn-group"},[e.createElementVNode("view",{class:"uni-datetime-picker-cancel",onClick:a[5]||(a[5]=(...e)=>s.tiggerTimePicker&&s.tiggerTimePicker(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(s.cancelText),1)]),e.createElementVNode("view",{onClick:a[6]||(a[6]=(...e)=>s.setTime&&s.setTime(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(s.okText),1)])])])],6)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-588512f1"]]);const C=d({name:"UniDatetimePicker",options:{virtualHost:!0},components:{Calendar:d({components:{calendarItem:D,timePicker:S},props:{date:{type:String,default:""},defTime:{type:[String,Object],default:""},selectableTimes:{type:[Object],default:()=>({})},selected:{type:Array,default:()=>[]},startDate:{type:String,default:""},endDate:{type:String,default:""},startPlaceholder:{type:String,default:""},endPlaceholder:{type:String,default:""},range:{type:Boolean,default:!1},hasTime:{type:Boolean,default:!1},insert:{type:Boolean,default:!0},showMonth:{type:Boolean,default:!0},clearDate:{type:Boolean,default:!0},checkHover:{type:Boolean,default:!0},hideSecond:{type:[Boolean],default:!1},pleStatus:{type:Object,default:()=>({before:"",after:"",data:[],fulldate:""})},defaultValue:{type:[String,Object,Array],default:""}},data:()=>({show:!1,weeks:[],pickerYears:[],calendar:{},nowDate:{},aniMaskShow:!1,firstEnter:!0,time:"",timeRange:{startTime:"",endTime:""},tempSingleDate:"",tempRange:{before:"",after:""}}),watch:{date:{immediate:!0,handler(e){this.range||(this.tempSingleDate=e,setTimeout((()=>{this.init(e)}),100))}},defTime:{immediate:!0,handler(e){this.range?(this.timeRange.startTime=e.start,this.timeRange.endTime=e.end):this.time=e}},startDate(e){this.cale&&(this.cale.setStartDate(e),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},endDate(e){this.cale&&(this.cale.setEndDate(e),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},selected(e){this.cale&&(this.cale.setSelectInfo(this.nowDate.fullDate,e),this.weeks=this.cale.weeks)},pleStatus:{immediate:!0,handler(e){const{before:t,after:a,fulldate:n,which:i}=e;this.tempRange.before=t,this.tempRange.after=a,setTimeout((()=>{if(n)if(this.cale.setHoverMultiple(n),t&&a){if(this.cale.lastHover=!0,this.rangeWithinMonth(a,t))return;this.setDate(t)}else this.cale.setMultiple(n),this.setDate(this.nowDate.fullDate),this.calendar.fullDate="",this.cale.lastHover=!1;else{if(!this.cale)return;this.cale.setDefaultMultiple(t,a),"left"===i&&t?(this.setDate(t),this.weeks=this.cale.weeks):a&&(this.setDate(a),this.weeks=this.cale.weeks),this.cale.lastHover=!0}}),16)}}},computed:{timepickerStartTime(){return(this.range?this.tempRange.before:this.calendar.fullDate)===this.startDate?this.selectableTimes.start:""},timepickerEndTime(){return(this.range?this.tempRange.after:this.calendar.fullDate)===this.endDate?this.selectableTimes.end:""},selectDateText(){return this.$t("uni-datetime-picker.selectDate")},startDateText(){return this.startPlaceholder||this.$t("uni-datetime-picker.startDate")},endDateText(){return this.endPlaceholder||this.$t("uni-datetime-picker.endDate")},okText(){return this.$t("uni-datetime-picker.ok")},yearText(){return this.$t("uni-datetime-picker.year")},monthText(){return this.$t("uni-datetime-picker.month")},MONText(){return this.$t("uni-calender.MON")},TUEText(){return this.$t("uni-calender.TUE")},WEDText(){return this.$t("uni-calender.WED")},THUText(){return this.$t("uni-calender.THU")},FRIText(){return this.$t("uni-calender.FRI")},SATText(){return this.$t("uni-calender.SAT")},SUNText(){return this.$t("uni-calender.SUN")},confirmText(){return this.$t("uni-calender.confirm")},pickerMonths(){return[this.$t("uni-calender.jan"),this.$t("uni-calender.feb"),this.$t("uni-calender.mar"),this.$t("uni-calender.apr"),this.$t("uni-calender.may"),this.$t("uni-calender.jun"),this.$t("uni-calender.jul"),this.$t("uni-calender.aug"),this.$t("uni-calender.sep"),this.$t("uni-calender.oct"),this.$t("uni-calender.nov"),this.$t("uni-calender.dec")]},pickerRange(){return[this.pickerYears,this.pickerMonths]},pickerIndex(){if(!this.nowDate||!this.nowDate.year)return[0,0];const e=String(this.nowDate.year),t=this.pickerYears.indexOf(e),a=parseInt(this.nowDate.month)-1;return[t>=0?t:0,a>=0?a:0]}},created(){this.cale=new class{constructor({selected:e,startDate:t,endDate:a,range:n}={}){this.date=this.getDateObj(new Date),this.selected=e||[],this.startDate=t,this.endDate=a,this.range=n,this.cleanMultipleStatus(),this.weeks={},this.lastHover=!1}setDate(e){const t=this.getDateObj(e);this.getWeeks(t.fullDate)}cleanMultipleStatus(){this.multipleStatus={before:"",after:"",data:[]}}setStartDate(e){this.startDate=e}setEndDate(e){this.endDate=e}getPreMonthObj(e){e=w(e);const t=(e=new Date(e)).getMonth();e.setMonth(t-1);const a=e.getMonth();return 0!==t&&a-t==0&&e.setMonth(a-1),this.getDateObj(e)}getNextMonthObj(e){e=w(e);const t=(e=new Date(e)).getMonth();e.setMonth(t+1);const a=e.getMonth();return a-t>1&&e.setMonth(a-1),this.getDateObj(e)}getDateObj(e){return e=w(e),{fullDate:g(e=new Date(e)),year:e.getFullYear(),month:v(e.getMonth()+1),date:v(e.getDate()),day:e.getDay()}}getPreMonthDays(e,t){const a=[];for(let n=e-1;n>=0;n--){const e=t.month-1;a.push({date:new Date(t.year,e,-n).getDate(),month:e,disable:!0})}return a}getCurrentMonthDays(e,t){const a=[],n=this.date.fullDate;for(let i=1;i<=e;i++){const e=`${t.year}-${t.month}-${v(i)}`,o=n===e,s=this.selected&&this.selected.find((t=>{if(this.dateEqual(e,t.date))return t}));this.startDate&&y(this.startDate,e),this.endDate&&y(e,this.endDate);let l=this.multipleStatus.data,r=-1;this.range&&l&&(r=l.findIndex((t=>this.dateEqual(t,e))));const c=-1!==r;a.push({fullDate:e,year:t.year,date:i,multiple:!!this.range&&c,beforeMultiple:this.isLogicBefore(e,this.multipleStatus.before,this.multipleStatus.after),afterMultiple:this.isLogicAfter(e,this.multipleStatus.before,this.multipleStatus.after),month:t.month,disable:this.startDate&&!y(this.startDate,e)||this.endDate&&!y(e,this.endDate),isToday:o,userChecked:!1,extraInfo:s})}return a}_getNextMonthDays(e,t){const a=[],n=t.month+1;for(let i=1;i<=e;i++)a.push({date:i,month:n,disable:!0});return a}getInfo(e){return e||(e=new Date),this.calendar.find((t=>t.fullDate===this.getDateObj(e).fullDate))}dateEqual(e,t){return e=new Date(w(e)),t=new Date(w(t)),e.valueOf()===t.valueOf()}isLogicBefore(e,t,a){let n=t;return t&&a&&(n=y(t,a)?t:a),this.dateEqual(n,e)}isLogicAfter(e,t,a){let n=a;return t&&a&&(n=y(t,a)?a:t),this.dateEqual(n,e)}geDateAll(e,t){var a=[],n=e.split("-"),i=t.split("-"),o=new Date;o.setFullYear(n[0],n[1]-1,n[2]);var s=new Date;s.setFullYear(i[0],i[1]-1,i[2]);for(var l=o.getTime()-864e5,r=s.getTime()-864e5,c=l;c<=r;)c+=864e5,a.push(this.getDateObj(new Date(parseInt(c))).fullDate);return a}setMultiple(e){if(!this.range)return;let{before:t,after:a}=this.multipleStatus;if(t&&a){if(!this.lastHover)return void(this.lastHover=!0);this.multipleStatus.before=e,this.multipleStatus.after="",this.multipleStatus.data=[],this.multipleStatus.fulldate="",this.lastHover=!1}else t?(this.multipleStatus.after=e,y(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before),this.lastHover=!0):(this.multipleStatus.before=e,this.lastHover=!1);this.getWeeks(e)}setHoverMultiple(e){if(!this.range||this.lastHover)return;const{before:t}=this.multipleStatus;t?(this.multipleStatus.after=e,y(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before)):this.multipleStatus.before=e,this.getWeeks(e)}setDefaultMultiple(e,t){this.multipleStatus.before=e,this.multipleStatus.after=t,e&&t&&(y(e,t)?(this.multipleStatus.data=this.geDateAll(e,t),this.getWeeks(t)):(this.multipleStatus.data=this.geDateAll(t,e),this.getWeeks(e)))}getWeeks(e){const{year:t,month:a}=this.getDateObj(e),n=new Date(t,a-1,1).getDay(),i=this.getPreMonthDays(n,this.getDateObj(e)),o=new Date(t,a,0).getDate(),s=42-n-o,l=[...i,...this.getCurrentMonthDays(o,this.getDateObj(e)),...this._getNextMonthDays(s,this.getDateObj(e))],r=new Array(6);for(let c=0;c<l.length;c++){const e=Math.floor(c/7);r[e]||(r[e]=new Array(7)),r[e][c%7]=l[c]}this.calendar=l,this.weeks=r}}({selected:this.selected,startDate:this.startDate,endDate:this.endDate,range:this.range});const e=(new Date).getFullYear();for(let t=1900;t<=e+100;t++)this.pickerYears.push(String(t));this.init(this.date)},methods:{bindMultiPickerChange(e){const[t,a]=e.detail.value,n=a+1,i=`${this.pickerYears[t]}-${n<10?"0"+n:n}-01`;this.setDate(i),this.monthSwitch()},leaveCale(){this.firstEnter=!0},handleMouse(e){if(e.disable)return;if(this.cale.lastHover)return;let{before:t,after:a}=this.cale.multipleStatus;t&&(this.calendar=e,this.cale.setHoverMultiple(this.calendar.fullDate),this.weeks=this.cale.weeks,this.firstEnter&&(this.$emit("firstEnterCale",this.cale.multipleStatus),this.firstEnter=!1))},rangeWithinMonth(e,t){const[a,n]=e.split("-"),[i,o]=t.split("-");return a===i&&n===o},maskClick(){this.close(),this.$emit("maskClose")},clearCalender(){this.range?(this.timeRange.startTime="",this.timeRange.endTime="",this.tempRange.before="",this.tempRange.after="",this.cale.multipleStatus.before="",this.cale.multipleStatus.after="",this.cale.multipleStatus.data=[],this.cale.lastHover=!1):(this.time="",this.tempSingleDate=""),this.calendar.fullDate="",this.setDate(new Date)},bindDateChange(e){const t=e.detail.value+"-1";this.setDate(t)},init(e){if(this.cale&&(this.cale.setDate(e||new Date),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(e),this.calendar={...this.nowDate},!e&&(this.calendar.fullDate="",this.defaultValue&&!this.range))){const e=new Date(this.defaultValue),t=g(e),a=e.getFullYear(),n=e.getMonth()+1,i=e.getDate(),o=e.getDay();this.calendar={fullDate:t,year:a,month:n,date:i,day:o},this.tempSingleDate=t,this.time=f(e,this.hideSecond)}},open(){this.clearDate&&!this.insert&&this.cale.cleanMultipleStatus(),this.init(this.date),!this.range&&this.date&&(this.tempSingleDate=this.date),this.range?this.defTime&&this.defTime.start&&(this.timeRange.startTime=this.defTime.start,this.timeRange.endTime=this.defTime.end):this.defTime&&(this.time=this.defTime),this.show=!0,this.$nextTick((()=>{setTimeout((()=>{this.aniMaskShow=!0}),50)}))},close(){this.aniMaskShow=!1,this.$nextTick((()=>{setTimeout((()=>{this.show=!1,this.$emit("close")}),300)}))},confirm(){this.setEmit("confirm"),this.close()},change(){this.insert&&this.setEmit("change")},monthSwitch(){let{year:e,month:t}=this.nowDate;this.$emit("monthSwitch",{year:e,month:Number(t)})},setEmit(e){this.range||(this.calendar.fullDate||(this.calendar=this.cale.getInfo(new Date),this.tempSingleDate=this.calendar.fullDate),this.hasTime&&!this.time&&(this.time=f(new Date,this.hideSecond)));let{year:t,month:a,date:n,fullDate:i,extraInfo:o}=this.calendar;this.$emit(e,{range:this.cale.multipleStatus,year:t,month:a,date:n,time:this.time,timeRange:this.timeRange,fulldate:i,extraInfo:o||{}})},choiceDate(e){if(e.disable)return;this.calendar=e,this.calendar.userChecked=!0,this.cale.setMultiple(this.calendar.fullDate,!0),this.weeks=this.cale.weeks,this.tempSingleDate=this.calendar.fullDate;const t=new Date(this.cale.multipleStatus.before).getTime(),a=new Date(this.cale.multipleStatus.after).getTime();t>a&&a?(this.tempRange.before=this.cale.multipleStatus.after,this.tempRange.after=this.cale.multipleStatus.before):(this.tempRange.before=this.cale.multipleStatus.before,this.tempRange.after=this.cale.multipleStatus.after),this.change()},changeMonth(e){let t;"pre"===e?t=this.cale.getPreMonthObj(this.nowDate.fullDate).fullDate:"next"===e&&(t=this.cale.getNextMonthObj(this.nowDate.fullDate).fullDate),this.setDate(t),this.monthSwitch()},setDate(e){this.cale.setDate(e),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(e)}}},[["render",function(t,a,i,o,s,l){const r=e.resolveComponent("calendar-item"),c=e.resolveComponent("time-picker"),d=n(e.resolveDynamicComponent("uni-icons"),h);return e.openBlock(),e.createElementBlock("view",{class:"uni-calendar",onMouseleave:a[9]||(a[9]=(...e)=>l.leaveCale&&l.leaveCale(...e))},[!i.insert&&s.show?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-calendar__mask",{"uni-calendar--mask-show":s.aniMaskShow}]),onClick:a[0]||(a[0]=(...e)=>l.maskClick&&l.maskClick(...e))},null,2)):e.createCommentVNode("",!0),i.insert||s.show?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["uni-calendar__content",{"uni-calendar--fixed":!i.insert,"uni-calendar--ani-show":s.aniMaskShow,"uni-calendar__content-mobile":s.aniMaskShow}])},[e.createElementVNode("view",{class:e.normalizeClass(["uni-calendar__header",{"uni-calendar__header-mobile":!i.insert}])},[e.createElementVNode("view",{class:"uni-calendar__header-btn-box",onClick:a[1]||(a[1]=e.withModifiers((e=>l.changeMonth("pre")),["stop"]))},[e.createElementVNode("view",{class:"uni-calendar__header-btn uni-calendar--left"})]),e.createElementVNode("picker",{mode:"multiSelector",range:l.pickerRange,value:l.pickerIndex,onChange:a[2]||(a[2]=(...e)=>l.bindMultiPickerChange&&l.bindMultiPickerChange(...e))},[e.createElementVNode("text",{class:"uni-calendar__header-text"},e.toDisplayString(l.monthText+" "+(s.nowDate.month||"")+" "+l.yearText+" "+(s.nowDate.year||"")),1)],40,["range","value"]),e.createElementVNode("view",{class:"uni-calendar__header-btn-box",onClick:a[3]||(a[3]=e.withModifiers((e=>l.changeMonth("next")),["stop"]))},[e.createElementVNode("view",{class:"uni-calendar__header-btn uni-calendar--right"})]),i.insert?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"dialog-close",onClick:a[4]||(a[4]=(...e)=>l.close&&l.close(...e))},[e.createElementVNode("view",{class:"dialog-close-plus","data-id":"close"}),e.createElementVNode("view",{class:"dialog-close-plus dialog-close-rotate","data-id":"close"})]))],2),e.createElementVNode("view",{class:"uni-calendar__box"},[i.showMonth?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-calendar__box-bg"},[e.createElementVNode("text",{class:"uni-calendar__box-bg-text"},e.toDisplayString(s.nowDate.month),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"uni-calendar__weeks",style:{"padding-bottom":"7px"}},[e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(l.SUNText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(l.MONText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(l.TUEText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(l.WEDText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(l.THUText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(l.FRIText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(l.SATText),1)])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.weeks,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-calendar__weeks",key:a},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-calendar__weeks-item",key:a},[e.createVNode(r,{class:"uni-calendar-item--hook",weeks:t,calendar:s.calendar,selected:i.selected,checkHover:i.range,onChange:l.choiceDate,onHandleMouse:l.handleMouse},null,8,["weeks","calendar","selected","checkHover","onChange","onHandleMouse"])])))),128))])))),128))]),i.insert||i.range||!i.hasTime?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-changed uni-calendar--fixed-top",style:{padding:"0 80px"}},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(s.tempSingleDate?s.tempSingleDate:l.selectDateText),1),e.createVNode(c,{type:"time",start:l.timepickerStartTime,end:l.timepickerEndTime,modelValue:s.time,"onUpdate:modelValue":a[5]||(a[5]=e=>s.time=e),disabled:!s.tempSingleDate,border:!1,"hide-second":i.hideSecond,class:"time-picker-style"},null,8,["start","end","modelValue","disabled","hide-second"])])),!i.insert&&i.range&&i.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-changed uni-calendar--fixed-top"},[e.createElementVNode("view",{class:"uni-date-changed--time-start"},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(s.tempRange.before?s.tempRange.before:l.startDateText),1),e.createVNode(c,{type:"time",start:l.timepickerStartTime,modelValue:s.timeRange.startTime,"onUpdate:modelValue":a[6]||(a[6]=e=>s.timeRange.startTime=e),border:!1,"hide-second":i.hideSecond,disabled:!s.tempRange.before,class:"time-picker-style"},null,8,["start","modelValue","hide-second","disabled"])]),e.createElementVNode("view",{style:{"line-height":"50px"}},[e.createVNode(d,{type:"arrowthinright",color:"#999"})]),e.createElementVNode("view",{class:"uni-date-changed--time-end"},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(s.tempRange.after?s.tempRange.after:l.endDateText),1),e.createVNode(c,{type:"time",end:l.timepickerEndTime,modelValue:s.timeRange.endTime,"onUpdate:modelValue":a[7]||(a[7]=e=>s.timeRange.endTime=e),border:!1,"hide-second":i.hideSecond,disabled:!s.tempRange.after,class:"time-picker-style"},null,8,["end","modelValue","hide-second","disabled"])])])):e.createCommentVNode("",!0),i.insert?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"uni-date-changed uni-date-btn--ok"},[e.createElementVNode("view",{class:"uni-datetime-picker--btn",onClick:a[8]||(a[8]=(...e)=>l.confirm&&l.confirm(...e))},e.toDisplayString(l.confirmText),1)]))],2)):e.createCommentVNode("",!0)],32)}],["__scopeId","data-v-7e6aa669"]]),TimePicker:S},data:()=>({isRange:!1,hasTime:!1,displayValue:"",inputDate:"",calendarDate:"",pickerTime:"",calendarRange:{startDate:"",startTime:"",endDate:"",endTime:""},displayRangeValue:{startDate:"",endDate:""},tempRange:{startDate:"",startTime:"",endDate:"",endTime:""},startMultipleStatus:{before:"",after:"",data:[],fulldate:""},endMultipleStatus:{before:"",after:"",data:[],fulldate:""},pickerVisible:!1,pickerPositionStyle:null,isEmitValue:!1,isPhone:!1,isFirstShow:!0}),props:{type:{type:String,default:"datetime"},value:{type:[String,Number,Array,Date],default:""},modelValue:{type:[String,Number,Array,Date],default:""},start:{type:[Number,String],default:""},end:{type:[Number,String],default:""},returnType:{type:String,default:"string"},placeholder:{type:String,default:""},startPlaceholder:{type:String,default:""},endPlaceholder:{type:String,default:""},rangeSeparator:{type:String,default:"-"},border:{type:[Boolean],default:!0},disabled:{type:[Boolean],default:!1},clearIcon:{type:[Boolean],default:!0},hideSecond:{type:[Boolean],default:!1},defaultValue:{type:[String,Object,Array],default:""}},watch:{type:{immediate:!0,handler(e){this.hasTime=-1!==e.indexOf("time"),this.isRange=-1!==e.indexOf("range")}},value:{handler(e){this.isEmitValue?this.isEmitValue=!1:this.initPicker(e)},immediate:!0},modelValue:{immediate:!0,handler(e){this.isEmitValue?this.isEmitValue=!1:this.initPicker(e)}},start:{immediate:!0,handler(e){e&&(this.calendarRange.startDate=g(e),this.hasTime&&(this.calendarRange.startTime=f(e)))}},end:{immediate:!0,handler(e){e&&(this.calendarRange.endDate=g(e),this.hasTime&&(this.calendarRange.endTime=f(e,this.hideSecond)))}}},computed:{timepickerStartTime(){return(this.isRange?this.tempRange.startDate:this.inputDate)===this.calendarRange.startDate?this.calendarRange.startTime:""},timepickerEndTime(){return(this.isRange?this.tempRange.endDate:this.inputDate)===this.calendarRange.endDate?this.calendarRange.endTime:""},mobileCalendarTime(){const e={start:this.tempRange.startTime,end:this.tempRange.endTime};return this.isRange?e:this.pickerTime},mobSelectableTime(){return{start:this.calendarRange.startTime,end:this.calendarRange.endTime}},datePopupWidth(){return this.isRange?653:301},singlePlaceholderText(){return this.placeholder||("date"===this.type?this.selectDateText:this.selectDateTimeText)},startPlaceholderText(){return this.startPlaceholder||this.startDateText},endPlaceholderText(){return this.endPlaceholder||this.endDateText},selectDateText(){return this.$t("uni-datetime-picker.selectDate")},selectDateTimeText(){return this.$t("uni-datetime-picker.selectDateTime")},selectTimeText(){return this.$t("uni-datetime-picker.selectTime")},startDateText(){return this.startPlaceholder||this.$t("uni-datetime-picker.startDate")},startTimeText(){return this.$t("uni-datetime-picker.startTime")},endDateText(){return this.endPlaceholder||this.$t("uni-datetime-picker.endDate")},endTimeText(){return this.$t("uni-datetime-picker.endTime")},okText(){return this.$t("uni-datetime-picker.ok")},clearText(){return this.$t("uni-datetime-picker.clear")},showClearIcon(){return this.clearIcon&&!this.disabled&&(this.displayValue||this.displayRangeValue.startDate&&this.displayRangeValue.endDate)}},created(){this.platform()},methods:{initPicker(e){if(!e&&!this.defaultValue||Array.isArray(e)&&!e.length)this.$nextTick((()=>{this.clear(!1)}));else if(Array.isArray(e)||this.isRange){const[t,a]=e;if(!t&&!a)return;const n=g(t),i=f(t,this.hideSecond),o=g(a),s=f(a,this.hideSecond),l=n,r=o;this.displayRangeValue.startDate=this.tempRange.startDate=l,this.displayRangeValue.endDate=this.tempRange.endDate=r,this.hasTime&&(this.displayRangeValue.startDate=`${n} ${i}`,this.displayRangeValue.endDate=`${o} ${s}`,this.tempRange.startTime=i,this.tempRange.endTime=s);const c={before:n,after:o};this.startMultipleStatus=Object.assign({},this.startMultipleStatus,c,{which:"right"}),this.endMultipleStatus=Object.assign({},this.endMultipleStatus,c,{which:"left"})}else e?(this.displayValue=this.inputDate=this.calendarDate=g(e),this.hasTime&&(this.pickerTime=f(e,this.hideSecond),this.displayValue=`${this.displayValue} ${this.pickerTime}`)):this.defaultValue&&(this.inputDate=this.calendarDate=g(this.defaultValue),this.hasTime&&(this.pickerTime=f(this.defaultValue,this.hideSecond)))},updateLeftCale(e){const t=this.$refs.left;t.cale.setHoverMultiple(e.after),t.setDate(this.$refs.left.nowDate.fullDate)},updateRightCale(e){const t=this.$refs.right;t.cale.setHoverMultiple(e.after),t.setDate(this.$refs.right.nowDate.fullDate)},platform(){if("undefined"!=typeof navigator)return void(this.isPhone=-1!==navigator.userAgent.toLowerCase().indexOf("mobile"));const{windowWidth:e}=uni.getSystemInfoSync();this.isPhone=e<=500,this.windowWidth=e},show(){if(this.disabled)return;if(this.platform(),this.isPhone)return void setTimeout((()=>{this.$refs.mobile.open()}),0);this.pickerPositionStyle={top:"10px"};uni.createSelectorQuery().in(this).select(".uni-date-editor").boundingClientRect((e=>{this.windowWidth-e.left<this.datePopupWidth&&(this.pickerPositionStyle.right=0)})).exec(),setTimeout((()=>{if(this.pickerVisible=!this.pickerVisible,this.pickerVisible&&(!this.isRange&&this.$refs.pcSingle?this.$refs.pcSingle.init(this.calendarDate):this.isRange&&this.$refs.left&&this.$refs.right&&(this.$refs.left.init(this.calendarRange.startDate),this.$refs.right.init(this.calendarRange.endDate))),!this.isPhone&&this.isRange&&this.isFirstShow){this.isFirstShow=!1;const{startDate:e,endDate:t}=this.calendarRange;e&&t?this.diffDate(e,t)<30&&this.$refs.right.changeMonth("pre"):(this.$refs.right.changeMonth("next"),this.isPhone&&(this.$refs.right.cale.lastHover=!1))}}),50)},close(){setTimeout((()=>{this.pickerVisible=!1,this.$emit("maskClick",this.value),this.$refs.mobile&&this.$refs.mobile.close()}),20)},setEmit(e){"timestamp"!==this.returnType&&"date"!==this.returnType||(Array.isArray(e)?(this.hasTime||(e[0]=e[0]+" 00:00:00",e[1]=e[1]+" 00:00:00"),e[0]=this.createTimestamp(e[0]),e[1]=this.createTimestamp(e[1]),"date"===this.returnType&&(e[0]=new Date(e[0]),e[1]=new Date(e[1]))):(this.hasTime||(e+=" 00:00:00"),e=this.createTimestamp(e),"date"===this.returnType&&(e=new Date(e)))),this.$emit("update:modelValue",e),this.$emit("input",e),this.$emit("change",e),this.isEmitValue=!0},createTimestamp:e=>(e=w(e),Date.parse(new Date(e))),singleChange(e){this.calendarDate=this.inputDate=e.fulldate,this.hasTime||this.confirmSingleChange()},confirmSingleChange(){if(!k(this.inputDate)){const e=new Date;this.calendarDate=this.inputDate=g(e),this.pickerTime=f(e,this.hideSecond)}let e,t,a=!1;if(this.start){let n=this.start;"number"==typeof this.start&&(n=p(this.start,this.hideSecond)),[e,t]=n.split(" "),this.start&&!y(e,this.inputDate)&&(a=!0,this.inputDate=e)}let n,i,o=!1;if(this.end){let e=this.end;"number"==typeof this.end&&(e=p(this.end,this.hideSecond)),[n,i]=e.split(" "),this.end&&!y(this.inputDate,n)&&(o=!0,this.inputDate=n)}this.hasTime?(a&&(this.pickerTime=t||_(this.hideSecond)),o&&(this.pickerTime=i||_(this.hideSecond)),this.pickerTime||(this.pickerTime=f(Date.now(),this.hideSecond)),this.displayValue=`${this.inputDate} ${this.pickerTime}`):this.displayValue=this.inputDate,this.setEmit(this.displayValue),this.pickerVisible=!1},leftChange(e){const{before:t,after:a}=e.range;this.rangeChange(t,a);const n={before:e.range.before,after:e.range.after,data:e.range.data,fulldate:e.fulldate};this.startMultipleStatus=Object.assign({},this.startMultipleStatus,n)},rightChange(e){const{before:t,after:a}=e.range;this.rangeChange(t,a);const n={before:e.range.before,after:e.range.after,data:e.range.data,fulldate:e.fulldate};this.endMultipleStatus=Object.assign({},this.endMultipleStatus,n)},mobileChange(e){if(this.isRange){const{before:t,after:a}=e.range;if(!t||!a)return;if(this.handleStartAndEnd(t,a,!0),this.hasTime){const{startTime:t,endTime:a}=e.timeRange;this.tempRange.startTime=t,this.tempRange.endTime=a}this.confirmRangeChange()}else this.calendarDate=e.fulldate,this.hasTime?(this.pickerTime=e.time,this.displayValue=e.fulldate+" "+e.time):this.displayValue=e.fulldate,this.setEmit(this.displayValue);this.$refs.mobile.close()},rangeChange(e,t){e&&t&&(this.handleStartAndEnd(e,t,!0),this.hasTime||this.confirmRangeChange())},confirmRangeChange(){if(!this.tempRange.startDate||!this.tempRange.endDate)return void(this.pickerVisible=!1);let e,t;k(this.tempRange.startDate)||(this.tempRange.startDate=g(Date.now())),k(this.tempRange.endDate)||(this.tempRange.endDate=g(Date.now()));let a,n,i=!1,o=!1;if(this.start){let e=this.start;"number"==typeof this.start&&(e=p(this.start,this.hideSecond)),[a,n]=e.split(" "),this.start&&!y(this.start,this.tempRange.startDate)&&(i=!0,this.tempRange.startDate=a),this.start&&!y(this.start,this.tempRange.endDate)&&(o=!0,this.tempRange.endDate=a)}let s,l,r=!1,c=!1;if(this.end){let e=this.end;"number"==typeof this.end&&(e=p(this.end,this.hideSecond)),[s,l]=e.split(" "),this.end&&!y(this.tempRange.startDate,this.end)&&(r=!0,this.tempRange.startDate=s),this.end&&!y(this.tempRange.endDate,this.end)&&(c=!0,this.tempRange.endDate=s)}this.hasTime?(i?this.tempRange.startTime=n||_(this.hideSecond):r&&(this.tempRange.startTime=l||_(this.hideSecond)),this.tempRange.startTime||(this.tempRange.startTime=f(Date.now(),this.hideSecond)),o?this.tempRange.endTime=n||_(this.hideSecond):c&&(this.tempRange.endTime=l||_(this.hideSecond)),this.tempRange.endTime||(this.tempRange.endTime=f(Date.now(),this.hideSecond)),e=this.displayRangeValue.startDate=`${this.tempRange.startDate} ${this.tempRange.startTime}`,t=this.displayRangeValue.endDate=`${this.tempRange.endDate} ${this.tempRange.endTime}`):(e=this.displayRangeValue.startDate=this.tempRange.startDate,t=this.displayRangeValue.endDate=this.tempRange.endDate),y(e,t)||([e,t]=[t,e]),this.displayRangeValue.startDate=e,this.displayRangeValue.endDate=t;const d=[e,t];this.setEmit(d),this.pickerVisible=!1},handleStartAndEnd(e,t,a=!1){if(!e||!t)return;const n=a?"tempRange":"range",i=y(e,t);this[n].startDate=i?e:t,this[n].endDate=i?t:e},dateCompare:(e,t)=>(e=new Date(e.replace("-","/").replace("-","/")))<=(t=new Date(t.replace("-","/").replace("-","/"))),diffDate(e,t){e=new Date(e.replace("-","/").replace("-","/"));const a=((t=new Date(t.replace("-","/").replace("-","/")))-e)/864e5;return Math.abs(a)},clear(e=!0){this.isRange?(this.displayRangeValue.startDate="",this.displayRangeValue.endDate="",this.tempRange.startDate="",this.tempRange.startTime="",this.tempRange.endDate="",this.tempRange.endTime="",this.isPhone?this.$refs.mobile&&this.$refs.mobile.clearCalender():(this.$refs.left&&this.$refs.left.clearCalender(),this.$refs.right&&this.$refs.right.clearCalender(),this.$refs.right&&this.$refs.right.changeMonth("next")),e&&(this.$emit("change",[]),this.$emit("input",[]),this.$emit("update:modelValue",[]))):(this.displayValue="",this.inputDate="",this.pickerTime="",this.isPhone?this.$refs.mobile&&this.$refs.mobile.clearCalender():this.$refs.pcSingle&&this.$refs.pcSingle.clearCalender(),e&&(this.$emit("change",""),this.$emit("input",""),this.$emit("update:modelValue","")))}}},[["render",function(t,a,i,o,s,l){const r=n(e.resolveDynamicComponent("uni-icons"),h),c=e.resolveComponent("time-picker"),d=e.resolveComponent("Calendar");return e.openBlock(),e.createElementBlock("view",{class:"uni-date"},[e.createElementVNode("view",{class:"uni-date-editor",onClick:a[1]||(a[1]=(...e)=>l.show&&l.show(...e))},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-date-editor--x",{"uni-date-editor--x__disabled":i.disabled,"uni-date-x--border":i.border}])},[s.isRange?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-x uni-date-range"},[e.createVNode(r,{class:"icon-calendar",type:"calendar",color:"#c0c4cc",size:"22"}),e.createElementVNode("view",{class:"uni-date__x-input text-center"},e.toDisplayString(s.displayRangeValue.startDate||l.startPlaceholderText),1),e.createElementVNode("view",{class:"range-separator"},e.toDisplayString(i.rangeSeparator),1),e.createElementVNode("view",{class:"uni-date__x-input text-center"},e.toDisplayString(s.displayRangeValue.endDate||l.endPlaceholderText),1)])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-x uni-date-single"},[e.createVNode(r,{class:"icon-calendar",type:"calendar",color:"#c0c4cc",size:"22"}),e.createElementVNode("view",{class:"uni-date__x-input"},e.toDisplayString(s.displayValue||l.singlePlaceholderText),1)])),l.showClearIcon?(e.openBlock(),e.createElementBlock("view",{key:2,class:"uni-date__icon-clear",onClick:a[0]||(a[0]=e.withModifiers(((...e)=>l.clear&&l.clear(...e)),["stop"]))},[e.createVNode(r,{type:"clear",color:"#c0c4cc",size:"22"})])):e.createCommentVNode("",!0)],2)]),!0)]),e.withDirectives(e.createElementVNode("view",{class:"uni-date-mask--pc",onClick:a[2]||(a[2]=(...e)=>l.close&&l.close(...e))},null,512),[[e.vShow,s.pickerVisible]]),s.isPhone?e.createCommentVNode("",!0):e.withDirectives((e.openBlock(),e.createElementBlock("view",{key:0,ref:"datePicker",class:"uni-date-picker__container"},[s.isRange?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-range--x",style:e.normalizeStyle(s.pickerPositionStyle)},[e.createElementVNode("view",{class:"uni-popper__arrow"}),s.hasTime?(e.openBlock(),e.createElementBlock("view",{key:0,class:"popup-x-header uni-date-changed"},[e.createElementVNode("view",{class:"popup-x-header--datetime"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":a[7]||(a[7]=e=>s.tempRange.startDate=e),placeholder:l.startDateText},null,8,["placeholder"]),[[e.vModelText,s.tempRange.startDate]]),e.createVNode(c,{type:"time",modelValue:s.tempRange.startTime,"onUpdate:modelValue":a[9]||(a[9]=e=>s.tempRange.startTime=e),start:l.timepickerStartTime,border:!1,disabled:!s.tempRange.startDate,hideSecond:i.hideSecond},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":a[8]||(a[8]=e=>s.tempRange.startTime=e),placeholder:l.startTimeText,disabled:!s.tempRange.startDate},null,8,["placeholder","disabled"]),[[e.vModelText,s.tempRange.startTime]])])),_:1},8,["modelValue","start","disabled","hideSecond"])]),e.createVNode(r,{type:"arrowthinright",color:"#999",style:{"line-height":"40px"}}),e.createElementVNode("view",{class:"popup-x-header--datetime"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":a[10]||(a[10]=e=>s.tempRange.endDate=e),placeholder:l.endDateText},null,8,["placeholder"]),[[e.vModelText,s.tempRange.endDate]]),e.createVNode(c,{type:"time",modelValue:s.tempRange.endTime,"onUpdate:modelValue":a[12]||(a[12]=e=>s.tempRange.endTime=e),end:l.timepickerEndTime,border:!1,disabled:!s.tempRange.endDate,hideSecond:i.hideSecond},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":a[11]||(a[11]=e=>s.tempRange.endTime=e),placeholder:l.endTimeText,disabled:!s.tempRange.endDate},null,8,["placeholder","disabled"]),[[e.vModelText,s.tempRange.endTime]])])),_:1},8,["modelValue","end","disabled","hideSecond"])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"popup-x-body"},[e.createVNode(d,{ref:"left",showMonth:!1,"start-date":s.calendarRange.startDate,"end-date":s.calendarRange.endDate,range:!0,pleStatus:s.endMultipleStatus,onChange:l.leftChange,onFirstEnterCale:l.updateRightCale,style:{padding:"0 8px"}},null,8,["start-date","end-date","pleStatus","onChange","onFirstEnterCale"]),e.createVNode(d,{ref:"right",showMonth:!1,"start-date":s.calendarRange.startDate,"end-date":s.calendarRange.endDate,range:!0,onChange:l.rightChange,pleStatus:s.startMultipleStatus,onFirstEnterCale:l.updateLeftCale,style:{padding:"0 8px","border-left":"1px solid #F1F1F1"}},null,8,["start-date","end-date","onChange","pleStatus","onFirstEnterCale"])]),s.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"popup-x-footer"},[e.createElementVNode("text",{onClick:a[13]||(a[13]=(...e)=>l.clear&&l.clear(...e))},e.toDisplayString(l.clearText),1),e.createElementVNode("text",{class:"confirm-text",onClick:a[14]||(a[14]=(...e)=>l.confirmRangeChange&&l.confirmRangeChange(...e))},e.toDisplayString(l.okText),1)])):e.createCommentVNode("",!0)],4)):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-single--x",style:e.normalizeStyle(s.pickerPositionStyle)},[e.createElementVNode("view",{class:"uni-popper__arrow"}),s.hasTime?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-changed popup-x-header"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input text-center",type:"text","onUpdate:modelValue":a[3]||(a[3]=e=>s.inputDate=e),placeholder:l.selectDateText},null,8,["placeholder"]),[[e.vModelText,s.inputDate]]),e.createVNode(c,{type:"time",modelValue:s.pickerTime,"onUpdate:modelValue":a[5]||(a[5]=e=>s.pickerTime=e),border:!1,disabled:!s.inputDate,start:l.timepickerStartTime,end:l.timepickerEndTime,hideSecond:i.hideSecond,style:{width:"100%"}},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input text-center",type:"text","onUpdate:modelValue":a[4]||(a[4]=e=>s.pickerTime=e),placeholder:l.selectTimeText,disabled:!s.inputDate},null,8,["placeholder","disabled"]),[[e.vModelText,s.pickerTime]])])),_:1},8,["modelValue","disabled","start","end","hideSecond"])])):e.createCommentVNode("",!0),e.createVNode(d,{ref:"pcSingle",showMonth:!1,"start-date":s.calendarRange.startDate,"end-date":s.calendarRange.endDate,date:s.calendarDate,onChange:l.singleChange,"default-value":i.defaultValue,style:{padding:"0 8px"}},null,8,["start-date","end-date","date","onChange","default-value"]),s.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"popup-x-footer"},[e.createElementVNode("text",{class:"confirm-text",onClick:a[6]||(a[6]=(...e)=>l.confirmSingleChange&&l.confirmSingleChange(...e))},e.toDisplayString(l.okText),1)])):e.createCommentVNode("",!0)],4))],512)),[[e.vShow,s.pickerVisible]]),s.isPhone?(e.openBlock(),e.createBlock(d,{key:1,ref:"mobile",clearDate:!1,date:s.calendarDate,defTime:l.mobileCalendarTime,"start-date":s.calendarRange.startDate,"end-date":s.calendarRange.endDate,selectableTimes:l.mobSelectableTime,startPlaceholder:i.startPlaceholder,endPlaceholder:i.endPlaceholder,"default-value":i.defaultValue,pleStatus:s.endMultipleStatus,showMonth:!1,range:s.isRange,hasTime:s.hasTime,insert:!1,hideSecond:i.hideSecond,onConfirm:l.mobileChange,onMaskClose:l.close},null,8,["date","defTime","start-date","end-date","selectableTimes","startPlaceholder","endPlaceholder","default-value","pleStatus","range","hasTime","hideSecond","onConfirm","onMaskClose"])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-7f0bbf73"]]),N=e=>{if(!e)return"";const t=Date.now()-e;if(t<6e4)return"Vừa xong";if(t<36e5){return`${Math.floor(t/6e4)} phút trước`}if(t<864e5){return`${Math.floor(t/36e5)} giờ trước`}const a=new Date(e);return`${a.getDate().toString().padStart(2,"0")}/${(a.getMonth()+1).toString().padStart(2,"0")}/${a.getFullYear()} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`},T=e=>{if(!e)return"";try{if(e.includes("-")){const t=e.split("-");if(3===t.length){const[e,a,n]=t;return`${n}/${a}/${e}`}}return e}catch(t){return e}},E=e=>{if(!e)return null;const t=e.replace(/-/g,"/"),a=new Date(t);return isNaN(a.getTime())?null:a},x=e=>{const t=E(e);return t?(t.setHours(0,0,0,0),t.getTime()):-1},V=(e,t)=>{if(!e&&!t)return"";const a=x(e),n=(e=>{const t=E(e);return t?(t.setDate(t.getDate()+1),t.setHours(0,0,0,0),t.getTime()):-1})(t);if(-1===a&&-1===n)return"";return`${-1===a?"":a}|${-1===n?"":n}`},$=e=>{if(!e)return 0;const t=new Date(e.replace(/-/g,"/"));return isNaN(t.getTime())?0:(t.setSeconds(0),t.setMilliseconds(0),t.getTime())},B=(e,t)=>{const a=$(e),n=$(t);return!a||!n||!(n>=a)},M=e=>{if(!e||e<=0)return"";try{const t=new Date(e),a=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0"),o=t.getHours().toString().padStart(2,"0");return`${a}-${n}-${i} ${o}:${t.getMinutes().toString().padStart(2,"0")}:00`}catch{return""}},I="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,R=e=>I?Symbol(e):e,O=e=>JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),F=e=>"number"==typeof e&&isFinite(e),A=e=>"[object RegExp]"===Q(e),L=e=>X(e)&&0===Object.keys(e).length;function P(e,t){"undefined"!=typeof console&&(console.warn("[intlify] "+e),t&&console.warn(t.stack))}const z=Object.assign;function U(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const j=Object.prototype.hasOwnProperty;function H(e,t){return j.call(e,t)}const W=Array.isArray,q=e=>"function"==typeof e,Y=e=>"string"==typeof e,G=e=>"boolean"==typeof e,K=e=>null!==e&&"object"==typeof e,J=Object.prototype.toString,Q=e=>J.call(e),X=e=>"[object Object]"===Q(e),Z=Object.prototype.hasOwnProperty;function ee(e,t){return Z.call(e,t)}const te=e=>null!==e&&"object"==typeof e,ae=[];ae[0]={w:[0],i:[3,0],"[":[4],o:[7]},ae[1]={w:[1],".":[2],"[":[4],o:[7]},ae[2]={w:[2],i:[3,0],0:[3,0]},ae[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]},ae[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]},ae[5]={"'":[4,0],o:8,l:[5,0]},ae[6]={'"':[4,0],o:8,l:[6,0]};const ne=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function ie(e){if(null==e)return"o";switch(e.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return e;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function oe(e){const t=e.trim();return("0"!==e.charAt(0)||!isNaN(parseInt(e)))&&(a=t,ne.test(a)?function(e){const t=e.charCodeAt(0);return t!==e.charCodeAt(e.length-1)||34!==t&&39!==t?e:e.slice(1,-1)}(t):"*"+t);var a}const se=new Map;function le(e,t){if(!te(e))return null;let a=se.get(t);if(a||(a=function(e){const t=[];let a,n,i,o,s,l,r,c=-1,d=0,u=0;const m=[];function h(){const t=e[c+1];if(5===d&&"'"===t||6===d&&'"'===t)return c++,i="\\"+t,m[0](),!0}for(m[0]=()=>{void 0===n?n=i:n+=i},m[1]=()=>{void 0!==n&&(t.push(n),n=void 0)},m[2]=()=>{m[0](),u++},m[3]=()=>{if(u>0)u--,d=4,m[0]();else{if(u=0,void 0===n)return!1;if(n=oe(n),!1===n)return!1;m[1]()}};null!==d;)if(c++,a=e[c],"\\"!==a||!h()){if(o=ie(a),r=ae[d],s=r[o]||r.l||8,8===s)return;if(d=s[0],void 0!==s[1]&&(l=m[s[1]],l&&(i=a,!1===l())))return;if(7===d)return t}}(t),a&&se.set(t,a)),!a)return null;const n=a.length;let i=e,o=0;for(;o<n;){const e=i[a[o]];if(void 0===e)return null;i=e,o++}return i}function re(e){if(!te(e))return e;for(const t in e)if(ee(e,t))if(t.includes(".")){const a=t.split("."),n=a.length-1;let i=e;for(let e=0;e<n;e++)a[e]in i||(i[a[e]]={}),i=i[a[e]];i[a[n]]=e[t],delete e[t],te(i[a[n]])&&re(i[a[n]])}else te(e[t])&&re(e[t]);return e}
/*!
    * @intlify/runtime v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */const ce=e=>e,de=e=>"",ue=e=>0===e.length?"":e.join(""),me=e=>null==e?"":W(e)||X(e)&&e.toString===J?JSON.stringify(e,null,2):String(e);function he(e,t){return e=Math.abs(e),2===t?e?e>1?1:0:1:e?Math.min(e,2):0}function pe(e={}){const t=e.locale,a=function(e){const t=F(e.pluralIndex)?e.pluralIndex:-1;return e.named&&(F(e.named.count)||F(e.named.n))?F(e.named.count)?e.named.count:F(e.named.n)?e.named.n:t:t}(e),n=K(e.pluralRules)&&Y(t)&&q(e.pluralRules[t])?e.pluralRules[t]:he,i=K(e.pluralRules)&&Y(t)&&q(e.pluralRules[t])?he:void 0,o=e.list||[],s=e.named||{};F(e.pluralIndex)&&function(e,t){t.count||(t.count=e),t.n||(t.n=e)}(a,s);function l(t){const a=q(e.messages)?e.messages(t):!!K(e.messages)&&e.messages[t];return a||(e.parent?e.parent.message(t):de)}const r=X(e.processor)&&q(e.processor.normalize)?e.processor.normalize:ue,c=X(e.processor)&&q(e.processor.interpolate)?e.processor.interpolate:me,d={list:e=>o[e],named:e=>s[e],plural:e=>e[n(a,e.length,i)],linked:(t,a)=>{const n=l(t)(d);return Y(a)?(i=a,e.modifiers?e.modifiers[i]:ce)(n):n;var i},message:l,type:X(e.processor)&&Y(e.processor.type)?e.processor.type:"text",interpolate:c,normalize:r};return d}
/*!
    * @intlify/message-compiler v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */function ge(e,t,a={}){const{domain:n,messages:i,args:o}=a,s=new SyntaxError(String(e));return s.code=e,t&&(s.location=t),s.domain=n,s}
/*!
    * @intlify/core-base v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */let fe=0;function ve(e={}){const t=Y(e.version)?e.version:"9.1.9",a=Y(e.locale)?e.locale:"en-US",n=W(e.fallbackLocale)||X(e.fallbackLocale)||Y(e.fallbackLocale)||!1===e.fallbackLocale?e.fallbackLocale:a,i=X(e.messages)?e.messages:{[a]:{}},o=X(e.datetimeFormats)?e.datetimeFormats:{[a]:{}},s=X(e.numberFormats)?e.numberFormats:{[a]:{}},l=z({},e.modifiers||{},{upper:e=>Y(e)?e.toUpperCase():e,lower:e=>Y(e)?e.toLowerCase():e,capitalize:e=>Y(e)?`${e.charAt(0).toLocaleUpperCase()}${e.substr(1)}`:e}),r=e.pluralRules||{},c=q(e.missing)?e.missing:null,d=!G(e.missingWarn)&&!A(e.missingWarn)||e.missingWarn,u=!G(e.fallbackWarn)&&!A(e.fallbackWarn)||e.fallbackWarn,m=!!e.fallbackFormat,h=!!e.unresolving,p=q(e.postTranslation)?e.postTranslation:null,g=X(e.processor)?e.processor:null,f=!G(e.warnHtmlMessage)||e.warnHtmlMessage,v=!!e.escapeParameter,_=q(e.messageCompiler)?e.messageCompiler:undefined,y=q(e.onWarn)?e.onWarn:P,k=e,b=K(k.__datetimeFormatters)?k.__datetimeFormatters:new Map,w=K(k.__numberFormatters)?k.__numberFormatters:new Map,D=K(k.__meta)?k.__meta:{};fe++;return{version:t,cid:fe,locale:a,fallbackLocale:n,messages:i,datetimeFormats:o,numberFormats:s,modifiers:l,pluralRules:r,missing:c,missingWarn:d,fallbackWarn:u,fallbackFormat:m,unresolving:h,postTranslation:p,processor:g,warnHtmlMessage:f,escapeParameter:v,messageCompiler:_,onWarn:y,__datetimeFormatters:b,__numberFormatters:w,__meta:D}}function _e(e,t,a,n,i){const{missing:o,onWarn:s}=e;if(null!==o){const n=o(e,a,t,i);return Y(n)?n:t}return t}function ye(e,t,a){const n=e;n.__localeChainCache||(n.__localeChainCache=new Map);let i=n.__localeChainCache.get(a);if(!i){i=[];let e=[a];for(;W(e);)e=ke(i,e,t);const o=W(t)?t:X(t)?t.default?t.default:null:t;e=Y(o)?[o]:o,W(e)&&ke(i,e,!1),n.__localeChainCache.set(a,i)}return i}function ke(e,t,a){let n=!0;for(let i=0;i<t.length&&G(n);i++){const o=t[i];Y(o)&&(n=be(e,t[i],a))}return n}function be(e,t,a){let n;const i=t.split("-");do{n=we(e,i.join("-"),a),i.splice(-1,1)}while(i.length&&!0===n);return n}function we(e,t,a){let n=!1;if(!e.includes(t)&&(n=!0,t)){n="!"!==t[t.length-1];const i=t.replace(/!/g,"");e.push(i),(W(a)||X(a))&&a[i]&&(n=a[i])}return n}function De(e,t,a){e.__localeChainCache=new Map,ye(e,a,t)}function Se(e){return ge(e,null,void 0)}const Ce=()=>"",Ne=e=>q(e);function Te(e,...t){const{fallbackFormat:a,postTranslation:n,unresolving:i,fallbackLocale:o,messages:s}=e,[l,r]=xe(...t),c=(G(r.missingWarn)?r.missingWarn:e.missingWarn,G(r.fallbackWarn)?r.fallbackWarn:e.fallbackWarn,G(r.escapeParameter)?r.escapeParameter:e.escapeParameter),d=!!r.resolvedMessage,u=Y(r.default)||G(r.default)?G(r.default)?l:r.default:a?l:"",m=a||""!==u,h=Y(r.locale)?r.locale:e.locale;c&&function(e){W(e.list)?e.list=e.list.map((e=>Y(e)?U(e):e)):K(e.named)&&Object.keys(e.named).forEach((t=>{Y(e.named[t])&&(e.named[t]=U(e.named[t]))}))}(r);let[p,g,f]=d?[l,h,s[h]||{}]:function(e,t,a,n,i,o){const{messages:s,onWarn:l}=e,r=ye(e,n,a);let c,d={},u=null;const m="translate";for(let h=0;h<r.length&&(c=r[h],d=s[c]||{},null===(u=le(d,t))&&(u=d[t]),!Y(u)&&!q(u));h++){const a=_e(e,t,c,0,m);a!==t&&(u=a)}return[u,c,d]}(e,l,h,o),v=l;if(d||Y(p)||Ne(p)||m&&(p=u,v=p),!(d||(Y(p)||Ne(p))&&Y(g)))return i?-1:l;let _=!1;const y=Ne(p)?p:Ee(e,l,g,p,v,(()=>{_=!0}));if(_)return p;const k=function(e,t,a,n){const{modifiers:i,pluralRules:o}=e,s=n=>{const i=le(a,n);if(Y(i)){let a=!1;const o=Ee(e,n,t,i,n,(()=>{a=!0}));return a?Ce:o}return Ne(i)?i:Ce},l={locale:t,modifiers:i,pluralRules:o,messages:s};e.processor&&(l.processor=e.processor);n.list&&(l.list=n.list);n.named&&(l.named=n.named);F(n.plural)&&(l.pluralIndex=n.plural);return l}(e,g,f,r),b=function(e,t,a){return t(a)}(0,y,pe(k));return n?n(b):b}function Ee(e,t,a,n,i,o){const{messageCompiler:s,warnHtmlMessage:l}=e;if(Ne(n)){const e=n;return e.locale=e.locale||a,e.key=e.key||t,e}const r=s(n,function(e,t,a,n,i,o){return{warnHtmlMessage:i,onError:e=>{throw o&&o(e),e},onCacheKey:e=>((e,t,a)=>O({l:e,k:t,s:a}))(t,a,e)}}(0,a,i,0,l,o));return r.locale=a,r.key=t,r.source=n,r}function xe(...e){const[t,a,n]=e,i={};if(!Y(t)&&!F(t)&&!Ne(t))throw Se(14);const o=F(t)?String(t):(Ne(t),t);return F(a)?i.plural=a:Y(a)?i.default=a:X(a)&&!L(a)?i.named=a:W(a)&&(i.list=a),F(n)?i.plural=n:Y(n)?i.default=n:X(n)&&z(i,n),[o,i]}function Ve(e,...t){const{datetimeFormats:a,unresolving:n,fallbackLocale:i,onWarn:o}=e,{__datetimeFormatters:s}=e,[l,r,c,d]=$e(...t);G(c.missingWarn)?c.missingWarn:e.missingWarn;G(c.fallbackWarn)?c.fallbackWarn:e.fallbackWarn;const u=!!c.part,m=Y(c.locale)?c.locale:e.locale,h=ye(e,i,m);if(!Y(l)||""===l)return new Intl.DateTimeFormat(m).format(r);let p,g={},f=null;for(let y=0;y<h.length&&(p=h[y],g=a[p]||{},f=g[l],!X(f));y++)_e(e,l,p,0,"datetime format");if(!X(f)||!Y(p))return n?-1:l;let v=`${p}__${l}`;L(d)||(v=`${v}__${JSON.stringify(d)}`);let _=s.get(v);return _||(_=new Intl.DateTimeFormat(p,z({},f,d)),s.set(v,_)),u?_.formatToParts(r):_.format(r)}function $e(...e){const[t,a,n,i]=e;let o,s={},l={};if(Y(t)){if(!/\d{4}-\d{2}-\d{2}(T.*)?/.test(t))throw Se(16);o=new Date(t);try{o.toISOString()}catch(r){throw Se(16)}}else if("[object Date]"===Q(t)){if(isNaN(t.getTime()))throw Se(15);o=t}else{if(!F(t))throw Se(14);o=t}return Y(a)?s.key=a:X(a)&&(s=a),Y(n)?s.locale=n:X(n)&&(l=n),X(i)&&(l=i),[s.key||"",o,s,l]}function Be(e,t,a){const n=e;for(const i in a){const e=`${t}__${i}`;n.__datetimeFormatters.has(e)&&n.__datetimeFormatters.delete(e)}}function Me(e,...t){const{numberFormats:a,unresolving:n,fallbackLocale:i,onWarn:o}=e,{__numberFormatters:s}=e,[l,r,c,d]=Ie(...t);G(c.missingWarn)?c.missingWarn:e.missingWarn;G(c.fallbackWarn)?c.fallbackWarn:e.fallbackWarn;const u=!!c.part,m=Y(c.locale)?c.locale:e.locale,h=ye(e,i,m);if(!Y(l)||""===l)return new Intl.NumberFormat(m).format(r);let p,g={},f=null;for(let y=0;y<h.length&&(p=h[y],g=a[p]||{},f=g[l],!X(f));y++)_e(e,l,p,0,"number format");if(!X(f)||!Y(p))return n?-1:l;let v=`${p}__${l}`;L(d)||(v=`${v}__${JSON.stringify(d)}`);let _=s.get(v);return _||(_=new Intl.NumberFormat(p,z({},f,d)),s.set(v,_)),u?_.formatToParts(r):_.format(r)}function Ie(...e){const[t,a,n,i]=e;let o={},s={};if(!F(t))throw Se(14);const l=t;return Y(a)?o.key=a:X(a)&&(o=a),Y(n)?o.locale=n:X(n)&&(s=n),X(i)&&(s=i),[o.key||"",l,o,s]}function Re(e,t,a){const n=e;for(const i in a){const e=`${t}__${i}`;n.__numberFormatters.has(e)&&n.__numberFormatters.delete(e)}}
/*!
    * vue-i18n v9.1.9
    * (c) 2022 kazuya kawaguchi
    * Released under the MIT License.
    */function Oe(e,...t){return ge(e,null,void 0)}const Fe=R("__transrateVNode"),Ae=R("__datetimeParts"),Le=R("__numberParts"),Pe=R("__setPluralRules"),ze=R("__injectWithOption");let Ue=0;function je(t){return(a,n,i,o)=>t(n,i,e.getCurrentInstance()||void 0,o)}function He(e,t){const{messages:a,__i18n:n}=t,i=X(a)?a:W(n)?{}:{[e]:{}};if(W(n)&&n.forEach((({locale:e,resource:t})=>{e?(i[e]=i[e]||{},qe(t,i[e])):qe(t,i)})),t.flatJson)for(const o in i)H(i,o)&&re(i[o]);return i}const We=e=>!K(e)||W(e);function qe(e,t){if(We(e)||We(t))throw Oe(20);for(const a in e)H(e,a)&&(We(e[a])||We(t[a])?t[a]=e[a]:qe(e[a],t[a]))}function Ye(t={}){const{__root:a}=t,n=void 0===a;let i=!G(t.inheritLocale)||t.inheritLocale;const o=e.ref(a&&i?a.locale.value:Y(t.locale)?t.locale:"en-US"),s=e.ref(a&&i?a.fallbackLocale.value:Y(t.fallbackLocale)||W(t.fallbackLocale)||X(t.fallbackLocale)||!1===t.fallbackLocale?t.fallbackLocale:o.value),l=e.ref(He(o.value,t)),r=e.ref(X(t.datetimeFormats)?t.datetimeFormats:{[o.value]:{}}),c=e.ref(X(t.numberFormats)?t.numberFormats:{[o.value]:{}});let d=a?a.missingWarn:!G(t.missingWarn)&&!A(t.missingWarn)||t.missingWarn,u=a?a.fallbackWarn:!G(t.fallbackWarn)&&!A(t.fallbackWarn)||t.fallbackWarn,m=a?a.fallbackRoot:!G(t.fallbackRoot)||t.fallbackRoot,h=!!t.fallbackFormat,p=q(t.missing)?t.missing:null,g=q(t.missing)?je(t.missing):null,f=q(t.postTranslation)?t.postTranslation:null,v=!G(t.warnHtmlMessage)||t.warnHtmlMessage,_=!!t.escapeParameter;const y=a?a.modifiers:X(t.modifiers)?t.modifiers:{};let k,b=t.pluralRules||a&&a.pluralRules;k=ve({version:"9.1.9",locale:o.value,fallbackLocale:s.value,messages:l.value,messageCompiler:function(e){return t=>t.normalize([e])},datetimeFormats:r.value,numberFormats:c.value,modifiers:y,pluralRules:b,missing:null===g?void 0:g,missingWarn:d,fallbackWarn:u,fallbackFormat:h,unresolving:!0,postTranslation:null===f?void 0:f,warnHtmlMessage:v,escapeParameter:_,__datetimeFormatters:X(k)?k.__datetimeFormatters:void 0,__numberFormatters:X(k)?k.__numberFormatters:void 0,__v_emitter:X(k)?k.__v_emitter:void 0,__meta:{framework:"vue"}}),De(k,o.value,s.value);const w=e.computed({get:()=>o.value,set:e=>{o.value=e,k.locale=o.value}}),D=e.computed({get:()=>s.value,set:e=>{s.value=e,k.fallbackLocale=s.value,De(k,o.value,e)}}),S=e.computed((()=>l.value)),C=e.computed((()=>r.value)),N=e.computed((()=>c.value));function T(e,t,n,i,d,u){let h;if(o.value,s.value,l.value,r.value,c.value,h=e(k),F(h)&&-1===h){const[e,n]=t();return a&&m?i(a):d(e)}if(u(h))return h;throw Oe(14)}function E(...e){return T((t=>Te(t,...e)),(()=>xe(...e)),0,(t=>t.t(...e)),(e=>e),(e=>Y(e)))}const x={normalize:function(t){return t.map((t=>Y(t)?e.createVNode(e.Text,null,t,0):t))},interpolate:e=>e,type:"vnode"};function V(e){return l.value[e]||{}}Ue++,a&&(e.watch(a.locale,(e=>{i&&(o.value=e,k.locale=e,De(k,o.value,s.value))})),e.watch(a.fallbackLocale,(e=>{i&&(s.value=e,k.fallbackLocale=e,De(k,o.value,s.value))})));return{id:Ue,locale:w,fallbackLocale:D,get inheritLocale(){return i},set inheritLocale(e){i=e,e&&a&&(o.value=a.locale.value,s.value=a.fallbackLocale.value,De(k,o.value,s.value))},get availableLocales(){return Object.keys(l.value).sort()},messages:S,datetimeFormats:C,numberFormats:N,get modifiers(){return y},get pluralRules(){return b||{}},get isGlobal(){return n},get missingWarn(){return d},set missingWarn(e){d=e,k.missingWarn=d},get fallbackWarn(){return u},set fallbackWarn(e){u=e,k.fallbackWarn=u},get fallbackRoot(){return m},set fallbackRoot(e){m=e},get fallbackFormat(){return h},set fallbackFormat(e){h=e,k.fallbackFormat=h},get warnHtmlMessage(){return v},set warnHtmlMessage(e){v=e,k.warnHtmlMessage=e},get escapeParameter(){return _},set escapeParameter(e){_=e,k.escapeParameter=e},t:E,rt:function(...e){const[t,a,n]=e;if(n&&!K(n))throw Oe(15);return E(t,a,z({resolvedMessage:!0},n||{}))},d:function(...e){return T((t=>Ve(t,...e)),(()=>$e(...e)),0,(t=>t.d(...e)),(()=>""),(e=>Y(e)))},n:function(...e){return T((t=>Me(t,...e)),(()=>Ie(...e)),0,(t=>t.n(...e)),(()=>""),(e=>Y(e)))},te:function(e,t){return null!==le(V(Y(t)?t:o.value),e)},tm:function(e){const t=function(e){let t=null;const a=ye(k,s.value,o.value);for(let n=0;n<a.length;n++){const i=le(l.value[a[n]]||{},e);if(null!=i){t=i;break}}return t}(e);return null!=t?t:a&&a.tm(e)||{}},getLocaleMessage:V,setLocaleMessage:function(e,t){l.value[e]=t,k.messages=l.value},mergeLocaleMessage:function(e,t){l.value[e]=l.value[e]||{},qe(t,l.value[e]),k.messages=l.value},getDateTimeFormat:function(e){return r.value[e]||{}},setDateTimeFormat:function(e,t){r.value[e]=t,k.datetimeFormats=r.value,Be(k,e,t)},mergeDateTimeFormat:function(e,t){r.value[e]=z(r.value[e]||{},t),k.datetimeFormats=r.value,Be(k,e,t)},getNumberFormat:function(e){return c.value[e]||{}},setNumberFormat:function(e,t){c.value[e]=t,k.numberFormats=c.value,Re(k,e,t)},mergeNumberFormat:function(e,t){c.value[e]=z(c.value[e]||{},t),k.numberFormats=c.value,Re(k,e,t)},getPostTranslationHandler:function(){return q(f)?f:null},setPostTranslationHandler:function(e){f=e,k.postTranslation=e},getMissingHandler:function(){return p},setMissingHandler:function(e){null!==e&&(g=je(e)),p=e,k.missing=g},[Fe]:function(...t){return T((e=>{let a;const n=e;try{n.processor=x,a=Te(n,...t)}finally{n.processor=null}return a}),(()=>xe(...t)),0,(e=>e[Fe](...t)),(t=>[e.createVNode(e.Text,null,t,0)]),(e=>W(e)))},[Le]:function(...e){return T((t=>Me(t,...e)),(()=>Ie(...e)),0,(t=>t[Le](...e)),(()=>[]),(e=>Y(e)||W(e)))},[Ae]:function(...e){return T((t=>Ve(t,...e)),(()=>$e(...e)),0,(t=>t[Ae](...e)),(()=>[]),(e=>Y(e)||W(e)))},[Pe]:function(e){b=e,k.pluralRules=b},[ze]:t.__injectWithOption}}function Ge(e={}){const t=Ye(function(e){const t=Y(e.locale)?e.locale:"en-US",a=Y(e.fallbackLocale)||W(e.fallbackLocale)||X(e.fallbackLocale)||!1===e.fallbackLocale?e.fallbackLocale:t,n=q(e.missing)?e.missing:void 0,i=!G(e.silentTranslationWarn)&&!A(e.silentTranslationWarn)||!e.silentTranslationWarn,o=!G(e.silentFallbackWarn)&&!A(e.silentFallbackWarn)||!e.silentFallbackWarn,s=!G(e.fallbackRoot)||e.fallbackRoot,l=!!e.formatFallbackMessages,r=X(e.modifiers)?e.modifiers:{},c=e.pluralizationRules,d=q(e.postTranslation)?e.postTranslation:void 0,u=!Y(e.warnHtmlInMessage)||"off"!==e.warnHtmlInMessage,m=!!e.escapeParameterHtml,h=!G(e.sync)||e.sync;let p=e.messages;if(X(e.sharedMessages)){const t=e.sharedMessages;p=Object.keys(t).reduce(((e,a)=>{const n=e[a]||(e[a]={});return z(n,t[a]),e}),p||{})}const{__i18n:g,__root:f,__injectWithOption:v}=e,_=e.datetimeFormats,y=e.numberFormats;return{locale:t,fallbackLocale:a,messages:p,flatJson:e.flatJson,datetimeFormats:_,numberFormats:y,missing:n,missingWarn:i,fallbackWarn:o,fallbackRoot:s,fallbackFormat:l,modifiers:r,pluralRules:c,postTranslation:d,warnHtmlMessage:u,escapeParameter:m,inheritLocale:h,__i18n:g,__root:f,__injectWithOption:v}}(e)),a={id:t.id,get locale(){return t.locale.value},set locale(e){t.locale.value=e},get fallbackLocale(){return t.fallbackLocale.value},set fallbackLocale(e){t.fallbackLocale.value=e},get messages(){return t.messages.value},get datetimeFormats(){return t.datetimeFormats.value},get numberFormats(){return t.numberFormats.value},get availableLocales(){return t.availableLocales},get formatter(){return{interpolate:()=>[]}},set formatter(e){},get missing(){return t.getMissingHandler()},set missing(e){t.setMissingHandler(e)},get silentTranslationWarn(){return G(t.missingWarn)?!t.missingWarn:t.missingWarn},set silentTranslationWarn(e){t.missingWarn=G(e)?!e:e},get silentFallbackWarn(){return G(t.fallbackWarn)?!t.fallbackWarn:t.fallbackWarn},set silentFallbackWarn(e){t.fallbackWarn=G(e)?!e:e},get modifiers(){return t.modifiers},get formatFallbackMessages(){return t.fallbackFormat},set formatFallbackMessages(e){t.fallbackFormat=e},get postTranslation(){return t.getPostTranslationHandler()},set postTranslation(e){t.setPostTranslationHandler(e)},get sync(){return t.inheritLocale},set sync(e){t.inheritLocale=e},get warnHtmlInMessage(){return t.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(e){t.warnHtmlMessage="off"!==e},get escapeParameterHtml(){return t.escapeParameter},set escapeParameterHtml(e){t.escapeParameter=e},get preserveDirectiveContent(){return!0},set preserveDirectiveContent(e){},get pluralizationRules(){return t.pluralRules||{}},__composer:t,t(...e){const[a,n,i]=e,o={};let s=null,l=null;if(!Y(a))throw Oe(15);const r=a;return Y(n)?o.locale=n:W(n)?s=n:X(n)&&(l=n),W(i)?s=i:X(i)&&(l=i),t.t(r,s||l||{},o)},rt:(...e)=>t.rt(...e),tc(...e){const[a,n,i]=e,o={plural:1};let s=null,l=null;if(!Y(a))throw Oe(15);const r=a;return Y(n)?o.locale=n:F(n)?o.plural=n:W(n)?s=n:X(n)&&(l=n),Y(i)?o.locale=i:W(i)?s=i:X(i)&&(l=i),t.t(r,s||l||{},o)},te:(e,a)=>t.te(e,a),tm:e=>t.tm(e),getLocaleMessage:e=>t.getLocaleMessage(e),setLocaleMessage(e,a){t.setLocaleMessage(e,a)},mergeLocaleMessage(e,a){t.mergeLocaleMessage(e,a)},d:(...e)=>t.d(...e),getDateTimeFormat:e=>t.getDateTimeFormat(e),setDateTimeFormat(e,a){t.setDateTimeFormat(e,a)},mergeDateTimeFormat(e,a){t.mergeDateTimeFormat(e,a)},n:(...e)=>t.n(...e),getNumberFormat:e=>t.getNumberFormat(e),setNumberFormat(e,a){t.setNumberFormat(e,a)},mergeNumberFormat(e,a){t.mergeNumberFormat(e,a)},getChoiceIndex:(e,t)=>-1,__onComponentInstanceCreated(t){const{componentInstanceCreatedListener:n}=e;n&&n(t,a)}};return a}const Ke={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:e=>"parent"===e||"global"===e,default:"parent"},i18n:{type:Object}},Je={name:"i18n-t",props:z({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:e=>F(e)||!isNaN(e)}},Ke),setup(t,a){const{slots:n,attrs:i}=a,o=t.i18n||it({useScope:t.scope,__useComponent:!0}),s=Object.keys(n).filter((e=>"_"!==e));return()=>{const n={};t.locale&&(n.locale=t.locale),void 0!==t.plural&&(n.plural=Y(t.plural)?+t.plural:t.plural);const l=function({slots:e},t){return 1===t.length&&"default"===t[0]?e.default?e.default():[]:t.reduce(((t,a)=>{const n=e[a];return n&&(t[a]=n()),t}),{})}(a,s),r=o[Fe](t.keypath,l,n),c=z({},i);return Y(t.tag)||K(t.tag)?e.h(t.tag,c,r):e.h(e.Fragment,c,r)}}};function Qe(t,a,n,i){const{slots:o,attrs:s}=a;return()=>{const a={part:!0};let l={};t.locale&&(a.locale=t.locale),Y(t.format)?a.key=t.format:K(t.format)&&(Y(t.format.key)&&(a.key=t.format.key),l=Object.keys(t.format).reduce(((e,a)=>n.includes(a)?z({},e,{[a]:t.format[a]}):e),{}));const r=i(t.value,a,l);let c=[a.key];W(r)?c=r.map(((e,t)=>{const a=o[e.type];return a?a({[e.type]:e.value,index:t,parts:r}):[e.value]})):Y(r)&&(c=[r]);const d=z({},s);return Y(t.tag)||K(t.tag)?e.h(t.tag,d,c):e.h(e.Fragment,d,c)}}const Xe=["localeMatcher","style","unit","unitDisplay","currency","currencyDisplay","useGrouping","numberingSystem","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","notation","formatMatcher"],Ze={name:"i18n-n",props:z({value:{type:Number,required:!0},format:{type:[String,Object]}},Ke),setup(e,t){const a=e.i18n||it({useScope:"parent",__useComponent:!0});return Qe(e,t,Xe,((...e)=>a[Le](...e)))}},et=["dateStyle","timeStyle","fractionalSecondDigits","calendar","dayPeriod","numberingSystem","localeMatcher","timeZone","hour12","hourCycle","formatMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName"],tt={name:"i18n-d",props:z({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},Ke),setup(e,t){const a=e.i18n||it({useScope:"parent",__useComponent:!0});return Qe(e,t,et,((...e)=>a[Ae](...e)))}};function at(e){const t=(t,{instance:a,value:n,modifiers:i})=>{if(!a||!a.$)throw Oe(22);const o=function(e,t){const a=e;if("composition"===e.mode)return a.__getInstance(t)||e.global;{const n=a.__getInstance(t);return null!=n?n.__composer:e.global.__composer}}(e,a.$),s=function(e){if(Y(e))return{path:e};if(X(e)){if(!("path"in e))throw Oe(19);return e}throw Oe(20)}(n);t.textContent=o.t(...function(e){const{path:t,locale:a,args:n,choice:i,plural:o}=e,s={},l=n||{};Y(a)&&(s.locale=a);F(i)&&(s.plural=i);F(o)&&(s.plural=o);return[t,l,s]}(s))};return{beforeMount:t,beforeUpdate:t}}function nt(e,t){e.locale=t.locale||e.locale,e.fallbackLocale=t.fallbackLocale||e.fallbackLocale,e.missing=t.missing||e.missing,e.silentTranslationWarn=t.silentTranslationWarn||e.silentFallbackWarn,e.silentFallbackWarn=t.silentFallbackWarn||e.silentFallbackWarn,e.formatFallbackMessages=t.formatFallbackMessages||e.formatFallbackMessages,e.postTranslation=t.postTranslation||e.postTranslation,e.warnHtmlInMessage=t.warnHtmlInMessage||e.warnHtmlInMessage,e.escapeParameterHtml=t.escapeParameterHtml||e.escapeParameterHtml,e.sync=t.sync||e.sync,e.__composer[Pe](t.pluralizationRules||e.pluralizationRules);const a=He(e.locale,{messages:t.messages,__i18n:t.__i18n});return Object.keys(a).forEach((t=>e.mergeLocaleMessage(t,a[t]))),t.datetimeFormats&&Object.keys(t.datetimeFormats).forEach((a=>e.mergeDateTimeFormat(a,t.datetimeFormats[a]))),t.numberFormats&&Object.keys(t.numberFormats).forEach((a=>e.mergeNumberFormat(a,t.numberFormats[a]))),e}function it(t={}){const a=e.getCurrentInstance();if(null==a)throw Oe(16);if(!a.appContext.app.__VUE_I18N_SYMBOL__)throw Oe(17);const n=e.inject(a.appContext.app.__VUE_I18N_SYMBOL__);if(!n)throw Oe(22);const i="composition"===n.mode?n.global:n.global.__composer,o=L(t)?"__i18n"in a.type?"local":"global":t.useScope?t.useScope:"local";if("global"===o){let e=K(t.messages)?t.messages:{};"__i18nGlobal"in a.type&&(e=He(i.locale.value,{messages:e,__i18n:a.type.__i18nGlobal}));const n=Object.keys(e);if(n.length&&n.forEach((t=>{i.mergeLocaleMessage(t,e[t])})),K(t.datetimeFormats)){const e=Object.keys(t.datetimeFormats);e.length&&e.forEach((e=>{i.mergeDateTimeFormat(e,t.datetimeFormats[e])}))}if(K(t.numberFormats)){const e=Object.keys(t.numberFormats);e.length&&e.forEach((e=>{i.mergeNumberFormat(e,t.numberFormats[e])}))}return i}if("parent"===o){let e=function(e,t,a=!1){let n=null;const i=t.root;let o=t.parent;for(;null!=o;){const t=e;if("composition"===e.mode)n=t.__getInstance(o);else{const e=t.__getInstance(o);null!=e&&(n=e.__composer),a&&n&&!n[ze]&&(n=null)}if(null!=n)break;if(i===o)break;o=o.parent}return n}(n,a,t.__useComponent);return null==e&&(e=i),e}if("legacy"===n.mode)throw Oe(18);const s=n;let l=s.__getInstance(a);if(null==l){const n=a.type,o=z({},t);n.__i18n&&(o.__i18n=n.__i18n),i&&(o.__root=i),l=Ye(o),function(t,a,n){e.onMounted((()=>{}),a),e.onUnmounted((()=>{t.__deleteInstance(a)}),a)}(s,a),s.__setInstance(a,l)}return l}const ot=["locale","fallbackLocale","availableLocales"],st=["t","rt","d","n","tm"];const lt=d(e.defineComponent({__name:"DateRangeFilter",props:{title:{},startDate:{},endDate:{}},emits:["update:startDate","update:endDate"],setup(t,{emit:a}){const{locale:i}=it(),o=a,s=e=>{o("update:startDate",e)},l=e=>{o("update:endDate",e)};return(t,a)=>{const o=n(e.resolveDynamicComponent("uni-datetime-picker"),C);return e.openBlock(),e.createElementBlock("view",{class:"date-filter-block"},[t.title?(e.openBlock(),e.createElementBlock("view",{key:0,class:"f-section-title"},e.toDisplayString(t.title),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"f-row"},[e.createElementVNode("view",{class:"f-group half"},[(e.openBlock(),e.createBlock(o,{key:`start-${e.unref(i)}`,type:"date",value:t.startDate,onChange:s,border:!1},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["f-picker date",{placeholder:!t.startDate}])},e.toDisplayString(t.startDate?e.unref(T)(t.startDate):t.$t("common.from_date")),3)])),_:1},8,["value"]))]),e.createElementVNode("view",{class:"f-group half"},[(e.openBlock(),e.createBlock(o,{key:`end-${e.unref(i)}`,type:"date",value:t.endDate,onChange:l,border:!1},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["f-picker date",{placeholder:!t.endDate}])},e.toDisplayString(t.endDate?e.unref(T)(t.endDate):t.$t("common.to_date")),3)])),_:1},8,["value"]))])])])}}}),[["__scopeId","data-v-2f82a727"]]),rt=d(e.defineComponent({__name:"CustomerModal",props:{visible:{type:Boolean},customers:{},loading:{type:Boolean},managers:{},loadingMore:{type:Boolean}},emits:["close","select","filter","loadMore"],setup(n,{emit:i}){const{t:o}=it(),s=n,l=i,r=e.ref(!1),c=e.reactive({name:"",phone:"",managerIndex:0,selectedMemberUID:"",startDate:"",endDate:""}),d=()=>{a("log","at components/Todo/CustomerModal.vue:110","Cuộn xuống đáy -> Load more"),l("loadMore")},m=e.computed((()=>[o("customer_modal.manager_default"),...(s.managers||[]).map((e=>e.UserName||"Thành viên ẩn danh"))])),h=()=>{r.value=!r.value},p=e=>{const t=parseInt(e.detail.value);if(c.managerIndex=t,0===t)c.selectedMemberUID="";else{const e=s.managers[t-1];e&&(c.selectedMemberUID=e.memberUID)}},g=()=>{c.name="",c.phone="",c.managerIndex=0,c.selectedMemberUID="",c.startDate="",c.endDate="",f(),a("log","at components/Todo/CustomerModal.vue:147","Đã đặt lại bộ lọc")},f=()=>{l("filter",{name:c.name,phone:c.phone,managerUID:c.selectedMemberUID,startDate:c.startDate,endDate:c.endDate}),r.value=!1},v=()=>{l("close")},_=e=>{if(!e)return"";const t=new Date(e);return`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`};return(a,n)=>a.visible?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-overlay",onClick:e.withModifiers(v,["stop"])},[e.createElementVNode("view",{class:"modal-content",onClick:n[4]||(n[4]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(a.$t("customer_modal.title")),1),e.createElementVNode("view",{class:"header-actions"},[e.createElementVNode("view",{class:e.normalizeClass(["filter-toggle-btn",{active:r.value}]),onClick:h},[e.createElementVNode("image",{src:t,class:"filter-icon-img"})],2),e.createElementVNode("text",{class:"close-btn",onClick:v},"✕")])]),r.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"filter-section"},[e.createElementVNode("view",{class:"f-item"},[e.withDirectives(e.createElementVNode("input",{class:"f-input","onUpdate:modelValue":n[0]||(n[0]=e=>c.name=e),placeholder:a.$t("customer_modal.placeholder_name"),"placeholder-class":"ph-style"},null,8,["placeholder"]),[[e.vModelText,c.name]])]),e.createElementVNode("view",{class:"f-item"},[e.withDirectives(e.createElementVNode("input",{class:"f-input","onUpdate:modelValue":n[1]||(n[1]=e=>c.phone=e),type:"number",placeholder:a.$t("customer_modal.placeholder_phone"),"placeholder-class":"ph-style"},null,8,["placeholder"]),[[e.vModelText,c.phone]])]),e.createElementVNode("view",{class:"f-item"},[e.createElementVNode("picker",{mode:"selector",range:m.value,value:c.managerIndex,onChange:p},[e.createElementVNode("view",{class:"f-picker-box"},[e.createElementVNode("text",{class:e.normalizeClass(0===c.managerIndex?"text-ph":"text-val")},e.toDisplayString(m.value[c.managerIndex]),3),e.createElementVNode("text",{class:"arrow"},"▼")])],40,["range","value"])]),e.createElementVNode("view",{class:"f-item"},[e.createVNode(lt,{startDate:c.startDate,endDate:c.endDate,"onUpdate:startDate":n[2]||(n[2]=e=>c.startDate=e),"onUpdate:endDate":n[3]||(n[3]=e=>c.endDate=e)},null,8,["startDate","endDate"])]),e.createElementVNode("view",{class:"f-actions"},[e.createElementVNode("button",{class:"btn-reset",onClick:g},e.toDisplayString(a.$t("common.reset")),1),e.createElementVNode("button",{class:"btn-submit",onClick:f},e.toDisplayString(a.$t("common.filter")),1)])])):e.createCommentVNode("",!0),a.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-state"},e.toDisplayString(a.$t("common.loading")),1)):(e.openBlock(),e.createElementBlock("scroll-view",{key:2,"scroll-y":"",class:"customer-list",onScrolltolower:d,"lower-threshold":"50"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.customers,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"customer-item",onClick:e=>(e=>{l("select",e),v()})(t)},[e.createVNode(u,{name:t.name,size:40,class:"mr-3"},null,8,["name"]),e.createElementVNode("view",{class:"info-column"},[e.createElementVNode("text",{class:"name-text"},e.toDisplayString(t.name||a.$t("customer_modal.no_name")),1),e.createElementVNode("text",{class:"phone-text"},e.toDisplayString(t.phone||a.$t("customer_modal.no_phone")),1)]),e.createElementVNode("view",{class:"date-column"},[e.createElementVNode("text",{class:"date-text"},e.toDisplayString(_(t.createAt)),1)])],8,["onClick"])))),128)),a.loadingMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-more-container"},[e.createElementVNode("text",{class:"loading-more-text"},e.toDisplayString(a.$t("customer_modal.loading_more")),1)])):e.createCommentVNode("",!0),0===a.customers.length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},e.toDisplayString(a.$t("common.no_data")),1)):e.createCommentVNode("",!0)],32))])])):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-b8ec511a"]]);
/*!
   * pinia v2.1.7
   * (c) 2023 Eduardo San Martin Morote
   * @license MIT
   */
let ct;const dt=e=>ct=e,ut=Symbol();function mt(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var ht,pt;(pt=ht||(ht={})).direct="direct",pt.patchObject="patch object",pt.patchFunction="patch function";const gt="undefined"!=typeof window;function ft(){const t=e.effectScope(!0),a=t.run((()=>e.ref({})));let n=[],i=[];const o=e.markRaw({install(e){dt(o),o._a=e,e.provide(ut,o),e.config.globalProperties.$pinia=o,i.forEach((e=>n.push(e))),i=[]},use(e){return this._a?n.push(e):i.push(e),this},_p:n,_a:null,_e:t,_s:new Map,state:a});return o}const vt=()=>{};function _t(t,a,n,i=vt){t.push(a);const o=()=>{const e=t.indexOf(a);e>-1&&(t.splice(e,1),i())};return!n&&e.getCurrentScope()&&e.onScopeDispose(o),o}function yt(e,...t){e.slice().forEach((e=>{e(...t)}))}const kt=e=>e();function bt(t,a){t instanceof Map&&a instanceof Map&&a.forEach(((e,a)=>t.set(a,e))),t instanceof Set&&a instanceof Set&&a.forEach(t.add,t);for(const n in a){if(!a.hasOwnProperty(n))continue;const i=a[n],o=t[n];mt(o)&&mt(i)&&t.hasOwnProperty(n)&&!e.isRef(i)&&!e.isReactive(i)?t[n]=bt(o,i):t[n]=i}return t}const wt=Symbol();const{assign:Dt}=Object;function St(t,a,n={},i,o,s){let l;const r=Dt({actions:{}},n),c={deep:!0};let d,u,m,h=[],p=[];const g=i.state.value[t];let f;function v(a){let n;d=u=!1,"function"==typeof a?(a(i.state.value[t]),n={type:ht.patchFunction,storeId:t,events:m}):(bt(i.state.value[t],a),n={type:ht.patchObject,payload:a,storeId:t,events:m});const o=f=Symbol();e.nextTick().then((()=>{f===o&&(d=!0)})),u=!0,yt(h,n,i.state.value[t])}s||g||(i.state.value[t]={}),e.ref({});const _=s?function(){const{state:e}=n,t=e?e():{};this.$patch((e=>{Dt(e,t)}))}:vt;function y(e,a){return function(){dt(i);const n=Array.from(arguments),o=[],s=[];function l(e){o.push(e)}function r(e){s.push(e)}let c;yt(p,{args:n,name:e,store:b,after:l,onError:r});try{c=a.apply(this&&this.$id===t?this:b,n)}catch(d){throw yt(s,d),d}return c instanceof Promise?c.then((e=>(yt(o,e),e))).catch((e=>(yt(s,e),Promise.reject(e)))):(yt(o,c),c)}}const k={_p:i,$id:t,$onAction:_t.bind(null,p),$patch:v,$reset:_,$subscribe(a,n={}){const o=_t(h,a,n.detached,(()=>s())),s=l.run((()=>e.watch((()=>i.state.value[t]),(e=>{("sync"===n.flush?u:d)&&a({storeId:t,type:ht.direct,events:m},e)}),Dt({},c,n))));return o},$dispose:function(){l.stop(),h=[],p=[],i._s.delete(t)}},b=e.reactive(k);i._s.set(t,b);const w=(i._a&&i._a.runWithContext||kt)((()=>i._e.run((()=>(l=e.effectScope()).run(a)))));for(const C in w){const a=w[C];if(e.isRef(a)&&(S=a,!e.isRef(S)||!S.effect)||e.isReactive(a))s||(!g||mt(D=a)&&D.hasOwnProperty(wt)||(e.isRef(a)?a.value=g[C]:bt(a,g[C])),i.state.value[t][C]=a);else if("function"==typeof a){const e=y(C,a);w[C]=e,r.actions[C]=a}}var D,S;return Dt(b,w),Dt(e.toRaw(b),w),Object.defineProperty(b,"$state",{get:()=>i.state.value[t],set:e=>{v((t=>{Dt(t,e)}))}}),i._p.forEach((e=>{Dt(b,l.run((()=>e({store:b,app:i._a,pinia:i,options:r}))))})),g&&s&&n.hydrate&&n.hydrate(b.$state,g),d=!0,u=!0,b}function Ct(t,a,n){let i,o;const s="function"==typeof a;function l(t,n){const l=e.hasInjectionContext();(t=t||(l?e.inject(ut,null):null))&&dt(t),(t=ct)._s.has(i)||(s?St(i,a,o,t):function(t,a,n,i){const{state:o,actions:s,getters:l}=a,r=n.state.value[t];let c;c=St(t,(function(){r||(n.state.value[t]=o?o():{});const a=e.toRefs(n.state.value[t]);return Dt(a,s,Object.keys(l||{}).reduce(((a,i)=>(a[i]=e.markRaw(e.computed((()=>{dt(n);const e=n._s.get(t);return l[i].call(e,e)}))),a)),{}))}),a,n,0,!0)}(i,o,t));return t._s.get(i)}return"string"==typeof t?(i=t,o=s?n:a):(o=t,i=t.id),l.$id=i,l}let Nt="Store";function Tt(e,t){return Array.isArray(t)?t.reduce(((t,a)=>(t[a]=function(){return e(this.$pinia)[a]},t)),{}):Object.keys(t).reduce(((a,n)=>(a[n]=function(){const a=e(this.$pinia),i=t[n];return"function"==typeof i?i.call(this,a):a[i]},a)),{})}const Et=Tt;const xt=Object.freeze(Object.defineProperty({__proto__:null,get MutationType(){return ht},PiniaVuePlugin:function(e){e.mixin({beforeCreate(){const e=this.$options;if(e.pinia){const t=e.pinia;if(!this._provided){const e={};Object.defineProperty(this,"_provided",{get:()=>e,set:t=>Object.assign(e,t)})}this._provided[ut]=t,this.$pinia||(this.$pinia=t),t._a=this,gt&&dt(t)}else!this.$pinia&&e.parent&&e.parent.$pinia&&(this.$pinia=e.parent.$pinia)},destroyed(){delete this._pStores}})},acceptHMRUpdate:function(e,t){return()=>{}},createPinia:ft,defineStore:Ct,getActivePinia:()=>e.hasInjectionContext()&&e.inject(ut)||ct,mapActions:function(e,t){return Array.isArray(t)?t.reduce(((t,a)=>(t[a]=function(...t){return e(this.$pinia)[a](...t)},t)),{}):Object.keys(t).reduce(((a,n)=>(a[n]=function(...a){return e(this.$pinia)[t[n]](...a)},a)),{})},mapGetters:Et,mapState:Tt,mapStores:function(...e){return e.reduce(((e,t)=>(e[t.$id+Nt]=function(){return t(this.$pinia)},e)),{})},mapWritableState:function(e,t){return Array.isArray(t)?t.reduce(((t,a)=>(t[a]={get(){return e(this.$pinia)[a]},set(t){return e(this.$pinia)[a]=t}},t)),{}):Object.keys(t).reduce(((a,n)=>(a[n]={get(){return e(this.$pinia)[t[n]]},set(a){return e(this.$pinia)[t[n]]=a}},a)),{})},setActivePinia:dt,setMapStoreSuffix:function(e){Nt=e},skipHydrate:function(e){return Object.defineProperty(e,wt,{})},storeToRefs:function(t){{t=e.toRaw(t);const a={};for(const n in t){const i=t[n];(e.isRef(i)||e.isReactive(i))&&(a[n]=e.toRef(t,n))}return a}}},Symbol.toStringTag,{value:"Module"})),Vt="CALL",$t="CUSTOMER",Bt="CONVERSATION",Mt="CHAT_MESSAGE",It="Desktop-RTC",Rt="TODO",Ot="",Ft="",At="",Lt="",Pt="",zt="",Ut="072836272322",jt="https://api-sandbox-h01.vbot.vn/v1.0",Ht=`${jt}/api/module-crm`,Wt=`${jt}/api/project`,qt=`${jt}/api/module-todo/todo`,Yt="PR202511211001129372",Gt=(e,t)=>{const a=Zt();return ea({url:`${Ht}/token`,method:"GET",data:{projectCode:e,uid:t,type:"CRM",source:It},header:{Authorization:`Bearer ${a.rootToken}`}}).then((e=>e.token))},Kt=()=>{const e=Zt(),{rootToken:t,projectCode:a}=e;return new Promise(((e,n)=>{uni.request({url:`${Wt}/getAllMember`,method:"GET",data:{projectCode:a,status:"all"},header:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},success:t=>{const a=t.data;1===a.status&&a.data?e(a.data):n(a.message||"Lỗi lấy danh sách thành viên")},fail:e=>{n(e)}})}))},Jt=Ct("notification",{state:()=>({visible:!1,message:"",type:"info",queue:[],timeoutId:null,isAnimating:!1}),actions:{show(e,t="info",a=7e3){this.queue.push({message:e,type:t,duration:a}),this.visible||this.isAnimating||this.processQueue()},processQueue(){if(0===this.queue.length)return;const e=this.queue.shift();e&&(this.message=e.message,this.type=e.type,this.visible=!0,this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>{this.hide()}),e.duration))},hide(){this.visible&&(this.visible=!1,this.isAnimating=!0,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),setTimeout((()=>{this.isAnimating=!1,this.processQueue()}),450))}}}),Qt=function(t={}){const a=!G(t.legacy)||t.legacy,n=!!t.globalInjection,i=new Map,o=a?Ge(t):Ye(t),s=R(""),l={get mode(){return a?"legacy":"composition"},async install(t,...i){t.__VUE_I18N_SYMBOL__=s,t.provide(t.__VUE_I18N_SYMBOL__,l),!a&&n&&function(t,a){const n=Object.create(null);ot.forEach((t=>{const i=Object.getOwnPropertyDescriptor(a,t);if(!i)throw Oe(22);const o=e.isRef(i.value)?{get:()=>i.value.value,set(e){i.value.value=e}}:{get:()=>i.get&&i.get()};Object.defineProperty(n,t,o)})),t.config.globalProperties.$i18n=n,st.forEach((e=>{const n=Object.getOwnPropertyDescriptor(a,e);if(!n||!n.value)throw Oe(22);Object.defineProperty(t.config.globalProperties,`$${e}`,n)}))}(t,l.global),function(e,t,...a){const n=X(a[0])?a[0]:{},i=!!n.useI18nComponentName;(!G(n.globalInstall)||n.globalInstall)&&(e.component(i?"i18n":Je.name,Je),e.component(Ze.name,Ze),e.component(tt.name,tt)),e.directive("t",at(t))}(t,l,...i),a&&t.mixin(function(t,a,n){return{beforeCreate(){const i=e.getCurrentInstance();if(!i)throw Oe(22);const o=this.$options;if(o.i18n){const e=o.i18n;o.__i18n&&(e.__i18n=o.__i18n),e.__root=a,this===this.$root?this.$i18n=nt(t,e):(e.__injectWithOption=!0,this.$i18n=Ge(e))}else o.__i18n?this===this.$root?this.$i18n=nt(t,o):this.$i18n=Ge({__i18n:o.__i18n,__injectWithOption:!0,__root:a}):this.$i18n=t;t.__onComponentInstanceCreated(this.$i18n),n.__setInstance(i,this.$i18n),this.$t=(...e)=>this.$i18n.t(...e),this.$rt=(...e)=>this.$i18n.rt(...e),this.$tc=(...e)=>this.$i18n.tc(...e),this.$te=(e,t)=>this.$i18n.te(e,t),this.$d=(...e)=>this.$i18n.d(...e),this.$n=(...e)=>this.$i18n.n(...e),this.$tm=e=>this.$i18n.tm(e)},mounted(){},beforeUnmount(){const t=e.getCurrentInstance();if(!t)throw Oe(22);delete this.$t,delete this.$rt,delete this.$tc,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,n.__deleteInstance(t),delete this.$i18n}}}(o,o.__composer,l))},get global(){return o},__instances:i,__getInstance:e=>i.get(e)||null,__setInstance(e,t){i.set(e,t)},__deleteInstance(e){i.delete(e)}};return l}({locale:"vi",fallbackLocale:"vi",messages:{vi:{common:{loading:"Đang tải dữ liệu...",no_data:"Chưa có dữ liệu",all:"Tất cả",reset:"Đặt lại",apply:"Áp dụng",delete:"Xóa",confirm:"Xác nhận",cancel:"Hủy",notification:"Thông báo",success_delete:"Đã xóa thành công",fail_delete:"Xóa thất bại",error_load:"Lỗi tải dữ liệu",save:"Lưu",saving:"Đang lưu...",cancel_action:"Hủy bỏ",search:"Tìm kiếm",filter:"Lọc",me:"tôi",system:"Hệ thống",unknown_member:"Thành viên ẩn danh",error_missing_data:"Thiếu dữ liệu gốc",error_connection:"Lỗi kết nối",error_update:"Cập nhật thất bại",error_send:"Gửi thất bại",page_unit:"trang",total:"Tổng",from_date:"Từ ngày",to_date:"Đến ngày",hidden_member:"Thành viên ẩn",hidden_user:"Người dùng ẩn",open_link:"Mở",copy_link:"Sao chép",edit_link:"Chỉnh sửa"},todo:{page_title:"Công việc",create_page_title:"Tạo công việc",add_task:"Thêm công việc",created_at:"Tạo",expired_at:"Hết hạn",notify_at:"Thông báo",code_prefix:"Mã công việc",filter_title:"Bộ lọc tìm kiếm",search_placeholder:"Nhập từ khóa...",search_label:"Tiêu đề / Từ khóa",job_code_placeholder:"Ví dụ: TODO-08",status:"Trạng thái",creator:"Người tạo",customer:"Khách hàng",select_customer:"Chọn khách hàng",assignee:"Người được giao",source:"Nguồn",select_source:"Chọn nguồn",time_create:"Thời gian tạo",time_expired:"Thời gian hết hạn",time_notify:"Thời gian thông báo",confirm_delete_msg:'Bạn có chắc muốn xóa công việc "{title}"?',enter_task_name:"Nhập tên công việc... *",char_count:"{current}/{max}",due_date_label:"Hạn xử lý:",notify_date_label:"Ngày thông báo:",select_date:"Chọn ngày",date_text:"Ngày",time_text:"Giờ",validate_name:"Vui lòng nhập tên công việc",create_success:"Tạo thành công!",upload_processing:"Đang xử lý dữ liệu...",header_loading:"Đang tải tên công việc...",desc_section:"Mô tả",desc_placeholder:"Nhập mô tả công việc...",info_section:"Thông tin công việc",customer_section:"Thông tin khách hàng",loading_crm:"⏳ Đang tải thông tin từ CRM...",no_customer_attached:"(Công việc này chưa gắn với khách hàng nào)",customer_name_label:"Khách hàng",customer_phone_label:"SĐT",customer_manager_label:"Phụ trách",manager_none:"(Chưa có)",comments_activities:"Bình luận và hoạt động",comment_placeholder_edit:"Đang chỉnh sửa...",comment_placeholder_reply:"Viết câu trả lời...",comment_placeholder_write:"Viết bình luận",editing_alert:"Đang chỉnh sửa bình luận của",replying_alert:"Đang trả lời bình luận của",loading_comments:"⏳ Đang tải bình luận...",no_comments:"Chưa có bình luận nào.",history_section:"Lịch sử tương tác khách hàng",loading_history:"⏳ Đang tải lịch sử...",no_history:"(Không tìm thấy dữ liệu)",reply_btn:"Trả lời",update_btn:"Cập nhật",cancel_edit_title:"Xác nhận hủy",cancel_edit_msg:"Bạn có chắc muốn hủy chỉnh sửa? Các thay đổi sẽ không được lưu.",continue_edit:"Tiếp tục sửa",cancel_reply_title:"Hủy trả lời",cancel_reply_msg:"Bạn có chắc muốn hủy trả lời? Nội dung đã nhập sẽ bị mất.",continue_reply:"Tiếp tục viết",delete_comment_title:"Xác nhận xóa",delete_comment_msg:"Bạn có chắc muốn xóa bình luận này không?",status_todo:"Chưa xử lý",status_progress:"Đang xử lý",status_done:"Hoàn thành",status_overdue:"Quá hạn",filter_activity_all:"Tất cả hoạt động",filter_activity_comment:"Bình luận",history_all:"Tất cả",history_todo:"Công việc",history_ticket:"Ticket",history_call:"Lịch sử gọi",history_customer:"Khách hàng",history_note:"Ghi chú",msg_update_success:"Cập nhật thành công",msg_update_error:"Lỗi cập nhật",msg_title_empty:"Tiêu đề không được để trống",msg_title_changed:"Đã đổi tiêu đề",msg_desc_saved:"Đã cập nhật mô tả",msg_reply_success:"Đã trả lời",msg_comment_success:"Đã gửi bình luận",msg_empty_content:"Vui lòng nhập nội dung",msg_assignee_changed:"Đã đổi người thực hiện",msg_status_changed:"Đã cập nhật trạng thái",action_comment:"đã thêm một bình luận",action_log:"đã cập nhật hoạt động",action_update:"cập nhật thông tin công việc",user_hidden:"Người dùng ẩn",unknown:"Chưa xác định",msg_deleted:"Đã xóa",msg_saved:"Đã lưu",interaction_other:"Tương tác khác"},customer_modal:{title:"Chọn khách hàng",placeholder_name:"Nhập tên khách hàng",placeholder_phone:"Nhập số điện thoại",manager_default:"Thành viên quản lý",loading_more:"Đang tải thêm...",no_name:"(Không tên)",no_phone:"Không có SĐT"},editor:{placeholder:"Nhập nội dung mô tả...",link_modal_title:"Chèn Hyperlink (Text)",card_modal_title:"Chèn Thẻ Liên Kết (Web)",card_modal_desc:"Liên kết sẽ hiển thị dạng thẻ xem trước.",color_text:"Màu chữ",color_bg:"Màu nền",align_left:"Căn trái",align_center:"Căn giữa",align_right:"Căn phải",align_justify:"Căn đều",size_small:"Nhỏ",size_normal:"Bình thường",size_large:"Lớn",size_huge:"Rất lớn",img_camera:"Chụp ảnh mới",img_album:"Chọn từ thư viện"},source:{call:"Cuộc gọi",customer:"Khách hàng",conversation:"Hội thoại",message:"Tin nhắn"},uni:{showActionSheet:{cancel:"Hủy"}},"uni-datetime-picker":{selectDate:"Chọn ngày",selectTime:"Chọn giờ",selectDateTime:"Chọn ngày giờ",startDate:"Ngày bắt đầu",endDate:"Ngày kết thúc",ok:"OK",clear:"Xóa",cancel:"Hủy",year:"Năm",month:"Tháng"},"uni-calender":{confirm:"Xác nhận",SUN:"CN",MON:"T2",TUE:"T3",WED:"T4",THU:"T5",FRI:"T6",SAT:"T7",jan:"Tháng 1",feb:"Tháng 2",mar:"Tháng 3",apr:"Tháng 4",may:"Tháng 5",jun:"Tháng 6",jul:"Tháng 7",aug:"Tháng 8",sep:"Tháng 9",oct:"Tháng 10",nov:"Tháng 11",dec:"Tháng 12"},socket:{received_at:"Công việc <span class='highlight'>{code}</span> | <b>{title}</b> ở nhóm <b>{group}</b> sẽ hết hạn vào {date}. Vui lòng kiểm tra!",reassigned:"Công việc <span class='highlight'>{code}</span> | <b>{title}</b> ở nhóm <b>{group}</b> đã đổi người phụ trách: <b>{oldData}</b> ➝ <span class='highlight'>{newData}</span>",status_changed:"Công việc <span class='highlight'>{code}</span> | <b>{title}</b> ở nhóm <b>{group}</b> đã cập nhật trạng thái: <b>{oldData}</b> ➝ <span class='highlight'>{newData}</span>",task_assigned:"Bạn có công việc mới: <span class='highlight'>{code}</span> | <b>{title}</b> ở nhóm <b>{group}</b>",due_date_passed:"Công việc <span class='highlight'>{code}</span> | <b>{title}</b> ở nhóm <b>{group}</b> đã hết hạn vào {date}. Xử lý ngay!"}},en:{common:{loading:"Loading data...",no_data:"No data available",all:"All",reset:"Reset",apply:"Apply",delete:"Delete",confirm:"Confirm",cancel:"Cancel",notification:"Notification",success_delete:"Deleted successfully",fail_delete:"Delete failed",error_load:"Error loading data",save:"Save",saving:"Saving...",cancel_action:"Cancel",search:"Search",filter:"Filter",me:"me",system:"System",unknown_member:"Unknown Member",error_missing_data:"Original data missing",error_connection:"Connection error",error_update:"Update failed",error_send:"Send failed",page_unit:"page",total:"Total",from_date:"From Date",to_date:"To Date",hidden_member:"Hidden Member",hidden_user:"Hidden User",open_link:"Open",copy_link:"Copy",edit_link:"Edit"},todo:{page_title:"Todo",create_page_title:"Create Task",add_task:"Add Task",created_at:"Created",expired_at:"Due date",notify_at:"Notify",code_prefix:"Job Code",filter_title:"Search Filter",search_placeholder:"Enter keywords...",search_label:"Title / Keywords",job_code_placeholder:"Ex: TODO-08",status:"Status",creator:"Creator",customer:"Customer",select_customer:"Select Customer",assignee:"Assignee",source:"Source",select_source:"Select Source",time_create:"Created Time",time_expired:"Due Date Time",time_notify:"Notification Time",confirm_delete_msg:'Are you sure you want to delete "{title}"?',enter_task_name:"Enter task name... *",char_count:"{current}/{max}",due_date_label:"Due Date:",notify_date_label:"Notify Date:",select_date:"Select Date",date_text:"Date",time_text:"Time",validate_name:"Please enter task name",create_success:"Created successfully!",upload_processing:"Processing data...",header_loading:"Loading task title...",desc_section:"Description",desc_placeholder:"Enter task description...",info_section:"Task Information",customer_section:"Customer Information",loading_crm:"⏳ Loading CRM info...",no_customer_attached:"(No customer attached)",customer_name_label:"Customer",customer_phone_label:"Phone",customer_manager_label:"In charge",manager_none:"(None)",comments_activities:"Comments & Activities",comment_placeholder_edit:"Editing...",comment_placeholder_reply:"Write a reply...",comment_placeholder_write:"Write a comment",editing_alert:"Editing comment of",replying_alert:"Replying to comment of",loading_comments:"⏳ Loading comments...",no_comments:"No comments yet.",history_section:"Customer Interaction History",loading_history:"⏳ Loading history...",no_history:"(No data found)",reply_btn:"Reply",update_btn:"Update",cancel_edit_title:"Cancel Editing",cancel_edit_msg:"Are you sure you want to cancel? Changes will be lost.",continue_edit:"Keep Editing",cancel_reply_title:"Cancel Reply",cancel_reply_msg:"Are you sure? Draft content will be lost.",continue_reply:"Keep Writing",delete_comment_title:"Confirm Delete",delete_comment_msg:"Are you sure you want to delete this comment?",status_todo:"To Do",status_progress:"In Progress",status_done:"Done",status_overdue:"Overdue",filter_activity_all:"All Activities",filter_activity_comment:"Comments",history_all:"All",history_todo:"Tasks",history_ticket:"Tickets",history_call:"Calls",history_customer:"Customer",history_note:"Notes",msg_update_success:"Update successful",msg_update_error:"Update failed",msg_title_empty:"Title cannot be empty",msg_title_changed:"Title changed",msg_desc_saved:"Description updated",msg_reply_success:"Replied successfully",msg_comment_success:"Comment sent",msg_empty_content:"Please enter content",msg_assignee_changed:"Assignee changed",msg_status_changed:"Status updated",action_comment:"added a comment",action_log:"updated activity",action_update:"updated task info",user_hidden:"Hidden User",unknown:"Unknown",msg_deleted:"Deleted",msg_saved:"Saved",interaction_other:"Other interaction"},customer_modal:{title:"Select Customer",placeholder_name:"Enter customer name",placeholder_phone:"Enter phone number",manager_default:"Manager Member",loading_more:"Loading more...",no_name:"(No Name)",no_phone:"No Phone"},editor:{placeholder:"Enter description...",link_modal_title:"Insert Hyperlink (Text)",card_modal_title:"Insert Link Card (Web)",card_modal_desc:"Link will be displayed as a preview card.",color_text:"Text Color",color_bg:"Background Color",align_left:"Align Left",align_center:"Align Center",align_right:"Align Right",align_justify:"Justify",size_small:"Small",size_normal:"Normal",size_large:"Large",size_huge:"Huge",img_camera:"Take Photo",img_album:"Choose from Album"},source:{call:"Call",customer:"Customer",conversation:"Conversation",message:"Message"},uni:{showActionSheet:{cancel:"Cancel"}},"uni-datetime-picker":{selectDate:"Select Date",selectTime:"Select Time",selectDateTime:"Select Date & Time",startDate:"Start Date",endDate:"End Date",ok:"OK",clear:"Clear",cancel:"Cancel",year:"Year",month:"Month"},"uni-calender":{confirm:"Confirm",SUN:"Sun",MON:"Mon",TUE:"Tue",WED:"Wed",THU:"Thu",FRI:"Fri",SAT:"Sat",jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"},socket:{received_at:"Task <span class='highlight'>{code}</span> | <b>{title}</b> in group <b>{group}</b> is due on {date}. Please check!",reassigned:"Task <span class='highlight'>{code}</span> | <b>{title}</b> in group <b>{group}</b> assignee changed: <b>{oldData}</b> ➝ <span class='highlight'>{newData}</span>",status_changed:"Task <span class='highlight'>{code}</span> | <b>{title}</b> in group <b>{group}</b> status updated: <b>{oldData}</b> ➝ <span class='highlight'>{newData}</span>",task_assigned:"New task assigned: <span class='highlight'>{code}</span> | <b>{title}</b> in group <b>{group}</b>",due_date_passed:"Task <span class='highlight'>{code}</span> | <b>{title}</b> in group <b>{group}</b> expired on {date}. Action required!"}}},legacy:!1,globalInjection:!0}),Xt=Ct("socket",{state:()=>({socketTask:null,isConnected:!1,isConnecting:!1,reconnectInterval:null,projectNamesCache:{},isManualClose:!1}),actions:{initWatcher(){const t=Zt();e.watch((()=>t.sessionId),(e=>{e&&!this.isConnected&&(a("log","at stores/socket.ts:34","Socket: Phát hiện Session ID mới, đang kết nối..."),this.connect())}))},connect(){if(this.isConnected||this.isConnecting)return;const e=Zt().sessionId;if(!e)return;this.isManualClose=!1,this.isConnecting=!0;const t=`wss://ws-sandbox-h01.vbot.vn/ws/call?session_id=${e}`;a("log","at stores/socket.ts:51","Socket: Connecting to...",t),this.socketTask=uni.connectSocket({url:t,success:()=>a("log","at stores/socket.ts:55","Socket: Init success"),fail:e=>{a("error","at stores/socket.ts:57","Socket: Init failed",e),this.isConnecting=!1}}),this.socketTask.onOpen((()=>{a("log","at stores/socket.ts:63","Socket: Connected!"),this.isConnected=!0,this.isConnecting=!1,this.reconnectInterval&&(clearInterval(this.reconnectInterval),this.reconnectInterval=null)})),this.socketTask.onMessage((e=>{this.handleMessage(e.data)})),this.socketTask.onError((e=>{a("error","at stores/socket.ts:78","Socket Error:",e),this.isConnected=!1,this.isConnecting=!1})),this.socketTask.onClose((()=>{a("log","at stores/socket.ts:84","Socket: Closed"),this.isConnected=!1,this.isConnecting=!1,this.socketTask=null,this.isManualClose?a("log","at stores/socket.ts:96","Socket: Chủ động ngắt kết nối, không reconnect."):this.reconnectInterval||(this.reconnectInterval=setInterval((()=>{a("log","at stores/socket.ts:91","Socket: Reconnecting (Auto)..."),this.connect()}),5e3))}))},disconnect(){a("log","at stores/socket.ts:101","Socket: Đang thực hiện Cleanup..."),this.isManualClose=!0,this.reconnectInterval&&(clearInterval(this.reconnectInterval),this.reconnectInterval=null),this.socketTask&&(this.socketTask.close({}),this.socketTask=null),this.isConnected=!1,this.isConnecting=!1},async handleMessage(e){try{const t=JSON.parse(e);if("TODO"!==t.module)return;switch(a("log","at stores/socket.ts:124","Socket Received Event:",t.eventName,t),t.eventName){case"TODO_NOTIFICATION_RECEIVED_AT":await this.handleNotificationReceived(t.data);break;case"TODO_REASSIGNED":await this.handleReassigned(t.data);break;case"TODO_STATUS_CHANGED":await this.handleStatusChanged(t.data);break;case"TODO_TASK_ASSIGNED":await this.handleTaskAssigned(t.data);break;case"TODO_NOTIFICATION_DUE_DATE_PASSED":await this.handleDueDatePassed(t.data)}}catch(t){a("error","at stores/socket.ts:147","Socket: Parse message error",t)}},getNotificationContent(e,t){let a=Qt.global.t(e);for(const[n,i]of Object.entries(t)){const e=new RegExp(`{${n}}`,"g");a=a.replace(e,String(i))}return a},async getGroupName(e){var t;if(!e)return"Nhóm không xác định";if(this.projectNamesCache[e])return this.projectNamesCache[e];try{const a=await(e=>{const t=Zt();return new Promise(((a,n)=>{uni.request({url:`${Wt}/getByProjectCode`,method:"GET",data:{code:e},header:{Authorization:`Bearer ${t.rootToken}`,"Content-Type":"application/json"},success:e=>{const t=e.data;200===e.statusCode?a(t.data||t):n(t)},fail:e=>n(e)})}))})(e),n=(null==a?void 0:a.Name)||(null==(t=null==a?void 0:a.data)?void 0:t.Name)||e;return this.projectNamesCache[e]=n,n}catch(n){return a("error","at stores/socket.ts:175","Lỗi lấy tên nhóm:",n),e}},async handleNotificationReceived(e){const t=await this.getGroupName(e.projectCode),a=this.getNotificationContent("socket.received_at",{code:e.code||"N/A",title:e.title||"",group:t,date:e.dueDate||""});this.showNotificationAlert(a,"warning")},async handleReassigned(e){const t=await this.getGroupName(e.projectCode),a=this.getNotificationContent("socket.reassigned",{code:e.code||"N/A",title:e.title||"",group:t,oldData:e.oldData||"Unknown",newData:e.newData||"Unknown"});this.showNotificationAlert(a,"info")},async handleStatusChanged(e){const t=await this.getGroupName(e.projectCode),a=this.getNotificationContent("socket.status_changed",{code:e.code||"N/A",title:e.title||"",group:t,oldData:e.oldData||"Unknown",newData:e.newData||"Unknown"});this.showNotificationAlert(a,"success")},async handleTaskAssigned(e){const t=await this.getGroupName(e.projectCode),a=this.getNotificationContent("socket.task_assigned",{code:e.code||"N/A",title:e.title||"",group:t});this.showNotificationAlert(a,"info")},async handleDueDatePassed(e){const t=await this.getGroupName(e.projectCode),a=this.getNotificationContent("socket.due_date_passed",{code:e.code||"N/A",title:e.title||"",group:t,date:e.dueDate||""});this.showNotificationAlert(a,"error")},showNotificationAlert(e,t="info"){uni.vibrateShort({});Jt().show(e,t)}}}),Zt=Ct("auth",{state:()=>({rootToken:uni.getStorageSync("vbot_root_token")||"",rootLoginTime:uni.getStorageSync("vbot_root_login_time")||0,sessionId:uni.getStorageSync("vbot_session_id")||"",todoToken:uni.getStorageSync("todo_access_token")||"",crmToken:uni.getStorageSync("crm_access_token")||"",uid:uni.getStorageSync("vbot_uid")||"",projectCode:uni.getStorageSync("vbot_project_code")||"",refreshPromise:null}),getters:{isLoggedIn:e=>!!e.todoToken&&!!e.crmToken&&!!e.sessionId,isRootTokenValid:e=>{if(!e.rootToken||!e.rootLoginTime)return!1;return Date.now()-e.rootLoginTime<6048e5}},actions:{setAuthData(e){e.rootToken&&(this.rootToken=e.rootToken,uni.setStorageSync("vbot_root_token",e.rootToken),this.rootLoginTime=Date.now(),uni.setStorageSync("vbot_root_login_time",this.rootLoginTime)),e.sessionId&&(this.sessionId=e.sessionId,uni.setStorageSync("vbot_session_id",e.sessionId)),e.uid&&(this.uid=e.uid,uni.setStorageSync("vbot_uid",e.uid)),e.projectCode&&(this.projectCode=e.projectCode,uni.setStorageSync("vbot_project_code",e.projectCode)),e.todoToken&&(this.todoToken=e.todoToken,uni.setStorageSync("todo_access_token",e.todoToken)),e.crmToken&&(this.crmToken=e.crmToken,uni.setStorageSync("crm_access_token",e.crmToken))},async fetchModuleTokens(){try{this.isRootTokenValid||(a("log","at stores/auth.ts:66","Root Token hết hạn, login lại..."),await this.loginDevMode()),a("log","at stores/auth.ts:71","Store: Đang lấy Token cho Todo và CRM...");const[i,o]=await Promise.all([(e=this.rootToken,t=this.projectCode,n=this.uid,new Promise(((a,i)=>{uni.request({url:`${Ht}/token`,method:"GET",data:{projectCode:t,uid:n,type:Rt,source:It},header:{Authorization:`Bearer ${e}`},success:e=>{const t=e.data;t&&t.data&&t.data.token?a(t.data.token):i(t)},fail:e=>i(e)})}))),Gt(this.projectCode,this.uid)]);this.setAuthData({todoToken:i,crmToken:o}),a("log","at stores/auth.ts:83","Store: Đã lấy đủ Token (Todo & CRM).")}catch(i){throw a("error","at stores/auth.ts:85","Store: Lỗi lấy module tokens:",i),this.logout(),i}var e,t,n},async loginDevMode(){try{a("log","at stores/auth.ts:103","Store: Đang gọi API đăng nhập hệ thống...");const n=await(e="hoangtinvpm",t="ef797c8118f02dfb649607dd5d3f8c7623048c9c063d532cc95c5ed7a898a64f",new Promise(((a,n)=>{uni.request({url:"https://api-sandbox-h01.vbot.vn/v1.0/token",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{username:e,password:t,grant_type:"password",type_account:0,source:It},success:e=>{const t=e.data;200===e.statusCode&&t.access_token?a(t):n(t)},fail:e=>n(e)})})));this.setAuthData({rootToken:n.access_token,uid:"87d90802634146e29721476337bce64b",projectCode:"PR202511211001129372",sessionId:n.session_id})}catch(n){throw a("error","at stores/auth.ts:115","Store: Đăng nhập Dev thất bại",n),n}var e,t},async initialize(e){a("log","at stores/auth.ts:121","🚀 Store: Khởi tạo Auth..."),this.todoToken&&this.crmToken&&this.sessionId?a("log","at stores/auth.ts:124",">> Đã có đủ Token cũ. Ready!"):await this.exchangeForTodoToken()},async exchangeForTodoToken(){return this.refreshPromise?(a("log","at stores/auth.ts:132","🔄 Đang có tiến trình refresh token, vui lòng chờ..."),this.refreshPromise):(this.refreshPromise=this.fetchModuleTokens().finally((()=>{this.refreshPromise=null})),this.refreshPromise)},logout(){a("log","at stores/auth.ts:143","Store: Đăng xuất...");Xt().disconnect(),this.rootToken="",this.rootLoginTime=0,this.todoToken="",this.crmToken="",this.refreshPromise=null,this.sessionId="",uni.removeStorageSync("crm_access_token"),uni.removeStorageSync("todo_access_token"),uni.removeStorageSync("vbot_root_token"),uni.removeStorageSync("vbot_root_login_time"),uni.removeStorageSync("vbot_session_id")}}}),ea=async e=>{const t=Zt(),n=t.todoToken||t.rootToken,i={"Content-Type":"application/json",...e.header};return n&&(i.Authorization=`Bearer ${n}`),new Promise(((n,o)=>{uni.request({url:e.url,method:e.method||"GET",data:e.data||{},header:i,success:async i=>{const s=i.data;if(200!==i.statusCode)if(401!==i.statusCode)a("error","at utils/request.ts:66",`[API Error ${i.statusCode}]`,s),o(s);else{if(a("warn","at utils/request.ts:40",`API 401: Token hết hạn tại ${e.url}`),e._isRetry)return a("error","at utils/request.ts:43"," Refresh Token cũng thất bại -> Logout."),t.logout(),void o(s);try{await t.exchangeForTodoToken(),a("log","at utils/request.ts:51"," Đã Refresh Token -> Đang gọi lại API cũ...");const i=await ea({...e,_isRetry:!0});n(i)}catch(l){t.logout(),o(l)}}else n(s.data)},fail:e=>{a("error","at utils/request.ts:71","[Network Error]",e),o(e)}})}))},ta="TO_DO",aa="IN_PROGRESS",na="DONE",ia="OVERDUE",oa={TO_DO:"Chưa xử lý",IN_PROGRESS:"Đang xử lý",DONE:"Hoàn thành",OVERDUE:"Quá hạn"},sa={TO_DO:"bg-gray",IN_PROGRESS:"bg-orange",DONE:"bg-green",OVERDUE:"bg-red"},la={HISTORY_CALL_IN:"Cuộc gọi đến",HISTORY_CALL_OUT:"Cuộc gọi đi",HISTORY_MISS_CALL:"Cuộc gọi nhỡ",NEW_TICKET:"Tạo mới ticket",REOPEN_TICKET:"Mở lại ticket",NEW_SUB_TICKET:"Tạo ticket con",UPDATE_STATUS_TICKET:"Cập nhật trạng thái ticket",UPDATE_ASSIGNEE_TICKET:"Đổi người xử lý ticket",NEW_TODO:"Tạo mới công việc",REOPEN_TODO:"Mở lại công việc",UPDATE_STATUS_TODO:"Cập nhật trạng thái công việc",UPDATE_ASSIGNEE_TODO:"Đổi người thực hiện công việc",CUSTOMER_UPDATE:"Cập nhật thông tin khách hàng",NOTE_INSERT:"Thêm ghi chú",NOTE_UPDATE:"Sửa ghi chú",NOTE_DELETE:"Xóa ghi chú"},ra=e=>{if(!e||-1===e||0===e)return"";const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getFullYear(),o=t.getHours().toString().padStart(2,"0"),s=t.getMinutes().toString().padStart(2,"0");return t.getSeconds().toString().padStart(2,"0"),`${a}/${n}/${i} ${o}:${s}`},ca=(e,t,a,n,i)=>{const o=e.createdTo||e.createdFrom,s=e.dueDateTo||e.dueDateFrom,l=e.notifyTo||e.notifyFrom;return{keySearch:e.title||"",code:e.jobCode||"",status:t||"",startDate:x(e.createdFrom),endDate:x(o),dueDateFrom:x(e.dueDateFrom),dueDateTo:x(s),notificationReceivedAtFrom:x(e.notifyFrom),notificationReceivedAtTo:x(l),createdBy:n||"",assigneeId:i||"",customerCode:e.customerCode||"",links:a||"",groupId:"",transId:"",pluginType:""}},da=async e=>{const t=await ea({url:`${qt}/getAll`,method:"GET",data:{projectCode:Yt,pageNo:1,pageSize:15,...e}});return Array.isArray(t)?t.map((e=>(e=>{if(!e)return{};const t=e.status||ta,a=e.title||"Không tên";return{...e,title:a,statusClass:sa[t]||"bg-orange",statusLabel:oa[t]||t,avatarText:a.substring(0,2).toUpperCase(),createdAtFormatted:ra(e.createdAt),dueDateFormatted:ra(e.dueDate),notifyAtFormatted:ra(e.notificationReceivedAt)}})(e))):[]},ua=async e=>{const t=await ea({url:`${qt}/countAll`,method:"GET",data:{projectCode:Yt,...e}});return Number(t)||0},ma=e=>ea({url:`${qt}/update`,method:"POST",data:e}),ha=e=>ea({url:`${jt}/api/module-todo/todoMessages/create`,method:"POST",data:e}),pa=(e,t)=>ea({url:`${jt}/api/module-todo/todoMessages/getDetail`,method:"GET",data:{id:e,todoId:t}}),ga=e=>{const t=Zt();return new Promise(((a,n)=>{uni.uploadFile({url:`${jt}/api/module-todo/file/upload`,filePath:e,name:"file",header:{Authorization:`Bearer ${t.todoToken}`},success:e=>{try{const t=JSON.parse(e.data);200===t.status&&t.data?a(t.data):n(t.message||"Upload thất bại")}catch(t){n("Lỗi phân tích phản hồi từ server")}},fail:e=>{n(e)}})}))},fa=(e,t="success")=>{uni.$emit("app-toast-show",{message:e,type:t})},va=e=>fa(e,"success"),_a=e=>fa(e,"error"),ya=e=>fa(e,"info"),ka=()=>uni.hideLoading(),ba=()=>{const t=Zt(),n=e.ref([]),i=e.ref(!1),o=e.ref(!1),s=e.ref(1),l=e.ref({}),r=e.ref(!1),c=async(e={},c=!1)=>{if(c){if(r.value||o.value)return;o.value=!0,s.value+=1}else i.value=!0,s.value=1,r.value=!1,l.value=e;try{const a=t.crmToken;if(!a)return;const u=await(d=a,ea({url:`${Ht}/Customer/getAllFieldSearch`,method:"POST",data:{},header:{Authorization:`Bearer ${d}`}})),m=(e,t)=>{const a=u.find((t=>t.code===e));return a?a.id:t},h=m("create_at",-1),p=m("name",154),g=m("phone",155),f=m("member_no",156),v=c?l.value:e,_=(null==v?void 0:v.name)||"",y=(null==v?void 0:v.phone)||"",k=(null==v?void 0:v.managerUID)||"",b=V(null==v?void 0:v.startDate,null==v?void 0:v.endDate),w={page:s.value,size:15,fieldSearch:[{id:h,value:b,type:"RANGER",isSearch:!!b},{id:p,value:_,type:"CONTAIN",isSearch:!!_},{id:g,value:y,type:"CONTAIN",isSearch:!!y},{id:f,value:k,type:"EQUAL",isSearch:!!k}]},D=await((e,t)=>ea({url:`${Ht}/Customer/getAll`,method:"POST",data:t,header:{Authorization:`Bearer ${e}`}}))(a,w),S=D.map((e=>{const t=e.customerFieldItems.find((e=>"name"===e.code)),a=e.customerFieldItems.find((e=>"phone"===e.code)),n=e.customerFieldItems.find((e=>"member_no"===e.code));return{id:e.id,uid:e.uid,createAt:e.createAt,name:t?t.value:"(Không tên)",phone:a?a.value:"",code:e.code||"",managerUid:n?n.value:""}}));n.value=c?[...n.value,...S]:S,S.length<15&&(r.value=!0)}catch(u){a("error","at composables/useCustomerFilter.ts:94","Lỗi tải khách hàng:",u),_a("Lỗi tải dữ liệu CRM"),c||(n.value=[])}finally{i.value=!1,o.value=!1}var d};return{customerList:n,loadingCustomer:i,loadingMore:o,fetchCustomers:c,loadMoreCustomers:()=>{c(null,!0)}}},wa=()=>{const{t:t}=it(),n=e.ref([]),{pageNo:i,pageSize:s,totalCount:l,pageSizeOptions:r,resetPage:d,setTotal:u,changePage:m,changePageSize:h}=((t=15)=>{const a=e.ref(1),n=e.ref(t),i=e.ref(0),o=e.computed((()=>0===i.value?1:Math.ceil(i.value/n.value)));return{pageNo:a,pageSize:n,totalCount:i,pageSizeOptions:[5,10,15,20],totalPages:o,resetPage:()=>{a.value=1},setTotal:e=>{i.value=e},changePage:e=>{const t=a.value+e;return t>=1&&t<=o.value&&(a.value=t,!0)},changePageSize:e=>{n.value=e,a.value=1}}})(15),p=e.ref(!1),g=e.ref(!1);Zt();const f=e.ref(!1),v=e.ref(""),_=e.ref(!1),y=e.ref(null),k=e.computed((()=>[t("common.all"),t("todo.status_todo"),t("todo.status_progress"),t("todo.status_done"),t("todo.status_overdue")])),b=["",ta,aa,na,ia],w=e.ref(0),D=e.ref([]),S=e.computed((()=>{const e=D.value.map((e=>e.UserName||t("common.hidden_member")));return[t("common.all"),...e]})),C=e.ref(0),N=e.computed((()=>{const e=D.value.map((e=>e.UserName||"Thành viên ẩn"));return[t("common.all"),...e]})),T=e.ref(0),E=e.computed((()=>[t("common.all"),t("source.call"),t("source.customer"),t("source.conversation"),t("source.message")])),x=["",Vt,$t,Bt,Mt],V=e.ref(0),$=e.ref({title:"",jobCode:"",createdFrom:"",createdTo:"",dueDateFrom:"",dueDateTo:"",customerCode:"",notifyFrom:"",notifyTo:""}),B=async()=>{if(!(D.value.length>0))try{const e=await Kt();D.value=e}catch(e){a("error","at controllers/list_todo.ts:78","Lỗi lấy danh sách thành viên filter:",e)}},{customerList:M,loadingCustomer:I,loadingMore:R,fetchCustomers:O,loadMoreCustomers:F}=ba(),A=async()=>{0===n.value.length&&(p.value=!0);try{let e="";if(C.value>0){e=D.value[C.value-1].UID||""}let t="";if(T.value>0){t=D.value[T.value-1].UID||""}const a=ca($.value,b[w.value],x[V.value],e,t),[o,l]=await Promise.all([da({...a,pageNo:i.value,pageSize:s.value}),ua(a)]);n.value=o||[],u(l||0)}catch(e){a("error","at controllers/list_todo.ts:210",e),_a(t("common.error_load")),0===n.value.length&&(n.value=[])}finally{p.value=!1,uni.stopPullDownRefresh()}};c((()=>{a("log","at controllers/list_todo.ts:221","Đang làm mới trang..."),d(),Promise.all([A(),O({})]).finally((()=>{uni.stopPullDownRefresh()}))}));const L=()=>{g.value=!1};o((()=>{A(),O({})}));return{todos:n,isLoading:p,isFilterOpen:g,filter:$,goToDetail:e=>{uni.navigateTo({url:`/pages/todo/todo_detail?id=${e.id}`})},isConfirmDeleteOpen:_,itemToDelete:y,pageSizeOptions:r,statusOptions:k,statusIndex:w,onStatusChange:e=>{w.value=e.detail.value},creatorOptions:S,creatorIndex:C,onCreatorChange:e=>{C.value=e.detail.value},assigneeOptions:N,assigneeIndex:T,onAssigneeChange:e=>{T.value=e.detail.value},sourceOptions:E,sourceIndex:V,onSourceChange:e=>{V.value=e.detail.value},addNewTask:()=>{uni.navigateTo({url:"/pages/todo/create_todo"})},openFilter:()=>{g.value=!0,B()},closeFilter:L,resetFilter:()=>{$.value={title:"",jobCode:"",createdFrom:"",createdTo:"",dueDateFrom:"",dueDateTo:"",customerCode:"",notifyFrom:"",notifyTo:""},w.value=0,C.value=0,T.value=0,V.value=0,v.value="",d(),A(),L()},applyFilter:()=>{d(),(async()=>{0===n.value.length&&(p.value=!0);try{$.value,i.value,s.value;let e="";C.value>0&&(e=D.value[C.value-1].memberUID||"");let t="";T.value>0&&(t=D.value[T.value-1].memberUID||"");const a=ca($.value,b[w.value],x[V.value],e,t),[o,l]=await Promise.all([da({...a,pageNo:i.value,pageSize:s.value}),ua(a)]);n.value=o||[],u(l||0)}catch(e){a("error","at controllers/list_todo.ts:132",e),_a("Lỗi tải dữ liệu")}finally{p.value=!1}})(),L()},showActionMenu:e=>{uni.showActionSheet({itemList:[t("common.delete")],itemColor:"#ff3b30",success:t=>{0===t.tapIndex&&(e=>{y.value=e,_.value=!0})(e)}})},cancelDelete:()=>{_.value=!1,y.value=null},confirmDelete:async()=>{var e;if(y.value)try{await(e=y.value.id,ea({url:`${qt}/delete`,method:"POST",data:{id:e}})),va(t("common.success_delete")),_.value=!1,y.value=null,A()}catch(n){a("error","at controllers/list_todo.ts:239","Delete Error:",n),_a(t("common.fail_delete"))}},showCustomerModal:f,loadingCustomer:I,customerList:M,selectedCustomerName:v,openCustomerPopup:()=>{f.value=!0,B(),0===M.value.length&&O({})},onCustomerSelect:e=>{$.value.customerCode=e.uid,v.value=e.name,f.value=!1},onFilterCustomerInModal:e=>{O(e)},pageNo:i,pageSize:s,totalCount:l,onChangePage:e=>{m(e)&&A()},onUpdatePageSize:e=>{h(e),A()},rawMemberList:D,fetchCustomers:O,loadingMore:R,loadMoreCustomers:F}},Da=d(e.defineComponent({__name:"StatusBadge",props:{status:{}},setup(t){const{t:a}=it(),n=t,i=e.computed((()=>{switch(n.status){case ta:return a("todo.status_todo");case aa:return a("todo.status_progress");case na:return a("todo.status_done");case ia:return a("todo.status_overdue");default:return n.status||"Unknown"}})),o=e.computed((()=>{switch(n.status){case ta:return"bg-gray-200 text-gray-600";case aa:return"bg-orange-100 text-orange-600";case na:return"bg-green-100 text-green-600";case ia:return"bg-red-100 text-red-600";default:return"bg-gray-100 text-gray-400"}})),s=e.computed((()=>{switch(n.status){case ta:return{backgroundColor:"#e4e4e7",color:"#52525b"};case aa:return{backgroundColor:"#ffedd5",color:"#c2410c"};case na:return{backgroundColor:"#dcfce7",color:"#15803d"};case ia:return{backgroundColor:"#fee2e2",color:"#dc2626"};default:return{backgroundColor:"#f4f4f5",color:"#a1a1aa"}}}));return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["px-2 py-1 rounded-full text-xs font-bold inline-block text-center min-w-[80px]",o.value]),style:e.normalizeStyle(s.value)},e.toDisplayString(i.value),7))}}),[["__scopeId","data-v-0cc8f96d"]]),Sa=d(e.defineComponent({__name:"AppButton",props:{label:{default:""},type:{default:"primary"},size:{default:"normal"},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["click"],setup(t,{emit:a}){const n=t,i=a,o=e=>{n.disabled||n.loading||i("click",e)};return(t,a)=>(e.openBlock(),e.createElementBlock("button",{class:e.normalizeClass(["app-btn",[`btn-${t.type}`,"small"===t.size?"btn-sm":"",{"is-disabled":t.disabled||t.loading}]]),disabled:t.disabled||t.loading,onClick:o,"hover-class":"btn-hover"},[t.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-spinner"})):e.createCommentVNode("",!0),e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("text",{class:"btn-text"},e.toDisplayString(t.label),1)]),!0)],10,["disabled"]))}}),[["__scopeId","data-v-6cb06cb3"]]),Ca=d(e.defineComponent({__name:"GlobalMessage",setup(t){const a=e.ref(!1),n=e.ref(""),i=e.ref("success"),o=e.ref(0);let s=null;const l={success:"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22%23047857%22%3E%3Cpath%20d%3D%22M12%202C6.48%202%202%206.48%202%2012s4.48%2010%2010%2010%2010-4.48%2010-10S17.52%202%2012%202zm-2%2015l-5-5%201.41-1.41L10%2014.17l7.59-7.59L19%208l-9%209z%22%2F%3E%3C%2Fsvg%3E",error:"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22%23b91c1c%22%3E%3Cpath%20d%3D%22M12%202C6.47%202%202%206.47%202%2012s4.47%2010%2010%2010%2010-4.47%2010-10S17.53%202%2012%202zm5%2013.59L15.59%2017%2012%2013.41%208.41%2017%207%2015.59%2010.59%2012%207%208.41%208.41%207%2012%2010.59%2015.59%207%2017%208.41%2013.41%2012%2017%2015.59z%22%2F%3E%3C%2Fsvg%3E",info:"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22%231d4ed8%22%3E%3Cpath%20d%3D%22M12%202C6.48%202%202%206.48%202%2012s4.48%2010%2010%2010%2010-4.48%2010-10S17.52%202%2012%202zm1%2015h-2v-6h2v6zm0-8h-2V7h2v2z%22%2F%3E%3C%2Fsvg%3E",warning:"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22%23b45309%22%3E%3Cpath%20d%3D%22M1%2021h22L12%202%201%2021zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z%22%2F%3E%3C%2Fsvg%3E"},r=e.computed((()=>l[i.value]||l.info)),c=e=>{s&&(clearTimeout(s),a.value=!1),n.value=e.message,i.value=e.type||"success",setTimeout((()=>{a.value=!0}),50),s=setTimeout((()=>{a.value=!1}),3e3)};return e.onMounted((()=>{var e;const t=uni.getSystemInfoSync();o.value=(null==(e=t.safeAreaInsets)?void 0:e.bottom)||0,uni.$on("app-toast-show",c),uni.onNetworkStatusChange((e=>{e.isConnected?c({message:"Đã khôi phục kết nối.",type:"success"}):c({message:"Mất kết nối Internet.",type:"error"})}))})),uni.getNetworkType({success:e=>{"none"===e.networkType&&c({message:"Không có kết nối Internet.",type:"error"})}}),e.onUnmounted((()=>{uni.$off("app-toast-show",c)})),(t,s)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["global-message-container",{show:a.value}]),style:e.normalizeStyle({paddingBottom:o.value+20+"px"})},[e.createElementVNode("view",{class:e.normalizeClass(["message-content",i.value])},[e.createElementVNode("image",{src:r.value,class:"msg-icon",mode:"aspectFit"},null,8,["src"]),e.createElementVNode("text",{class:"msg-text"},e.toDisplayString(n.value),1)],2)],6))}}),[["__scopeId","data-v-84336ad2"]]),Na=d(e.defineComponent({__name:"ConfirmModal",props:{visible:{type:Boolean},title:{default:"Thông báo"},message:{default:""},cancelLabel:{default:"Hủy"},confirmLabel:{default:"Xác nhận"},confirmType:{default:"primary"}},emits:["update:visible","confirm","cancel"],setup(t,{emit:a}){const n=a,i=()=>{n("update:visible",!1),n("cancel")},o=()=>{n("confirm")};return(t,a)=>t.visible?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-overlay",onClick:i},[e.createElementVNode("view",{class:"modal-container",onClick:a[0]||(a[0]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(t.title),1)]),e.createElementVNode("view",{class:"modal-body"},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("text",null,e.toDisplayString(t.message),1)]),!0)]),e.createElementVNode("view",{class:"modal-footer"},[e.createVNode(Sa,{type:"secondary",label:t.cancelLabel,class:"flex-1",onClick:i},null,8,["label"]),e.createVNode(Sa,{type:t.confirmType,label:t.confirmLabel,class:"flex-1",onClick:o},null,8,["type","label"])])])])):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-9791cb6f"]]),Ta=d(e.defineComponent({__name:"Pagination",props:{pageNo:{},pageSize:{},total:{},pageSizeOptions:{},showTotal:{type:Boolean}},emits:["changePage","update:pageSize"],setup(t,{emit:a}){const n=t,i=a,o=e.computed((()=>n.pageSize&&0!==n.pageSize&&Math.ceil(n.total/n.pageSize)||1)),s=e.computed((()=>{if(!n.pageSizeOptions)return 0;const e=n.pageSizeOptions.indexOf(n.pageSize);return-1!==e?e:0})),l=e=>{const t=e.detail.value;if(n.pageSizeOptions&&n.pageSizeOptions[t]){const e=n.pageSizeOptions[t];i("update:pageSize",e)}},r=()=>{n.pageNo>1&&i("changePage",-1)},c=()=>{n.pageNo<o.value&&i("changePage",1)};return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"pagination-footer"},[e.createElementVNode("picker",{mode:"selector",range:t.pageSizeOptions,value:s.value,onChange:l},[e.createElementVNode("view",{class:"page-size-selector"},[e.createElementVNode("text",{class:"size-text"},e.toDisplayString(t.pageSize)+" / "+e.toDisplayString(t.$t("common.page_unit")),1),e.createElementVNode("text",{class:"dropdown-arrow"},"▼")])],40,["range","value"]),t.showTotal?(e.openBlock(),e.createElementBlock("text",{key:0,class:"total-text"},e.toDisplayString(t.$t("common.total"))+": "+e.toDisplayString(t.total),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"pagination-controls"},[e.createElementVNode("view",{class:e.normalizeClass(["page-arrow",{disabled:t.pageNo<=1}]),onClick:r},"‹",2),e.createElementVNode("view",{class:"page-box active"},e.toDisplayString(t.pageNo),1),e.createElementVNode("view",{class:e.normalizeClass(["page-arrow",{disabled:t.pageNo>=o.value}]),onClick:c},"›",2)]),t.$slots.action?(e.openBlock(),e.createElementBlock("view",{key:1,class:"add-btn-wrapper"},[e.renderSlot(t.$slots,"action",{},void 0,!0)])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-effb6142"]]),Ea=d(e.defineComponent({__name:"GlobalNotification",setup(t){const n=Jt(),i=e.ref(0);uni.getSystemInfo({success:e=>{i.value=(e.statusBarHeight||0)+10}});const o=e.computed((()=>`<div style="font-size: 14px; line-height: 1.4; color: #333;">${n.message}</div>`)),s=()=>{n.hide()},l=()=>{a("log","at components/GlobalNotification.vue:41","Click vào thông báo"),s()};return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["notification-wrapper",{show:e.unref(n).visible}]),style:e.normalizeStyle({paddingTop:i.value+"px"})},[e.createElementVNode("view",{class:e.normalizeClass(["notification-card",e.unref(n).type]),onClick:l},[e.createElementVNode("view",{class:"icon-box"},["success"===e.unref(n).type?(e.openBlock(),e.createElementBlock("text",{key:0,class:"icon"},"✅")):"warning"===e.unref(n).type?(e.openBlock(),e.createElementBlock("text",{key:1,class:"icon"},"⚠️")):"error"===e.unref(n).type?(e.openBlock(),e.createElementBlock("text",{key:2,class:"icon"},"⛔")):(e.openBlock(),e.createElementBlock("text",{key:3,class:"icon"},"🔔"))]),e.createElementVNode("view",{class:"content-box"},[e.createElementVNode("rich-text",{nodes:o.value},null,8,["nodes"])]),e.createElementVNode("view",{class:"close-btn",onClick:e.withModifiers(s,["stop"])},"✕")],2)],6))}}),[["__scopeId","data-v-ca6f406b"]]),xa=d(e.defineComponent({__name:"list_todo",setup(a){const{todos:n,isLoading:i,isFilterOpen:o,filter:s,isConfirmDeleteOpen:l,itemToDelete:r,pageSizeOptions:c,pageSizeIndex:d,currentPage:u,totalPages:m,onPageSizeChange:h,changePage:p,statusOptions:g,statusIndex:f,onStatusChange:v,creatorOptions:_,creatorIndex:y,onCreatorChange:k,customerOptions:b,customerIndex:w,onCustomerChange:D,assigneeOptions:S,assigneeIndex:C,onAssigneeChange:N,sourceOptions:T,sourceIndex:E,onSourceChange:x,addNewTask:V,openFilter:$,closeFilter:B,resetFilter:M,applyFilter:I,showActionMenu:R,cancelDelete:O,confirmDelete:F,goToDetail:A,showCustomerModal:L,loadingCustomer:P,customerList:z,selectedCustomerName:U,openCustomerPopup:j,onCustomerSelect:H,onFilterCustomerInModal:W,pageNo:q,pageSize:Y,totalCount:G,onChangePage:K,onUpdatePageSize:J,rawMemberList:Q,loadingMore:X,loadMoreCustomers:Z}=wa(),ee=e.ref(!1),te=e.ref(null);return(a,d)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"header-left"}),e.createElementVNode("text",{class:"header-title"},e.toDisplayString(a.$t("todo.page_title")),1),e.createElementVNode("view",{class:"header-right",onClick:d[0]||(d[0]=(...t)=>e.unref($)&&e.unref($)(...t))},[e.createElementVNode("image",{src:t,class:"filter-icon"})])]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"list-container"},[e.unref(i)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-state"},[e.createElementVNode("text",null,e.toDisplayString(a.$t("common.loading")),1)])):0===e.unref(n).length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("image",{src:"/static/empty-box.png",mode:"aspectFit",class:"empty-icon"}),e.createElementVNode("text",{class:"empty-text"},e.toDisplayString(a.$t("common.no_data")),1)])):(e.openBlock(),e.createElementBlock("scroll-view",{key:2,"scroll-y":"true",class:"list-view"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:t.id||n,class:"card-item",onClick:a=>e.unref(A)(t)},[e.createElementVNode("view",{class:e.normalizeClass(["status-bar",t.statusClass])},null,2),e.createElementVNode("view",{class:"card-body"},[e.createElementVNode("view",{class:"card-row top-row"},[e.createElementVNode("text",{class:"card-title"},e.toDisplayString(t.title),1),e.createElementVNode("view",{class:"action-btn",onClick:e.withModifiers((e=>(e=>{te.value=e,ee.value=!0})(t)),["stop"])},[e.createElementVNode("text",{class:"dots"},"•••")],8,["onClick"])]),e.createElementVNode("view",{class:"card-info-row"},[e.createElementVNode("image",{src:"/static/create-time.png",class:"icon-small"}),e.createElementVNode("text",{class:"card-date"},e.toDisplayString(a.$t("todo.created_at"))+": "+e.toDisplayString(t.createdAtFormatted),1)]),t.dueDateFormatted?(e.openBlock(),e.createElementBlock("view",{key:0,class:"card-info-row"},[e.createElementVNode("image",{src:"/static/due-time.png",class:"icon-small"}),e.createElementVNode("text",{class:"card-date text-danger"},e.toDisplayString(a.$t("todo.expired_at"))+": "+e.toDisplayString(t.dueDateFormatted),1)])):e.createCommentVNode("",!0),t.notifyAtFormatted?(e.openBlock(),e.createElementBlock("view",{key:1,class:"card-info-row"},[e.createElementVNode("image",{src:"/static/notify-time.png",class:"icon-small"}),e.createElementVNode("text",{class:"card-date text-primary"},e.toDisplayString(a.$t("todo.notify_at"))+": "+e.toDisplayString(t.notifyAtFormatted),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"card-row bot-row"},[e.createElementVNode("view",{class:"code-tag"},"#"+e.toDisplayString(t.code),1),e.createVNode(Da,{status:t.status},null,8,["status"])])])],8,["onClick"])))),128)),e.createElementVNode("view",{style:{height:"20px"}})]))]),e.createVNode(Ta,{pageNo:e.unref(q),pageSize:e.unref(Y),total:e.unref(G),pageSizeOptions:e.unref(c),onChangePage:e.unref(K),"onUpdate:pageSize":e.unref(J)},{action:e.withCtx((()=>[e.createElementVNode("view",{class:"add-task-simple",onClick:d[1]||(d[1]=(...t)=>e.unref(V)&&e.unref(V)(...t))},[e.createElementVNode("text",{class:"plus-icon"},"+"),e.createElementVNode("text",{class:"add-text"},e.toDisplayString(a.$t("todo.add_task")),1)])])),_:1},8,["pageNo","pageSize","total","pageSizeOptions","onChangePage","onUpdate:pageSize"])]),e.unref(o)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"filter-overlay",onClick:d[17]||(d[17]=e.withModifiers(((...t)=>e.unref(B)&&e.unref(B)(...t)),["stop"]))},[e.createElementVNode("view",{class:"filter-panel",onClick:d[16]||(d[16]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"filter-header"},[e.createElementVNode("text",{class:"filter-title"},e.toDisplayString(a.$t("todo.filter_title")),1),e.createElementVNode("text",{class:"close-btn",onClick:d[2]||(d[2]=(...t)=>e.unref(B)&&e.unref(B)(...t))},"✕")]),e.createElementVNode("scroll-view",{"scroll-y":"true",class:"filter-body"},[e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(a.$t("todo.search_label")),1),e.withDirectives(e.createElementVNode("input",{class:"f-input","onUpdate:modelValue":d[3]||(d[3]=t=>e.unref(s).title=t),placeholder:a.$t("todo.search_placeholder")},null,8,["placeholder"]),[[e.vModelText,e.unref(s).title]])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(a.$t("todo.code_prefix")),1),e.withDirectives(e.createElementVNode("input",{class:"f-input","onUpdate:modelValue":d[4]||(d[4]=t=>e.unref(s).jobCode=t),placeholder:a.$t("todo.job_code_placeholder")},null,8,["placeholder"]),[[e.vModelText,e.unref(s).jobCode]])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(a.$t("todo.status")),1),e.createElementVNode("picker",{mode:"selector",range:e.unref(g),value:e.unref(f),onChange:d[5]||(d[5]=(...t)=>e.unref(v)&&e.unref(v)(...t))},[e.createElementVNode("view",{class:"f-picker"},[e.createTextVNode(e.toDisplayString(e.unref(g)[e.unref(f)]),1),e.createElementVNode("text",{class:"arrow"},"▼")])],40,["range","value"])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(a.$t("todo.creator")),1),e.createElementVNode("picker",{mode:"selector",range:e.unref(_),value:e.unref(y),onChange:d[6]||(d[6]=(...t)=>e.unref(k)&&e.unref(k)(...t))},[e.createElementVNode("view",{class:"f-picker"},[e.createTextVNode(e.toDisplayString(e.unref(_)[e.unref(y)]),1),e.createElementVNode("text",{class:"arrow"},"▼")])],40,["range","value"])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(a.$t("todo.customer")),1),e.createElementVNode("view",{class:"f-input",onClick:d[7]||(d[7]=(...t)=>e.unref(j)&&e.unref(j)(...t)),style:{"justify-content":"space-between"}},[e.createElementVNode("text",{style:e.normalizeStyle({color:e.unref(U)?"#333":"#999"})},e.toDisplayString(e.unref(U)||a.$t("todo.select_customer")),5),e.createElementVNode("text",{class:"arrow"},"›")])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(a.$t("todo.assignee")),1),e.createElementVNode("picker",{mode:"selector",range:e.unref(S),value:e.unref(C),onChange:d[8]||(d[8]=(...t)=>e.unref(N)&&e.unref(N)(...t))},[e.createElementVNode("view",{class:"f-picker"},[e.createTextVNode(e.toDisplayString(e.unref(S)[e.unref(C)]),1),e.createElementVNode("text",{class:"arrow"},"▼")])],40,["range","value"])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(a.$t("todo.source")),1),e.createElementVNode("picker",{mode:"selector",range:e.unref(T),value:e.unref(E),onChange:d[9]||(d[9]=(...t)=>e.unref(x)&&e.unref(x)(...t))},[e.createElementVNode("view",{class:"f-picker"},[e.createTextVNode(e.toDisplayString(e.unref(T)[e.unref(E)]),1),e.createElementVNode("text",{class:"arrow"},"▼")])],40,["range","value"])]),e.createVNode(lt,{title:a.$t("todo.time_create"),startDate:e.unref(s).createdFrom,"onUpdate:startDate":d[10]||(d[10]=t=>e.unref(s).createdFrom=t),endDate:e.unref(s).createdTo,"onUpdate:endDate":d[11]||(d[11]=t=>e.unref(s).createdTo=t)},null,8,["title","startDate","endDate"]),e.createVNode(lt,{title:a.$t("todo.time_expired"),startDate:e.unref(s).dueDateFrom,"onUpdate:startDate":d[12]||(d[12]=t=>e.unref(s).dueDateFrom=t),endDate:e.unref(s).dueDateTo,"onUpdate:endDate":d[13]||(d[13]=t=>e.unref(s).dueDateTo=t)},null,8,["title","startDate","endDate"]),e.createVNode(lt,{title:a.$t("todo.time_notify"),startDate:e.unref(s).notifyFrom,"onUpdate:startDate":d[14]||(d[14]=t=>e.unref(s).notifyFrom=t),endDate:e.unref(s).notifyTo,"onUpdate:endDate":d[15]||(d[15]=t=>e.unref(s).notifyTo=t)},null,8,["title","startDate","endDate"]),e.createElementVNode("view",{style:{height:"20px"}})]),e.createElementVNode("view",{class:"filter-footer"},[e.createVNode(Sa,{type:"secondary",label:a.$t("common.reset"),class:"btn-filter-reset",onClick:e.unref(M)},null,8,["label","onClick"]),e.createVNode(Sa,{type:"primary",label:a.$t("common.apply"),class:"btn-filter-apply",onClick:e.unref(I)},null,8,["label","onClick"])])])])):e.createCommentVNode("",!0),e.createVNode(rt,{visible:e.unref(L),loading:e.unref(P),loadingMore:e.unref(X),customers:e.unref(z),managers:e.unref(Q),onClose:d[18]||(d[18]=e=>L.value=!1),onSelect:e.unref(H),onFilter:e.unref(W),onLoadMore:e.unref(Z)},null,8,["visible","loading","loadingMore","customers","managers","onSelect","onFilter","onLoadMore"]),e.createVNode(Na,{visible:e.unref(l),"onUpdate:visible":d[19]||(d[19]=t=>e.isRef(l)?l.value=t:null),title:a.$t("common.notification"),message:e.unref(r)?a.$t("todo.confirm_delete_msg").replace("{title}",e.unref(r).title):"","confirm-type":"danger","cancel-label":a.$t("common.cancel"),"confirm-label":a.$t("common.delete"),onConfirm:e.unref(F),onCancel:e.unref(O)},null,8,["visible","title","message","cancel-label","confirm-label","onConfirm","onCancel"]),e.createElementVNode("view",{class:e.normalizeClass(["custom-sheet-mask",{show:ee.value}]),onClick:d[23]||(d[23]=e=>ee.value=!1)},[e.createElementVNode("view",{class:"custom-sheet-panel",onClick:d[22]||(d[22]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"sheet-item delete",onClick:d[20]||(d[20]=e=>{return t="delete",ee.value=!1,void("delete"===t&&(r.value=te.value,l.value=!0));var t})},[e.createElementVNode("text",null,e.toDisplayString(a.$t("common.delete")),1)]),e.createElementVNode("view",{class:"sheet-gap"}),e.createElementVNode("view",{class:"sheet-item cancel",onClick:d[21]||(d[21]=e=>ee.value=!1)},[e.createElementVNode("text",null,e.toDisplayString(a.$t("common.cancel")),1)])])],2),e.createVNode(Ca),e.createVNode(Ea)]))}}),[["__scopeId","data-v-785adb08"]]),Va=e=>{if(!e)return 0;const t=e.replace(/-/g,"/"),a=new Date(t);return isNaN(a.getTime())?0:a.getTime()},$a=()=>{const{t:t}=it();Zt();const n=e=>e.toString().padStart(2,"0"),{customerList:i,loadingCustomer:o,loadingMore:s,fetchCustomers:l,loadMoreCustomers:r}=ba(),c=e.ref(!1),d=e.ref({name:"",desc:"",customer:"",customerUid:"",assignee:"",dueDate:"",notifyAt:""});e.watch((()=>d.value.dueDate),(e=>{})),e.watch((()=>d.value.notifyAt),(e=>{}));const u=e.computed((()=>[t("source.call"),t("source.customer"),t("source.conversation")])),m=[Vt,$t,Bt],h=e.ref(-1),p=e.ref([]),g=e.ref([]),f=e.ref(-1),v=e.ref(!1);e.ref("");const _=e.computed((()=>f.value>-1&&g.value.length>0?g.value[f.value]:""));return e.onMounted((()=>{(async()=>{try{const e=await Kt();p.value=e,g.value=e.map((e=>e.UserName||"Thành viên ẩn danh"))}catch(e){a("error","at controllers/create_todo.ts:87","Lỗi lấy thành viên:",e),_a("Không thể tải danh sách thành viên")}})(),l({}),setTimeout((()=>{const e=(()=>{const e=new Date;return`${e.getFullYear()}-${n(e.getMonth()+1)}-${n(e.getDate())} ${n(e.getHours())}:${n(e.getMinutes())}:00`})();d.value.dueDate=e,d.value.notifyAt=e}),100)})),{loading:c,form:d,memberOptions:g,onMemberChange:e=>{const t=e.detail.value;f.value=t;const a=p.value[t];a&&(d.value.assignee=a.memberUID)},currentAssigneeName:_,showCustomerModal:v,loadingCustomer:o,customerList:i,openCustomerPopup:()=>{v.value=!0,0===i.value.length&&l({})},onCustomerSelect:e=>{if(d.value.customer=`${e.name} - ${e.phone}`,d.value.customerUid=e.uid,e.managerUid){const t=p.value.findIndex((t=>t.memberUID===e.managerUid));-1!==t&&(f.value=t,d.value.assignee=e.managerUid,a("log","at controllers/create_todo.ts:111",`Đã tự động chọn quản lý: ${p.value[t].UserName}`))}v.value=!1},goBack:()=>uni.navigateBack(),submitForm:async()=>{if(!d.value.name||!d.value.name.trim())return void ya(t("todo.validate_name"));if(!B(d.value.dueDate,d.value.notifyAt))return void _a("Ngày thông báo không được trễ hơn hoặc trùng Hạn xử lý!");let e="CALL";h.value>=0&&(e=m[h.value]),c.value=!0,((e="Đang xử lý...")=>{uni.showLoading({title:e,mask:!0})})(t("todo.upload_processing"));try{const{newContent:i,fileUrls:o}=await(async e=>{if(!e)return{newContent:"",fileUrls:[]};const t=/<img[^>]+src="([^">]+)"/g;let n;const i=[],o=[],s=[];for(;null!==(n=t.exec(e));){const e=n[1];if(!e.startsWith("http")&&!e.startsWith("https")){const t=ga(e).then((t=>{o.push({oldSrc:e,newSrc:t}),s.push(t)})).catch((t=>{a("error","at controllers/create_todo.ts:153",`Upload ảnh ${e} lỗi:`,t)}));i.push(t)}}i.length>0&&await Promise.all(i);let l=e;return o.forEach((e=>{l=l.split(e.oldSrc).join(e.newSrc)})),{newContent:l,fileUrls:s}})(d.value.desc);d.value.desc=i;const s=((e,t)=>(a("log","at models/create_todo.ts:16","Check date values:",{dueDate:e.dueDate,notifyAt:e.notifyAt}),{title:e.name,description:e.desc||Ot,projectCode:t.projectCode,createdBy:t.uid,status:ta,links:t.link||Vt,pluginType:Ft,customerCode:e.customerUid||zt,assigneeId:e.assignee||Pt,groupId:At,transId:Lt,tagCodes:"test1",groupMemberUid:"test1",files:t.uploadedFiles||Ot,phone:Ut,dueDate:Va(e.dueDate),notificationReceivedAt:Va(e.notifyAt)}))(d.value,{projectCode:Yt,uid:"87d90802634146e29721476337bce64b",link:e,uploadedFiles:o.length>0?o[0]:""});a("log","at controllers/create_todo.ts:200","Payload Submit:",s),await(n=s,ea({url:`${qt}/create`,method:"POST",data:n})),ka(),va(t("todo.create_success")),setTimeout((()=>{uni.navigateBack()}),1500)}catch(i){ka(),a("error","at controllers/create_todo.ts:209","Create Error:",i);const e=(null==i?void 0:i.message)||("string"==typeof i?i:"Thất bại");_a(t("common.error_load")+": "+e)}finally{c.value=!1}var n},sourceOptions:u,sourceIndex:h,onSourceChange:e=>{h.value=parseInt(e.detail.value)},memberList:p,onCustomerFilter:e=>{l(e)},loadingMore:s,loadMoreCustomers:r}},Ba="/static/link.png",Ma=e=>{if(!e)return"";let t=e.trim();/^https?:\/\//i.test(t)||(t="http://"+t);try{return new URL(t).hostname}catch(a){const e=t.match(/^(?:https?:\/\/)?(?:www\.)?([^:\/\n?]+)/im);return e?e[1]:""}},Ia=e=>{if(!e)return{cleanHtml:"",links:[]};const t=[];return{cleanHtml:e.replace(/<iframe[^>]+src="([^">]+)"[^>]*><\/iframe>/g,((e,a)=>(a&&t.push(a),""))),links:t}},Ra=(e,t)=>{let a=e;return t.forEach((e=>{a+=`<iframe class="ql-video" frameborder="0" allowfullscreen="true" src="${e}"></iframe>`})),a},Oa=e=>{if(!e)return;let t=e.trim();t.startsWith("http")||(t="https://"+t),plus.runtime.openURL(t)},Fa=d(e.defineComponent({__name:"LinkCard",props:{url:{type:String,required:!0,default:""},removable:{type:Boolean,default:!1}},emits:["remove"],setup(t,{emit:a}){const n=t,i=e.ref(!1),o=e.computed((()=>(e=>{let t=Ma(e);if(!t)return"Liên kết ngoài";try{t=t.replace(/^www\./,"");const e=t.split(".");let a=e[0];if(e.length>2){const t=e[e.length-1],n=e[e.length-2];2===t.length&&["com","net","org","gov","edu"].includes(n)?e.length>=3&&(a=e[e.length-3]):a=e[e.length-2]}else 2===e.length&&(a=e[0]);return a.charAt(0).toUpperCase()+a.slice(1)}catch(a){return t||"Liên kết ngoài"}})(n.url))),s=e.computed((()=>(e=>{const t=Ma(e);return t?`https://www.google.com/s2/favicons?domain=${t}&sz=64`:""})(n.url)));e.watch((()=>n.url),(()=>{i.value=!1}));const l=e=>{i.value=!0},r=()=>{Oa(n.url)};return(a,n)=>t.url?(e.openBlock(),e.createElementBlock("view",{key:0,class:"link-card",onClick:e.withModifiers(r,["stop"])},[e.createElementVNode("view",{class:"link-card-icon"},[!i.value&&s.value?(e.openBlock(),e.createElementBlock("image",{key:0,src:s.value,class:"card-icon-img",mode:"aspectFit",onError:l},null,40,["src"])):(e.openBlock(),e.createElementBlock("image",{key:1,src:"https://img.icons8.com/ios-filled/50/007aff/internet.png",class:"card-icon-img"}))]),e.createElementVNode("view",{class:"link-card-content"},[e.createElementVNode("text",{class:"link-domain"},e.toDisplayString(o.value),1),e.createElementVNode("text",{class:"link-url"},e.toDisplayString(t.url),1)]),t.removable?(e.openBlock(),e.createElementBlock("view",{key:0,class:"link-card-remove",onClick:n[0]||(n[0]=e.withModifiers((e=>a.$emit("remove")),["stop"]))},[e.createElementVNode("text",{class:"remove-btn"},"✕")])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-434296be"]]),Aa=d(e.defineComponent({__name:"TodoEditor",props:{modelValue:String,placeholder:{type:String,default:""}},emits:["update:modelValue"],setup(t,{emit:a}){const{t:n}=it(),i=t,o=a,s=[{name:"header",iconText:"H",style:"font-weight:bold",action:"header-menu"},{name:"fontSize",iconText:"A",style:"font-weight:bold; font-size:16px",action:"fontsize-menu"},{name:"bold",iconText:"B",style:"font-weight:900"},{name:"italic",iconText:"I",style:"font-style:italic"},{name:"underline",iconText:"U",style:"text-decoration:underline"},{name:"color",iconImg:"/static/text_color.png",action:"color-picker"},{name:"backgroundColor",iconImg:"/static/background_color.png",action:"bgcolor-picker"},{name:"strike",iconText:"S",style:"text-decoration:line-through"},{name:"align",iconImg:"/static/align-left.png",action:"align-menu"},{name:"list",value:"ordered",iconImg:"/static/numbered-list.png"},{name:"list",value:"bullet",iconImg:"/static/list.png"}],l=["#000000","#333333","#888888","#aaaaaa","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#880088","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5"],r=e.ref(`editor-${Math.random().toString(36).substr(2,5)}`),c=e.ref(null),d=e.ref({}),u=e.getCurrentInstance(),m=e.ref(!1),h=e.ref(""),p=e.ref(!1),g=e.ref(!1),f=e.ref(""),v=e.ref(!1),_=e.ref(""),y=e.ref(!1),k=e.ref("color"),b=e.ref([]),w=e.ref(!1),D=()=>{w.value=!w.value},S=e.ref(!1),C=e.ref([]),N=e.ref(!1),T=e.ref(""),E=e.ref(0);e.ref(0);const x=e.ref("top"),V=e.computed((()=>"fixed"===x.value?{}:{top:`${E.value}px`})),$=()=>{T.value&&(plus.runtime.openURL(T.value),N.value=!1)},B=()=>{T.value&&uni.setClipboardData({data:T.value,success:()=>{uni.showToast({title:"Đã sao chép link",icon:"none"}),N.value=!1}})},M=()=>{T.value&&(f.value=T.value,N.value=!1,g.value=!0)},I=()=>{_.value="",v.value=!0},R=()=>{if(_.value){let e=_.value.trim();e.startsWith("http")||(e="https://"+e),b.value.push(e),O()}v.value=!1},O=()=>{c.value&&c.value.getContents({success:e=>{const t=e.html;h.value=t;const a=Ra(t,b.value);o("update:modelValue",a)}})},F=e=>{const t=d.value[e.name];return"header-menu"===e.action?t?`H${t}`:"H":"fontsize-menu"===e.action?"small"===t?"Sm":"large"===t?"Lg":"huge"===t?"Hg":"A":e.iconText},A=e=>{if("align-menu"===e.action){switch(d.value.align||"left"){case"center":return"/static/align-center.png";case"right":return"/static/align-right.png";case"justify":return"/static/align-justify.png";default:return"/static/align-left.png"}}return e.iconImg},L=e=>{const t=d.value[e.name];return"header-menu"===e.action||"fontsize-menu"===e.action?!!t:"align-menu"===e.action?!!t&&"left"!==t:"color"===e.name?!!d.value.color:"backgroundColor"===e.name?!!d.value.backgroundColor:e.value?t===e.value:!!t},P=()=>{S.value=!1},z=()=>{C.value=[{text:n("editor.align_left"),handler:()=>K("align","left")},{text:n("editor.align_center"),handler:()=>K("align","center")},{text:n("editor.align_right"),handler:()=>K("align","right")},{text:n("editor.align_justify"),handler:()=>K("align","justify")}],S.value=!0},U=()=>{C.value=[{text:n("editor.size_small"),handler:()=>K("fontSize","small")},{text:n("editor.size_normal"),handler:()=>K("fontSize",null)},{text:n("editor.size_large"),handler:()=>K("fontSize","large")},{text:n("editor.size_huge"),handler:()=>K("fontSize","huge")}],S.value=!0},j=()=>{C.value=[{text:"Heading 1",handler:()=>K("header",1)},{text:"Heading 2",handler:()=>K("header",2)},{text:"Heading 3",handler:()=>K("header",3)},{text:"Heading 4",handler:()=>K("header",4)},{text:n("editor.size_normal"),handler:()=>K("header",null)}],S.value=!0},H=()=>{C.value=[{text:n("editor.img_camera"),handler:()=>{uni.chooseImage({count:1,sourceType:["camera"],success:e=>W(e)})}},{text:n("editor.img_album"),handler:()=>{uni.chooseImage({count:1,sourceType:["album"],success:e=>W(e)})}}],S.value=!0},W=e=>{const t=e.tempFilePaths[0];c.value&&c.value.insertImage({src:t,width:"80%",alt:"image"})},q=()=>{uni.createSelectorQuery().in(u).select(`#${r.value}`).context((e=>{if(e&&e.context&&(c.value=e.context,i.modelValue)){const{cleanHtml:e,links:t}=Ia(i.modelValue);b.value=t,c.value.setContents({html:e}),h.value=e}})).exec()},Y=e=>{N.value=!1,p.value=!0;const t=e.detail.html;h.value=t;const a=Ra(t,b.value);o("update:modelValue",a)},G=e=>{d.value=e.detail,m.value=!!e.detail.link,e.detail.link?(T.value=e.detail.link,N.value=!0,c.value&&("function"==typeof c.value.getSelectionRect?c.value.getSelectionRect({success:e=>{e&&void 0!==e.bottom?(x.value="bottom",E.value=e.bottom+8):x.value="fixed"},fail:()=>{x.value="fixed"}}):x.value="fixed")):N.value=!1},K=(e,t=null)=>{c.value&&c.value.format(e,t)},J=e=>{K(k.value,e||null),y.value=!1},Q=()=>{y.value=!1},X=()=>{m.value?(c.value.format("link",null),N.value=!1):(f.value="",g.value=!0)},Z=()=>{f.value&&c.value.format("link",f.value),g.value=!1},ee=()=>{c.value.removeFormat()};return e.watch((()=>i.modelValue),(e=>{if(c.value){if(p.value)return void(p.value=!1);const{cleanHtml:t,links:a}=Ia(e||"");t!==h.value&&(c.value.setContents({html:t}),h.value=t),JSON.stringify(a)!==JSON.stringify(b.value)&&(b.value=a)}})),(a,n)=>(e.openBlock(),e.createElementBlock("view",{class:"editor-container"},[e.createElementVNode("view",{class:"editor-wrapper"},[e.createElementVNode("editor",{id:r.value,class:"ql-container",placeholder:t.placeholder||a.$t("editor.placeholder"),"show-img-size":"","show-img-toolbar":"","show-img-resize":"",onReady:q,onInput:Y,onStatuschange:G},null,40,["id","placeholder"]),N.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["link-tooltip",{"is-fixed":"fixed"===x.value}]),style:e.normalizeStyle(V.value),onClick:n[0]||(n[0]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"tooltip-content"},[e.createElementVNode("text",{class:"tooltip-url"},e.toDisplayString(T.value),1)]),e.createElementVNode("view",{class:"tooltip-actions"},[e.createElementVNode("view",{class:"t-btn",onClick:$},e.toDisplayString(a.$t("common.open_link")||"Mở"),1),e.createElementVNode("view",{class:"t-divider"}),e.createElementVNode("view",{class:"t-btn",onClick:B},e.toDisplayString(a.$t("common.copy_link")||"Copy"),1),e.createElementVNode("view",{class:"t-divider"}),e.createElementVNode("view",{class:"t-btn",onClick:M},e.toDisplayString(a.$t("common.edit_link")||"Sửa"),1)]),"fixed"!==x.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["tooltip-arrow",x.value])},null,2)):e.createCommentVNode("",!0)],6)):e.createCommentVNode("",!0)]),b.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"link-section-frame"},[e.createElementVNode("view",{class:"link-section-header",onClick:D},[e.createElementVNode("view",{class:"header-left"},[e.createElementVNode("image",{src:Ba,class:"header-icon"}),e.createElementVNode("text",{class:"header-title"},"Liên kết đính kèm ("+e.toDisplayString(b.value.length)+")",1)]),e.createElementVNode("image",{src:"https://img.icons8.com/ios-glyphs/30/666666/expand-arrow--v1.png",class:e.normalizeClass(["toggle-arrow",{open:w.value}])},null,2)]),w.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"link-list-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.value,((t,a)=>(e.openBlock(),e.createBlock(Fa,{key:a,url:t,removable:!0,onRemove:e=>(e=>{b.value.splice(e,1),O()})(a)},null,8,["url","onRemove"])))),128))])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"toolbar"},[e.createElementVNode("view",{class:"tool-list"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(s,((t,a)=>e.createElementVNode("view",{key:a,class:e.normalizeClass(["tool-item",{active:L(t)}]),onTouchend:e.withModifiers((e=>(e=>"header-menu"===e.action?j():"fontsize-menu"===e.action?U():"align-menu"===e.action?z():"color-picker"===e.action?(k.value="color",void(y.value=!0)):"bgcolor-picker"===e.action?(k.value="backgroundColor",void(y.value=!0)):void K(e.name,e.value))(t)),["prevent"])},[t.iconText?(e.openBlock(),e.createElementBlock("text",{key:0,style:e.normalizeStyle(t.style),class:e.normalizeClass(["txt-icon",{"txt-dynamic":t.action}])},e.toDisplayString(F(t)),7)):(e.openBlock(),e.createElementBlock("image",{key:1,src:A(t),class:"img-icon"},null,8,["src"]))],42,["onTouchend"]))),64)),e.createElementVNode("view",{class:"tool-divider"}),e.createElementVNode("view",{class:"tool-item",onTouchend:e.withModifiers(H,["prevent"])},[e.createElementVNode("image",{src:"/static/choseImage.png",class:"img-icon"})],32),e.createElementVNode("view",{class:e.normalizeClass(["tool-item",{active:m.value}]),onTouchend:e.withModifiers(X,["prevent"])},[e.createElementVNode("image",{src:Ba,class:"img-icon"})],34),e.createElementVNode("view",{class:"tool-item",onTouchend:e.withModifiers(I,["prevent"])},[e.createElementVNode("image",{src:"/static/add-link.png",class:"img-icon"})],32),e.createElementVNode("view",{class:"tool-item",onTouchend:e.withModifiers(ee,["prevent"])},[e.createElementVNode("text",{class:"txt-icon",style:{"font-size":"12px"}},"Clear")],32)])]),g.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal-overlay",onClick:n[4]||(n[4]=e=>g.value=!1)},[e.createElementVNode("view",{class:"modal-box",onClick:n[3]||(n[3]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(a.$t("editor.link_modal_title")),1),e.withDirectives(e.createElementVNode("input",{class:"modal-input","onUpdate:modelValue":n[1]||(n[1]=e=>f.value=e),placeholder:"https://example.com",focus:g.value},null,8,["focus"]),[[e.vModelText,f.value]]),e.createElementVNode("view",{class:"modal-actions"},[e.createElementVNode("button",{class:"btn-cancel",onClick:n[2]||(n[2]=e=>g.value=!1)},e.toDisplayString(a.$t("common.cancel")),1),e.createElementVNode("button",{class:"btn-confirm",onClick:Z},e.toDisplayString(a.$t("common.confirm")),1)])])])):e.createCommentVNode("",!0),v.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal-overlay",onClick:n[8]||(n[8]=e=>v.value=!1)},[e.createElementVNode("view",{class:"modal-box",onClick:n[7]||(n[7]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(a.$t("editor.card_modal_title")),1),e.createElementVNode("text",{class:"modal-desc"},e.toDisplayString(a.$t("editor.card_modal_desc")),1),e.withDirectives(e.createElementVNode("input",{class:"modal-input","onUpdate:modelValue":n[5]||(n[5]=e=>_.value=e),placeholder:"https://youtube.com/...",focus:v.value},null,8,["focus"]),[[e.vModelText,_.value]]),e.createElementVNode("view",{class:"modal-actions"},[e.createElementVNode("button",{class:"btn-cancel",onClick:n[6]||(n[6]=e=>v.value=!1)},e.toDisplayString(a.$t("common.cancel")),1),e.createElementVNode("button",{class:"btn-confirm",onClick:R},e.toDisplayString(a.$t("common.confirm")),1)])])])):e.createCommentVNode("",!0),y.value?(e.openBlock(),e.createElementBlock("view",{key:3,class:"modal-overlay",onClick:Q},[e.createElementVNode("view",{class:"modal-box color-box",onClick:n[12]||(n[12]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"color-tabs"},[e.createElementVNode("view",{class:e.normalizeClass(["color-tab",{active:"color"===k.value}]),onClick:n[9]||(n[9]=e=>k.value="color")},e.toDisplayString(a.$t("editor.color_text")),3),e.createElementVNode("view",{class:e.normalizeClass(["color-tab",{active:"backgroundColor"===k.value}]),onClick:n[10]||(n[10]=e=>k.value="backgroundColor")},e.toDisplayString(a.$t("editor.color_bg")),3)]),e.createElementVNode("view",{class:"color-grid"},[e.createElementVNode("view",{class:"color-circle no-color",onClick:n[11]||(n[11]=e=>J(""))},[e.createElementVNode("text",{class:"x-mark"},"✕")]),(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(l,((t,a)=>{return e.createElementVNode("view",{key:a,class:e.normalizeClass(["color-circle",{selected:(n=t,d.value[k.value]===n)}]),style:e.normalizeStyle({backgroundColor:t}),onClick:e=>J(t)},null,14,["onClick"]);var n})),64))])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["custom-sheet-mask",{show:S.value}]),onClick:P},[e.createElementVNode("view",{class:"custom-sheet-panel",onClick:n[13]||(n[13]=e.withModifiers((()=>{}),["stop"]))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(C.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"sheet-item",onClick:e=>(e=>{e.handler(),P()})(t)},[e.createElementVNode("text",null,e.toDisplayString(t.text),1)],8,["onClick"])))),128)),e.createElementVNode("view",{class:"sheet-gap"}),e.createElementVNode("view",{class:"sheet-item cancel",onClick:P},[e.createElementVNode("text",null,e.toDisplayString(a.$t("common.cancel")),1)])])],2)]))}}),[["__scopeId","data-v-1dc1aa10"]]),La=d(e.defineComponent({__name:"TodoDatePicker",props:{dueDate:{},notifyAt:{}},emits:["update:dueDate","update:notifyAt","change"],setup(t,{emit:a}){const i=a;it();const o=e=>{i("update:dueDate",e),i("change",{field:"dueDate",value:e})},s=e=>{i("update:notifyAt",e),i("change",{field:"notifyAt",value:e})},l=e=>{if(!e)return"";try{const t=new Date(e.replace(/-/g,"/"));if(isNaN(t.getTime()))return e;const a=t.getDate().toString().padStart(2,"0"),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getFullYear(),o=t.getHours().toString().padStart(2,"0");return`${a}/${n}/${i} ${o}:${t.getMinutes().toString().padStart(2,"0")}`}catch(t){return e}};return(t,a)=>{const i=n(e.resolveDynamicComponent("uni-datetime-picker"),C);return e.openBlock(),e.createElementBlock("view",{class:"flat-item date-compound-block"},[e.createElementVNode("view",{class:"item-left icon-top-aligned"},[e.createElementVNode("image",{src:"https://img.icons8.com/ios/50/666666/clock--v1.png",class:"item-icon"})]),e.createElementVNode("view",{class:"right-column"},[e.createElementVNode("view",{class:"date-row"},[e.createVNode(i,{type:"datetime",value:t.dueDate,"hide-second":!0,border:!1,onChange:o,class:"full-width-picker"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["item-picker",{"placeholder-color":!t.dueDate}])},[e.createElementVNode("text",{class:"picker-label"},e.toDisplayString(t.$t("todo.due_date_label")),1),e.createTextVNode(" "+e.toDisplayString(t.dueDate?l(t.dueDate):t.$t("todo.select_date")),1)],2)])),_:1},8,["value"])]),e.createElementVNode("view",{class:"inner-divider"}),e.createElementVNode("view",{class:"date-row"},[e.createVNode(i,{type:"datetime",value:t.notifyAt,"hide-second":!0,border:!1,onChange:s,class:"full-width-picker"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["item-picker",{"placeholder-color":!t.notifyAt}])},[e.createElementVNode("text",{class:"picker-label"},e.toDisplayString(t.$t("todo.notify_date_label")),1),e.createTextVNode(" "+e.toDisplayString(t.notifyAt?l(t.notifyAt):t.$t("todo.select_date")),1)],2)])),_:1},8,["value"])])])])}}}),[["__scopeId","data-v-e9225295"]]),Pa=e.defineComponent({__name:"create_todo",setup(t){const{loading:a,form:n,goBack:i,submitForm:o,memberOptions:s,onMemberChange:l,currentAssigneeName:r,showCustomerModal:c,loadingCustomer:d,customerList:u,openCustomerPopup:m,onCustomerSelect:h,sourceOptions:p,sourceIndex:g,onSourceChange:f,memberList:v,onCustomerFilter:_,loadingMore:y,loadMoreCustomers:k}=$a();return(t,b)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"https://img.icons8.com/ios/50/666666/edit--v1.png",class:"item-icon"})]),e.withDirectives(e.createElementVNode("textarea",{class:"item-input title-textarea","onUpdate:modelValue":b[0]||(b[0]=t=>e.unref(n).name=t),placeholder:t.$t("todo.enter_task_name"),maxlength:"256","auto-height":""},null,8,["placeholder"]),[[e.vModelText,e.unref(n).name]]),e.createElementVNode("text",{class:"char-count"},e.toDisplayString(t.$t("todo.char_count").replace("{current}",String(e.unref(n).name?e.unref(n).name.length:0)).replace("{max}","256")),1)]),e.createVNode(Aa,{modelValue:e.unref(n).desc,"onUpdate:modelValue":b[1]||(b[1]=t=>e.unref(n).desc=t),placeholder:t.$t("editor.placeholder")},null,8,["modelValue","placeholder"]),e.createElementVNode("view",{class:"flat-item",onClick:b[2]||(b[2]=(...t)=>e.unref(m)&&e.unref(m)(...t))},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"https://img.icons8.com/ios/50/666666/price-tag.png",class:"item-icon"})]),e.createElementVNode("view",{class:e.normalizeClass(["input-trigger",{placeholder:!e.unref(n).customer}])},e.toDisplayString(e.unref(n).customer||t.$t("todo.select_customer")),3),e.createElementVNode("text",{class:"arrow-icon"},"›")]),e.createVNode(rt,{visible:e.unref(c),loading:e.unref(d),loadingMore:e.unref(y),customers:e.unref(u),managers:e.unref(v),onClose:b[3]||(b[3]=e=>c.value=!1),onSelect:e.unref(h),onFilter:e.unref(_),onLoadMore:e.unref(k)},null,8,["visible","loading","loadingMore","customers","managers","onSelect","onFilter","onLoadMore"]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"https://img.icons8.com/ios/50/666666/internet.png",class:"item-icon"})]),e.createElementVNode("picker",{mode:"selector",range:e.unref(p),onChange:b[4]||(b[4]=(...t)=>e.unref(f)&&e.unref(f)(...t)),class:"full-width-picker"},[e.createElementVNode("view",{class:e.normalizeClass(["picker-display",{"placeholder-color":-1===e.unref(g)}])},e.toDisplayString(e.unref(g)>-1?e.unref(p)[e.unref(g)]:t.$t("todo.select_source")),3)],40,["range"]),e.createElementVNode("text",{class:"arrow-icon"},"›")]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"https://img.icons8.com/ios/50/666666/user.png",class:"item-icon"})]),e.createElementVNode("picker",{mode:"selector",range:e.unref(s),onChange:b[5]||(b[5]=(...t)=>e.unref(l)&&e.unref(l)(...t)),class:"full-width-picker"},[e.createElementVNode("view",{class:e.normalizeClass(["picker-display",{"placeholder-color":!e.unref(r)}])},e.toDisplayString(e.unref(r)?e.unref(r):t.$t("todo.assignee")),3)],40,["range"])]),e.createVNode(La,{dueDate:e.unref(n).dueDate,"onUpdate:dueDate":b[6]||(b[6]=t=>e.unref(n).dueDate=t),notifyAt:e.unref(n).notifyAt,"onUpdate:notifyAt":b[7]||(b[7]=t=>e.unref(n).notifyAt=t)},null,8,["dueDate","notifyAt"]),e.createElementVNode("view",{class:"footer-action"},[e.createVNode(Sa,{type:"secondary",label:t.$t("common.cancel_action"),class:"btn-cancel",onClick:e.unref(i)},null,8,["label","onClick"]),e.createVNode(Sa,{type:"primary",label:e.unref(a)?t.$t("common.saving"):t.$t("common.save"),loading:e.unref(a),class:"btn-submit",onClick:e.unref(o)},null,8,["label","loading","onClick"])]),e.createVNode(Ca),e.createVNode(Ea)]))}}),za="/static/expand-arrow.png",Ua=e=>{if(!e||e<=0)return"";try{const t=new Date(e),a=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0"),o=t.getHours().toString().padStart(2,"0"),s=t.getMinutes().toString().padStart(2,"0");return`${a}-${n}-${i} ${o}:${s}:${"00"}`}catch{return""}},ja=()=>{const{t:t}=it(),n=Zt(),i=n.uid,o=e.ref(!1),s=e.ref(!1),l=e.ref(!1),d=e.ref([]),u=e.ref(!1),m=e.ref([]),h=e.ref(!1),p=e.ref(""),g=e.ref(!1),f=e.ref(!1),v=e.ref(null),_=e.ref(!1),y=e.ref(""),k=e.ref(!1),b=e.ref(!1),w=e.ref(!1),D=e.ref(null),S=e.ref(""),C=e.ref(!1),T=e.ref(null),E=e.ref(0),x=e.computed((()=>[t("todo.filter_activity_all"),t("todo.filter_activity_comment")])),V=["","COMMENT"],$=e.ref(!1),I=e.ref(""),R=e.computed((()=>!W.value.raw||"DONE"===W.value.raw.status)),O=async e=>{if(!e)return{cleanMessage:"",fileUrl:""};const t=/<img[^>]+src="([^">]+)"[^>]*>/g;let n,i="",o=e;const s=[];for(;null!==(n=t.exec(e));){const e=n[0],t=n[1];if(o=o.replace(e,""),t.startsWith("http")||t.startsWith("https"))i=t;else{const e=ga(t).then((e=>e)).catch((e=>(a("error","at controllers/todo_detail.ts:198","Upload ảnh bình luận lỗi:",e),"")));s.push(e)}}if(s.length>0){const e=(await Promise.all(s)).find((e=>""!==e));e&&(i=e)}return o=o.trim(),{cleanMessage:o,fileUrl:i}},F=()=>{w.value=!1,L()},A=()=>{const e=String(n.uid),t=Y.value.find((t=>String(t.UID)===e));return t?t.memberUID:e},L=()=>{b.value=!1,D.value=null,I.value="",S.value="",p.value=""},P=()=>{C.value=!1,T.value=null},z=e.ref(null),U=e.ref(0),j=e.computed((()=>[t("todo.history_all"),t("todo.history_todo"),t("todo.history_ticket"),t("todo.history_call"),t("todo.history_customer"),t("todo.history_note")])),H=["ALL","TODO","TICKET","HISTORY_CALL","CUSTOMER","NOTE"],W=e.ref({id:"",title:"",code:t("common.loading"),desc:"",statusIndex:0,sourceIndex:0,assigneeIndex:0,assigneeId:"",dueDate:"",notifyAt:"",customerCode:"",customerName:"",customerNameLabel:"",customerPhone:"",customerPhoneLabel:"",customerManagerName:"",customerManagerLabel:"",raw:void 0}),q=e.computed((()=>[t("source.call"),t("source.customer"),t("source.conversation"),t("source.message")])),Y=e.ref([]),G=e.ref([]),K=e.computed((()=>{const e=[{label:t("todo.status_todo"),value:"TO_DO"},{label:t("todo.status_progress"),value:"IN_PROGRESS"},{label:t("todo.status_done"),value:"DONE"}];return W.value.raw&&"IN_PROGRESS"===W.value.raw.status?e.filter((e=>"TO_DO"!==e.value)):e})),J=e.computed((()=>K.value.map((e=>e.label)))),Q=()=>{_.value=!1,z.value=null,p.value="",y.value=""};r((async e=>{await X(),e&&e.id&&Z(e.id)}));const X=async()=>{try{const e=await Kt();if(Y.value=e,G.value=e.map((e=>e.UserName||t("common.unknown_member"))),W.value.assigneeId){const e=Y.value.findIndex((e=>e.memberUID===W.value.assigneeId));-1!==e&&(W.value.assigneeIndex=e)}}catch(e){a("error","at controllers/todo_detail.ts:831","Lỗi lấy members",e)}};c((()=>{a("log","at controllers/todo_detail.ts:852","Refreshing detail..."),(async()=>{if(W.value.id)try{await Promise.all([Z(W.value.id)])}catch(e){a("error","at controllers/todo_detail.ts:845",e)}finally{uni.stopPullDownRefresh()}else uni.stopPullDownRefresh()})()}));const Z=async e=>{W.value.title?uni.showNavigationBarLoading():o.value=!0;try{const t=await(e=>ea({url:`${qt}/getDetail`,method:"GET",data:{id:e,projectCode:Yt}}))(e),a=(e=>{if(!e)return null;let t=[ta,aa,na].indexOf(e.status);-1===t&&(t=0);let a=[Vt,$t,Bt,Mt].indexOf(e.links);return-1===a&&(a=0),e.notificationReceivedAt,{id:e.id,title:e.title||"",code:e.code||"",desc:e.description||"",statusIndex:t,sourceIndex:a,assigneeIndex:0,assigneeId:e.assigneeId||"",dueDate:Ua(e.dueDate),notifyAt:Ua(e.notificationReceivedAt),customerCode:e.customerCode||"",customerName:"",customerNameLabel:"Tên khách hàng",customerPhone:"",customerPhoneLabel:"Số điện thoại",customerManagerName:"",raw:e}})(t&&t.data&&!t.id?t.data:t);if(a){W.value=a;const t=a.raw.status,n=K.value.findIndex((e=>e.value===t));if(-1!==n&&(W.value.statusIndex=n),W.value.assigneeId&&Y.value.length>0){const e=Y.value.findIndex((e=>e.memberUID===W.value.assigneeId));-1!==e&&(W.value.assigneeIndex=e)}te(e),W.value.customerCode&&(ae(W.value.customerCode),ne(W.value.customerCode))}}catch(n){a("error","at controllers/todo_detail.ts:892","Lỗi lấy chi tiết:",n),_a(t("common.error_connection"))}finally{o.value=!1,uni.hideNavigationBarLoading()}},ee=e=>{var a;let i=t("todo.user_hidden"),o="?",s="#e3f2fd",l=!1;const r=String(n.uid);if(e.senderId){const t=String(e.senderId),a=Y.value.find((e=>String(e.UID)===t||String(e.memberUID)===t));a?(i=a.UserName,a.AvatarColor&&(s=a.AvatarColor),String(a.UID)===r&&(l=!0)):t===r&&(l=!0)}o=i.charAt(0).toUpperCase();let c="";"COMMENT"===e.type?c=t("todo.action_comment"):"LOG"===e.type?c=t("todo.action_log"):"UPDATE_TODO"===e.type?c=t("todo.action_update"):"NEW_TODO"===e.type&&(c="Đã tạo công việc");const d=(null==(a=e.reactions)?void 0:a.details)||[];return{id:e.id,senderId:e.senderId,senderName:i,senderAvatarChar:o,senderAvatarColor:s,message:e.message||"",files:e.files||"",timeDisplay:N(e.createdAt),actionText:c,isEdited:!!e.updatedAt,type:e.type,reactions:d,children:[],isMe:l}},te=async e=>{h.value=!0;try{const t=V[E.value],a=await((e,t="")=>ea({url:`${jt}/api/module-todo/todoMessages/getAllNoPageWithReact`,method:"GET",data:{todoId:e,keySearch:t}}))(e,t);Array.isArray(a)?m.value=a.map((e=>{const t=ee(e);return e.replies&&e.replies.length>0&&(t.children=e.replies.map((t=>{const a=ee(t);return a.rootParentId=e.id,a}))),t})):m.value=[]}catch(t){a("error","at controllers/todo_detail.ts:978","Lỗi lấy bình luận:",t)}finally{h.value=!1}},ae=async e=>{var i;s.value=!0;try{const a=n.todoToken;if(!a)return;const o=await((e,t)=>ea({url:`${Ht}/Customer/getDetail`,method:"GET",data:{uid:t},header:{Authorization:`Bearer ${e}`}}))(a,e),l=o.fields||(null==(i=o.data)?void 0:i.fields)||[],r=l.find((e=>"name"===e.code)),c=l.find((e=>"phone"===e.code)),d=l.find((e=>"member_no"===e.code));if(r&&(W.value.customerName=r.value,W.value.customerNameLabel=r.name||t("todo.customer_name_label")),c&&(W.value.customerPhone=c.value,W.value.customerPhoneLabel=c.name),d){W.value.customerManagerLabel=d.name||t("todo.customer_manager_label");const e=d.value,a=Y.value.find((t=>t.memberUID===e));W.value.customerManagerName=a?a.UserName:t("todo.unknown")}}catch(o){a("error","at controllers/todo_detail.ts:1036","Lỗi CRM:",o)}finally{s.value=!1}},ne=async e=>{l.value=!0;try{const i=H[U.value],o=n.todoToken;if(!o)return void a("error","at controllers/todo_detail.ts:1048","Chưa có Token CRM/Todo");const s=await((e,t,a="ALL")=>ea({url:`${Ht}/ActionTimeline/getAll?from=-1&to=-1&customerUid=${t}&type=${a}&page=1&size=10&memberUid=&projectCode=`,method:"GET",header:{Authorization:`Bearer ${e}`}}))(o,e,i);Array.isArray(s)&&(d.value=s.map((e=>{const a=new Date(e.createAt),n=`${a.getDate().toString().padStart(2,"0")}/${(a.getMonth()+1).toString().padStart(2,"0")}/${a.getFullYear()}`;let i=t("common.system");if(e.memberUid){const t=Y.value.find((t=>t.memberUID===e.memberUid));t&&(i=t.UserName)}const o=la[e.typeSub]||e.typeSub||t("todo.interaction_other");return{id:e.id,timeStr:n,content:o,actorName:i,originalType:e.typeSub}})))}catch(i){a("error","at controllers/todo_detail.ts:1086","Lỗi lấy lịch sử:",i)}finally{l.value=!1}};return{isLoading:o,isLoadingCustomer:s,isLoadingHistory:l,historyList:d,form:W,statusOptions:J,sourceOptions:q,assigneeOptions:G,onStatusChange:async e=>{const n=parseInt(e.detail.value),i=K.value[n];if(!i)return;W.value.statusIndex=n;const s=i.value;if(W.value.raw){o.value=!0;try{const e={...W.value.raw,status:s,preFixCode:"TODO",description:W.value.desc,files:"",tagCodes:"",title:W.value.title||W.value.raw.title};a("log","at controllers/todo_detail.ts:1133","Payload Update Status:",e);if(await ma(e)){va(t("todo.msg_status_changed")),W.value.raw.status=s;const e=K.value.findIndex((e=>e.value===s));W.value.statusIndex=-1!==e?e:0,W.value.customerCode&&await ne(W.value.customerCode),await te(W.value.id)}}catch(l){a("error","at controllers/todo_detail.ts:1149","Lỗi cập nhật trạng thái:",l),_a(t("todo.msg_update_error"))}finally{o.value=!1}}},onSourceChange:e=>{W.value.sourceIndex=e.detail.value},onAssigneeChange:async e=>{const n=parseInt(e.detail.value);if(!Y.value[n])return;const i=Y.value[n].memberUID;if(W.value.assigneeIndex=n,W.value.assigneeId=i,W.value.raw){o.value=!0;try{const e={...W.value.raw,assigneeId:i,preFixCode:"TODO",description:W.value.desc,files:"",tagCodes:"",title:W.value.title||W.value.raw.title};a("log","at controllers/todo_detail.ts:1193","Payload Update Assignee:",e);await ma(e)&&(va(t("todo.msg_assignee_changed")),W.value.raw.assigneeId=i,W.value.customerCode&&await ne(W.value.customerCode),await te(W.value.id))}catch(s){a("error","at controllers/todo_detail.ts:1211","Lỗi cập nhật người giao:",s),_a(t("todo.msg_update_error"))}finally{o.value=!1}}else _a(t("common.error_missing_data"))},goBack:()=>{uni.navigateBack()},saveTodo:()=>{a("log","at controllers/todo_detail.ts:1220","Lưu:",W.value),va(t("todo.msg_saved"))},historyFilterOptions:j,historyFilterIndex:U,onHistoryFilterChange:e=>{U.value=e.detail.value,W.value.customerCode&&ne(W.value.customerCode)},comments:m,isLoadingComments:h,newCommentText:p,isSubmittingComment:g,submitComment:async()=>{if(p.value&&p.value.trim()||p.value.includes("<img")){g.value=!0;try{const{cleanMessage:e,fileUrl:a}=await O(p.value),n=W.value.id,i={todoId:n,senderId:A(),message:e,files:a,parentId:-1},o=await ha(i);if(o){va(t("todo.msg_comment_success")),p.value="";const e=await pa(o,n);if(e){const t=ee(e);m.value.unshift(t)}}}catch(e){a("error","at controllers/todo_detail.ts:808","Lỗi gửi bình luận:",e),_a(t("common.error_send"))}finally{g.value=!1}}else ya("Vui lòng nhập nội dung")},isConfirmDeleteCommentOpen:f,onRequestDeleteComment:e=>{v.value=e,f.value=!0},confirmDeleteComment:async()=>{if(!v.value)return;const e=v.value;f.value=!1;try{await(n=e,ea({url:`${jt}/api/module-todo/todoMessages/delete`,method:"POST",data:{id:n}})),va(t("todo.msg_deleted"));const a=m.value.findIndex((t=>t.id===e));if(-1!==a)m.value.splice(a,1);else for(const t of m.value)if(t.children&&t.children.length>0){const a=t.children.findIndex((t=>t.id===e));if(-1!==a){t.children.splice(a,1);break}}}catch(i){a("error","at controllers/todo_detail.ts:760","Lỗi xóa bình luận:",i),_a(t("common.fail_delete"))}finally{v.value=null}var n},cancelDeleteComment:()=>{f.value=!1,v.value=null},currentUserId:i,isEditingComment:_,onRequestEditComment:async n=>{const i=W.value.id;if(i){b.value=!1,D.value=null,S.value="",I.value="";try{const s=await pa(n,i);if(a("log","at controllers/todo_detail.ts:619","API Response Detail:",s),s){const n=s.data||s;z.value={id:n.id,todoId:n.todoId,senderId:n.senderId};const i=n.senderId,o=Y.value.find((e=>e.UID===i));y.value=o?o.UserName:t("common.me");const l=n.message||"";a("log","at controllers/todo_detail.ts:636","Nội dung edit:",l),_.value=!0,await e.nextTick(),p.value=l}}catch(s){a("error","at controllers/todo_detail.ts:642","Lỗi lấy chi tiết bình luận:",s),_a(t("common.error_load"))}finally{o.value=!1}}},submitUpdateComment:async()=>{if(z.value)if(p.value&&p.value.trim()||p.value.includes("<img")){g.value=!0;try{const{cleanMessage:a,fileUrl:n}=await O(p.value),i={id:z.value.id,todoId:z.value.todoId,senderId:z.value.senderId,message:a,files:n},o=await(e=i,ea({url:`${jt}/api/module-todo/todoMessages/update`,method:"POST",data:e}));if(o){va(t("todo.msg_update_success"));const e=m.value.findIndex((e=>e.id===o.id));if(-1!==e)m.value[e].message=o.message,m.value[e].files=o.files,m.value[e].isEdited=!0;else for(const t of m.value)if(t.children){const e=t.children.findIndex((e=>e.id===o.id));if(-1!==e){t.children[e].message=o.message,t.children[e].files=o.files,t.children[e].isEdited=!0;break}}Q()}}catch(n){a("error","at controllers/todo_detail.ts:700","Lỗi cập nhật:",n),_a(t("common.error_update"))}finally{g.value=!1}var e}else ya(t("todo.msg_empty_content"))},onCancelEditComment:()=>{k.value=!0},isConfirmCancelEditOpen:k,continueEditing:()=>{k.value=!1},confirmCancelEdit:async()=>{k.value=!1,Q()},editingMemberName:y,isEmojiPickerOpen:C,emojiList:["👍","👎","😍","😆","😱","😭","😤"],onToggleEmojiPicker:e=>{T.value=e,C.value=!0},closeEmojiPicker:P,selectEmoji:async e=>{if(!T.value)return;const i=T.value.id;P();const o=W.value.id,s=n.uid,l={todoId:Number(o),senderId:s,todoMessageId:Number(i),codeEmoji:e};try{if(await(r=l,ea({url:`${jt}/api/module-todo/todoMessages/reaction`,method:"POST",data:r}))){let t=null;const n=m.value.findIndex((e=>e.id===i));if(-1!==n)t=m.value[n];else for(const e of m.value)if(e.children){const a=e.children.find((e=>e.id===i));if(a){t=a;break}}if(t){t.reactions||(t.reactions=[]);const n=t.reactions.findIndex((e=>e.senderId===s));if(-1!==n){t.reactions[n].codeEmoji===e?a("log","at controllers/todo_detail.ts:532","User thả trùng emoji cũ"):t.reactions[n].codeEmoji=e}else t.reactions.push({codeEmoji:e,senderId:s});t.reactions=[...t.reactions]}}}catch(c){a("error","at controllers/todo_detail.ts:550","Lỗi thả cảm xúc:",c),_a(t("common.error_connection"))}var r},isReplying:b,isConfirmCancelReplyOpen:w,replyingCommentData:D,replyingMemberName:S,onRequestReply:async a=>{_.value=!1,z.value=null,p.value="",D.value=a;const n=a.message||"",{cleanHtml:i}=Ia(n);I.value=i,b.value=!0;const o=a.senderId,s=Y.value.find((e=>e.memberUID===o));S.value=s?s.UserName:t("todo.user_hidden"),await e.nextTick()},onCancelReply:()=>{p.value.trim()?w.value=!0:F()},confirmCancelReply:F,continueReplying:()=>{w.value=!1},submitReply:async()=>{if(p.value&&p.value.trim()||p.value.includes("<img")){if(D.value){g.value=!0;try{const{cleanMessage:e,fileUrl:a}=await O(p.value),n=W.value.id,i=A();let o=D.value.id;D.value.rootParentId&&(o=D.value.rootParentId);const s={todoId:n,senderId:i,message:e,files:a,parentId:o},l=await ha(s);if(l){va(t("todo.msg_reply_success"));const e=await pa(l,W.value.id),a=ee(e),n=D.value.rootParentId||D.value.id,i=m.value.find((e=>e.id===n));i&&(i.children||(i.children=[]),a.rootParentId=n,i.children.push(a)),L()}}catch(e){a("error","at controllers/todo_detail.ts:454","Lỗi gửi trả lời:",e),_a(t("common.error_send"))}finally{g.value=!1}}}else ya(t("todo.msg_empty_content"))},commentFilterIndex:E,commentFilterOptions:x,onCommentFilterChange:e=>{const t=e.detail.value;E.value!==t&&(E.value=t,W.value.id&&te(W.value.id))},isSavingDescription:$,onSaveDescription:async()=>{if(W.value.raw){$.value=!0;try{const{newContent:e,fileUrls:n}=await(async e=>{if(!e)return{newContent:"",fileUrls:[]};const t=/<img[^>]+src="([^">]+)"/g;let n;const i=[],o=[],s=[];for(;null!==(n=t.exec(e));){const e=n[1];if(!e.startsWith("http")&&!e.startsWith("https")){const t=ga(e).then((t=>{o.push({oldSrc:e,newSrc:t}),s.push(t)})).catch((e=>{a("error","at controllers/todo_detail.ts:238","Upload ảnh detail lỗi:",e)}));i.push(t)}}i.length>0&&await Promise.all(i);let l=e;return o.forEach((e=>{l=l.split(e.oldSrc).join(e.newSrc)})),{newContent:l,fileUrls:s}})(W.value.desc);W.value.desc=e;const i=n.length>0?n.join(","):"",o={...W.value.raw,preFixCode:"TODO",description:W.value.desc,files:i,tagCodes:"",title:W.value.title||W.value.raw.title};a("log","at controllers/todo_detail.ts:282","Payload Update Description:",o);await ma(o)&&(va(t("todo.msg_desc_saved")),W.value.raw.description=W.value.desc,i&&(W.value.raw.files=i),await te(W.value.id))}catch(e){a("error","at controllers/todo_detail.ts:297","Lỗi cập nhật công việc:",e),_a(t("common.error_update"))}finally{$.value=!1}}else _a(t("common.error_missing_data"))},onDateUpdate:async e=>{if(!W.value.raw)return;let n=W.value.dueDate,i=W.value.notifyAt;"dueDate"===e.field?n=e.value:"notifyAt"===e.field&&(i=e.value);if(!B(n,i))return ya("Ngày thông báo phải nhỏ hơn hạn xử lý (không được trùng)!"),"dueDate"===e.field?W.value.dueDate:W.value.notifyAt,void("dueDate"===e.field?W.value.dueDate=W.value.raw.dueDate?M(W.value.raw.dueDate):"":W.value.notifyAt=W.value.raw.notificationReceivedAt?M(W.value.raw.notificationReceivedAt):"");o.value=!0;try{const n={...W.value.raw,preFixCode:"TODO",description:W.value.desc,files:"",tagCodes:"",title:W.value.title||W.value.raw.title},i=(e=>{if(!e)return 0;try{const t=e.replace(/-/g,"/");return new Date(t).getTime()}catch{return 0}})(e.value);"dueDate"===e.field?n.dueDate=i:"notifyAt"===e.field&&(n.notificationReceivedAt=i),a("log","at controllers/todo_detail.ts:148",`Payload Update ${e.field}:`,n);await ma(n)&&(va(t("todo.msg_update_success")),"dueDate"===e.field?(W.value.raw.dueDate=n.dueDate,W.value.dueDate=e.value):(W.value.raw.notificationReceivedAt=n.notificationReceivedAt,W.value.notifyAt=e.value),W.value.customerCode&&await ne(W.value.customerCode),await te(W.value.id))}catch(s){a("error","at controllers/todo_detail.ts:166","Lỗi cập nhật ngày:",s),_a(t("todo.msg_update_error")),"dueDate"===e.field?W.value.dueDate=M(W.value.raw.dueDate):W.value.notifyAt=M(W.value.raw.notificationReceivedAt)}finally{o.value=!1}},isStatusDisabled:R,dynamicStatusOptions:K,onSaveTitle:async()=>{if(!W.value.raw)return;const e=W.value.title?W.value.title.trim():"",n=W.value.raw.title;if(!e)return ya(t("todo.msg_title_empty")),void(W.value.title=n);if(e!==n){o.value=!0;try{const n={...W.value.raw,title:e,preFixCode:"TODO",description:W.value.raw.description,files:W.value.raw.files||"",tagCodes:W.value.raw.tagCodes||""};a("log","at controllers/todo_detail.ts:332","Payload Update Title:",n);await ma(n)&&(va(t("todo.msg_title_changed")),W.value.raw.title=e,W.value.customerCode&&await ne(W.value.customerCode),await te(W.value.id))}catch(i){a("error","at controllers/todo_detail.ts:347","Lỗi cập nhật tiêu đề:",i),_a(t("todo.msg_update_error")),W.value.title=n}finally{o.value=!1}}},replyingMessagePreview:I,isHistoryOpen:u,toggleHistory:()=>{u.value=!u.value}}},Ha=e=>{(e.$wxs||(e.$wxs=[])).push("handler"),(e.$wxsModules||(e.$wxsModules={})).handler="37368788"},Wa={name:"node",options:{},data:()=>({ctrl:{},nodes:[]}),props:{name:String,attrs:{type:Object,default:()=>({})},childs:Array,opts:Array},watch:{childs:{handler(e){for(;this.nodes.length>e.length;)e.push({});this.nodes=e},immediate:!0}},components:{},mounted(){if(this.$nextTick((()=>{for(this.root=this.$parent;"mp-html"!==this.root.$options.name;this.root=this.root.$parent);})),this.opts[0]){let e;for(e=this.childs.length;e--&&"img"!==this.childs[e].name;);-1!==e&&(this.observer=uni.createIntersectionObserver(this).relativeToViewport({top:500,bottom:500}),this.observer.observe("._img",(e=>{e.intersectionRatio&&(this.$set(this.ctrl,"load",1),this.observer.disconnect())})))}},beforeDestroy(){this.observer&&this.observer.disconnect()},methods:{play(e){const t=e.currentTarget.dataset.i,a=this.childs[t];this.root.$emit("play",{source:a.name,attrs:{...a.attrs,src:a.src[this.ctrl[t]||0]}})},mediaEvent(e){const t=e.currentTarget.dataset.i,a=this.childs[t];this.root.$emit(e.type,{...e.detail,source:a.name,attrs:{...a.attrs,src:a.src[this.ctrl[t]||0]}})},imgTap(e){const t=this.childs[e.currentTarget.dataset.i];t.a?this.linkTap(t.a):t.attrs.ignore||(t.attrs.src=t.attrs.src||t.attrs["data-src"],this.root.$emit("imgtap",t.attrs),this.root.previewImg&&uni.previewImage({current:parseInt(t.attrs.i),urls:this.root.imgList}))},imgLongTap(e){const t=this.childs[e.currentTarget.dataset.i].attrs;this.opts[3]&&!t.ignore&&uni.showActionSheet({itemList:["保存图片"],success:()=>{const e=e=>{uni.saveImageToPhotosAlbum({filePath:e,success(){uni.showToast({title:"保存成功"})}})};this.root.imgList[t.i].startsWith("http")?uni.downloadFile({url:this.root.imgList[t.i],success:t=>e(t.tempFilePath)}):e(this.root.imgList[t.i])}})},imgLoad(e){const t=e.currentTarget.dataset.i;this.childs[t].w?(this.opts[1]&&!this.ctrl[t]||-1===this.ctrl[t])&&this.$set(this.ctrl,t,1):this.$set(this.ctrl,t,e.detail.width),this.checkReady()},checkReady(){this.root&&!this.root.lazyLoad&&(this.root._unloadimgs-=1,this.root._unloadimgs||setTimeout((()=>{this.root.getRect().then((e=>{this.root.$emit("ready",e)})).catch((()=>{this.root.$emit("ready",{})}))}),350))},linkTap(e){const t=e.currentTarget?this.childs[e.currentTarget.dataset.i]:{},a=t.attrs||e,n=a.href;this.root.$emit("linktap",Object.assign({innerText:this.root.getText(t.children||[])},a)),n&&("#"===n[0]?this.root.navigateTo(n.substring(1)).catch((()=>{})):n.split("?")[0].includes("://")?this.root.copyLink&&plus.runtime.openWeb(n):uni.navigateTo({url:n,fail(){uni.switchTab({url:n,fail(){}})}}))},mediaError(e){const t=e.currentTarget.dataset.i,a=this.childs[t];if("video"===a.name||"audio"===a.name){let e=(this.ctrl[t]||0)+1;if(e>a.src.length&&(e=0),e<a.src.length)return void this.$set(this.ctrl,t,e)}else"img"===a.name&&(this.opts[2]&&this.$set(this.ctrl,t,-1),this.checkReady());this.root&&this.root.$emit("error",{source:a.name,attrs:a.attrs,errMsg:e.detail.errMsg})}}};Ha(Wa);const qa=d(Wa,[["render",function(t,a,n,i,o,s){const l=e.resolveComponent("node",!0);return e.openBlock(),e.createElementBlock("view",{id:n.attrs.id,class:e.normalizeClass("_block _"+n.name+" "+n.attrs.class),style:e.normalizeStyle(n.attrs.style)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.nodes,((t,i)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:i},["img"===t.name&&!t.t&&(n.opts[1]&&!o.ctrl[i]||o.ctrl[i]<0)?(e.openBlock(),e.createElementBlock("image",{key:0,class:"_img",style:e.normalizeStyle(t.attrs.style),src:o.ctrl[i]<0?n.opts[2]:n.opts[1],mode:"widthFix"},null,12,["src"])):e.createCommentVNode("",!0),"img"===t.name&&t.t?(e.openBlock(),e.createElementBlock("rich-text",{key:1,style:e.normalizeStyle("display:"+t.t),nodes:[{attrs:{style:t.attrs.style||"",src:t.attrs.src},name:"img"}],"data-i":i,onClick:a[0]||(a[0]=e.withModifiers(((...e)=>s.imgTap&&s.imgTap(...e)),["stop"]))},null,12,["nodes","data-i"])):"img"===t.name?(e.openBlock(),e.createElementBlock("image",{key:2,id:t.attrs.id,class:e.normalizeClass("_img "+t.attrs.class),style:e.normalizeStyle((-1===o.ctrl[i]?"display:none;":"")+"width:"+(o.ctrl[i]||1)+"px;"+t.attrs.style),src:t.attrs.src||(o.ctrl.load?t.attrs["data-src"]:""),mode:t.h?t.w?t.m||"":"heightFix":"widthFix","data-i":i,onLoad:a[1]||(a[1]=(...e)=>s.imgLoad&&s.imgLoad(...e)),onError:a[2]||(a[2]=(...e)=>s.mediaError&&s.mediaError(...e)),onClick:a[3]||(a[3]=e.withModifiers(((...e)=>s.imgTap&&s.imgTap(...e)),["stop"])),onLongpress:a[4]||(a[4]=(...e)=>s.imgLongTap&&s.imgLongTap(...e))},null,46,["id","src","mode","data-i"])):t.text?(e.openBlock(),e.createElementBlock("text",{key:3,decode:""},e.toDisplayString(t.text),1)):"br"===t.name?(e.openBlock(),e.createElementBlock("text",{key:4},e.toDisplayString("\n"))):"a"===t.name?(e.openBlock(),e.createElementBlock("view",{key:5,id:t.attrs.id,class:e.normalizeClass((t.attrs.href?"_a ":"")+t.attrs.class),"hover-class":"_hover",style:e.normalizeStyle("display:inline;"+t.attrs.style),"data-i":i,onClick:a[5]||(a[5]=e.withModifiers(((...e)=>s.linkTap&&s.linkTap(...e)),["stop"]))},[e.createVNode(l,{name:"span",childs:t.children,opts:n.opts,style:{display:"inherit"}},null,8,["childs","opts"])],14,["id","data-i"])):t.html?(e.openBlock(),e.createElementBlock("view",{key:6,id:t.attrs.id,class:e.normalizeClass("_video "+t.attrs.class),style:e.normalizeStyle(t.attrs.style),innerHTML:t.html,"data-i":i,onVplay:a[6]||(a[6]=e.withModifiers(((...e)=>s.play&&s.play(...e)),["stop"]))},null,46,["id","innerHTML","data-i"])):"iframe"===t.name?(e.openBlock(),e.createElementBlock("iframe",{key:7,style:e.normalizeStyle(t.attrs.style),allowfullscreen:t.attrs.allowfullscreen,frameborder:t.attrs.frameborder,src:t.attrs.src},null,12,["allowfullscreen","frameborder","src"])):"embed"===t.name?(e.openBlock(),e.createElementBlock("embed",{key:8,style:e.normalizeStyle(t.attrs.style),src:t.attrs.src},null,12,["src"])):"table"===t.name&&t.c||"li"===t.name?(e.openBlock(),e.createElementBlock("view",{key:9,id:t.attrs.id,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},["li"===t.name?(e.openBlock(),e.createBlock(l,{key:0,childs:t.children,opts:n.opts},null,8,["childs","opts"])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(t.children,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},["td"===t.name||"th"===t.name?(e.openBlock(),e.createBlock(l,{key:0,childs:t.children,opts:n.opts},null,8,["childs","opts"])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(t.children,((t,a)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:a},["td"===t.name||"th"===t.name?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},[e.createVNode(l,{childs:t.children,opts:n.opts},null,8,["childs","opts"])],6)):(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.children,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},[e.createVNode(l,{childs:t.children,opts:n.opts},null,8,["childs","opts"])],6)))),128))],6))],64)))),128))],6)))),128))],14,["id"])):t.c?2===t.c?(e.openBlock(),e.createElementBlock("view",{key:11,id:t.attrs.id,class:e.normalizeClass("_block _"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.f+";"+t.attrs.style)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.children,((t,a)=>(e.openBlock(),e.createBlock(l,{key:a,style:e.normalizeStyle(t.f),name:t.name,attrs:t.attrs,childs:t.children,opts:n.opts},null,8,["style","name","attrs","childs","opts"])))),128))],14,["id"])):(e.openBlock(),e.createBlock(l,{key:12,style:e.normalizeStyle(t.f),name:t.name,attrs:t.attrs,childs:t.children,opts:n.opts},null,8,["style","name","attrs","childs","opts"])):(e.openBlock(),e.createElementBlock("rich-text",{key:10,id:t.attrs.id,style:e.normalizeStyle("display:inline;"+t.f),preview:!1,selectable:n.opts[4],"user-select":n.opts[4],nodes:[t]},null,12,["id","selectable","user-select","nodes"]))],64)))),128))],14,["id"])}],["__scopeId","data-v-749ddec3"]]),Ya={trustTags:Za("a,abbr,ad,audio,b,blockquote,br,code,col,colgroup,dd,del,dl,dt,div,em,fieldset,h1,h2,h3,h4,h5,h6,hr,i,img,ins,label,legend,li,ol,p,q,ruby,rt,source,span,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,title,ul,video"),blockTags:Za("address,article,aside,body,caption,center,cite,footer,header,html,nav,pre,section"),inlineTags:Za("abbr,b,big,code,del,em,i,ins,label,q,small,span,strong,sub,sup"),ignoreTags:Za("area,base,canvas,embed,frame,head,iframe,input,link,map,meta,param,rp,script,source,style,textarea,title,track,wbr"),voidTags:Za("area,base,br,col,circle,ellipse,embed,frame,hr,img,input,line,link,meta,param,path,polygon,rect,source,track,use,wbr"),entities:{lt:"<",gt:">",quot:'"',apos:"'",ensp:" ",emsp:" ",nbsp:" ",semi:";",ndash:"–",mdash:"—",middot:"·",lsquo:"‘",rsquo:"’",ldquo:"“",rdquo:"”",bull:"•",hellip:"…",larr:"←",uarr:"↑",rarr:"→",darr:"↓"},tagStyle:{address:"font-style:italic",big:"display:inline;font-size:1.2em",caption:"display:table-caption;text-align:center",center:"text-align:center",cite:"font-style:italic",dd:"margin-left:40px",mark:"background-color:yellow",pre:"font-family:monospace;white-space:pre",s:"text-decoration:line-through",small:"display:inline;font-size:0.8em",strike:"text-decoration:line-through",u:"text-decoration:underline"},svgDict:{animatetransform:"animateTransform",lineargradient:"linearGradient",viewbox:"viewBox",attributename:"attributeName",repeatcount:"repeatCount",repeatdur:"repeatDur",foreignobject:"foreignObject"}},Ga={};let Ka;const Ja=uni.getSystemInfoSync();Ka=Ja.windowWidth;const Qa=Za(" ,\r,\n,\t,\f");let Xa=0;function Za(e){const t=Object.create(null),a=e.split(",");for(let n=a.length;n--;)t[a[n]]=!0;return t}function en(e,t){let a=e.indexOf("&");for(;-1!==a;){const n=e.indexOf(";",a+3);let i;if(-1===n)break;"#"===e[a+1]?(i=parseInt(("x"===e[a+2]?"0":"")+e.substring(a+2,n)),isNaN(i)||(e=e.substr(0,a)+String.fromCharCode(i)+e.substr(n+1))):(i=e.substring(a+1,n),(Ya.entities[i]||"amp"===i&&t)&&(e=e.substr(0,a)+(Ya.entities[i]||"&")+e.substr(n+1))),a=e.indexOf("&",a+1)}return e}function tn(e){let t=e.length-1;for(let a=t;a>=-1;a--)(-1===a||e[a].c||!e[a].name||"div"!==e[a].name&&"p"!==e[a].name&&"h"!==e[a].name[0]||(e[a].attrs.style||"").includes("inline"))&&(t-a>=5&&e.splice(a+1,t-a,{name:"div",attrs:{},children:e.slice(a+1,t+1)}),t=a-1)}function an(e){this.options=e||{},this.tagStyle=Object.assign({},Ya.tagStyle,this.options.tagStyle),this.imgList=e.imgList||[],this.imgList._unloadimgs=0,this.plugins=e.plugins||[],this.attrs=Object.create(null),this.stack=[],this.nodes=[],this.pre=(this.options.containerStyle||"").includes("white-space")&&this.options.containerStyle.includes("pre")?2:0}function nn(e){this.handler=e}Ya.ignoreTags.iframe=void 0,Ya.trustTags.iframe=!0,Ya.ignoreTags.embed=void 0,Ya.trustTags.embed=!0,an.prototype.parse=function(e){for(let t=this.plugins.length;t--;)this.plugins[t].onUpdate&&(e=this.plugins[t].onUpdate(e,Ya)||e);for(new nn(this).parse(e);this.stack.length;)this.popNode();return this.nodes.length>50&&tn(this.nodes),this.nodes},an.prototype.expose=function(){for(let e=this.stack.length;e--;){const t=this.stack[e];if(t.c||"a"===t.name||"video"===t.name||"audio"===t.name)return;t.c=1}},an.prototype.hook=function(e){for(let t=this.plugins.length;t--;)if(this.plugins[t].onParse&&!1===this.plugins[t].onParse(e,this))return!1;return!0},an.prototype.getUrl=function(e){const t=this.options.domain;return"/"===e[0]?e="/"===e[1]?(t?t.split("://")[0]:"http")+":"+e:t?t+e:plus.io.convertLocalFileSystemURL(e):e.includes("data:")||e.includes("://")||(e=t?t+"/"+e:plus.io.convertLocalFileSystemURL(e)),e},an.prototype.parseStyle=function(e){const t=e.attrs,a=(this.tagStyle[e.name]||"").split(";").concat((t.style||"").split(";")),n={};let i="";t.id&&!this.xml&&(this.options.useAnchor?this.expose():"img"!==e.name&&"a"!==e.name&&"video"!==e.name&&"audio"!==e.name&&(t.id=void 0)),t.width&&(n.width=parseFloat(t.width)+(t.width.includes("%")?"%":"px"),t.width=void 0),t.height&&(n.height=parseFloat(t.height)+(t.height.includes("%")?"%":"px"),t.height=void 0);for(let o=0,s=a.length;o<s;o++){const e=a[o].split(":");if(e.length<2)continue;const t=e.shift().trim().toLowerCase();let s=e.join(":").trim();if("-"===s[0]&&s.lastIndexOf("-")>0||s.includes("safe"))i+=`;${t}:${s}`;else if(!n[t]||s.includes("import")||!n[t].includes("import")){if(s.includes("url")){let e=s.indexOf("(")+1;if(e){for(;'"'===s[e]||"'"===s[e]||Qa[s[e]];)e++;s=s.substr(0,e)+this.getUrl(s.substr(e))}}else s.includes("rpx")&&(s=s.replace(/[0-9.]+\s*rpx/g,(e=>parseFloat(e)*Ka/750+"px")));n[t]=s}}return e.attrs.style=i,n},an.prototype.onTagName=function(e){this.tagName=this.xml?e:e.toLowerCase(),"svg"===this.tagName&&(this.xml=(this.xml||0)+1,Ya.ignoreTags.style=void 0)},an.prototype.onAttrName=function(e){(e=this.xml?e:e.toLowerCase()).includes("?")||e.includes(";")?this.attrName=void 0:"data-"===e.substr(0,5)?"data-src"!==e||this.attrs.src?"img"===this.tagName||"a"===this.tagName?this.attrName=e:this.attrName=void 0:this.attrName="src":(this.attrName=e,this.attrs[e]="T")},an.prototype.onAttrVal=function(e){const t=this.attrName||"";"style"===t||"href"===t?this.attrs[t]=en(e,!0):t.includes("src")?this.attrs[t]=this.getUrl(en(e,!0)):t&&(this.attrs[t]=e)},an.prototype.onOpenTag=function(e){const t=Object.create(null);t.name=this.tagName,t.attrs=this.attrs,this.options.nodes.length&&(t.type="node"),this.attrs=Object.create(null);const a=t.attrs,n=this.stack[this.stack.length-1],i=n?n.children:this.nodes,o=this.xml?e:Ya.voidTags[t.name];if(Ga[t.name]&&(a.class=Ga[t.name]+(a.class?" "+a.class:"")),"embed"===t.name&&this.expose(),"video"!==t.name&&"audio"!==t.name||("video"!==t.name||a.id||(a.id="v"+Xa++),a.controls||a.autoplay||(a.controls="T"),t.src=[],a.src&&(t.src.push(a.src),a.src=void 0),this.expose()),o){if(!this.hook(t)||Ya.ignoreTags[t.name])return void("base"!==t.name||this.options.domain?"source"===t.name&&n&&("video"===n.name||"audio"===n.name)&&a.src&&n.src.push(a.src):this.options.domain=a.href);const e=this.parseStyle(t);if("img"===t.name){if(a.src&&(a.src.includes("webp")&&(t.webp="T"),a.src.includes("data:")&&"all"!==this.options.previewImg&&!a["original-src"]&&(a.ignore="T"),!a.ignore||t.webp||a.src.includes("cloud://"))){for(let i=this.stack.length;i--;){const n=this.stack[i];"a"===n.name&&(t.a=n.attrs),"table"!==n.name||t.webp||a.src.includes("cloud://")||(!e.display||e.display.includes("inline")?t.t="inline-block":t.t=e.display,e.display=void 0),n.c=1}a.i=this.imgList.length.toString();let n=a["original-src"]||a.src;this.imgList.push(n),t.t||(this.imgList._unloadimgs+=1),this.options.lazyLoad&&(a["data-src"]=a.src,a.src=void 0)}"inline"===e.display&&(e.display=""),a.ignore&&(e["max-width"]=e["max-width"]||"100%",a.style+=";-webkit-touch-callout:none"),parseInt(e.width)>Ka&&(e.height=void 0),isNaN(parseInt(e.width))||(t.w="T"),!isNaN(parseInt(e.height))&&(!e.height.includes("%")||n&&(n.attrs.style||"").includes("height"))&&(t.h="T"),t.w&&t.h&&e["object-fit"]&&("contain"===e["object-fit"]?t.m="aspectFit":"cover"===e["object-fit"]&&(t.m="aspectFill"))}else if("svg"===t.name)return i.push(t),this.stack.push(t),void this.popNode();for(const t in e)e[t]&&(a.style+=`;${t}:${e[t].replace(" !important","")}`);a.style=a.style.substr(1)||void 0}else("pre"===t.name||(a.style||"").includes("white-space")&&a.style.includes("pre"))&&2!==this.pre&&(this.pre=t.pre=1),t.children=[],this.stack.push(t);i.push(t)},an.prototype.onCloseTag=function(e){let t;for(e=this.xml?e:e.toLowerCase(),t=this.stack.length;t--&&this.stack[t].name!==e;);if(-1!==t)for(;this.stack.length>t;)this.popNode();else if("p"===e||"br"===e){(this.stack.length?this.stack[this.stack.length-1].children:this.nodes).push({name:e,attrs:{class:Ga[e]||"",style:this.tagStyle[e]||""}})}},an.prototype.popNode=function(){const e=this.stack.pop();let t=e.attrs;const a=e.children,n=this.stack[this.stack.length-1],i=n?n.children:this.nodes;if(!this.hook(e)||Ya.ignoreTags[e.name])return"title"===e.name&&a.length&&"text"===a[0].type&&this.options.setTitle&&uni.setNavigationBarTitle({title:a[0].text}),void i.pop();if(e.pre&&2!==this.pre){this.pre=e.pre=void 0;for(let e=this.stack.length;e--;)this.stack[e].pre&&(this.pre=1)}const o={};if("svg"===e.name){if(this.xml>1)return void this.xml--;let a="";const n=t.style;return t.style="",t.xmlns="http://www.w3.org/2000/svg",function e(t){if("text"===t.type)return void(a+=t.text);const n=Ya.svgDict[t.name]||t.name;if("foreignObject"===n)for(const a of t.children||[])if(a.attrs&&!a.attrs.xmlns){a.attrs.xmlns="http://www.w3.org/1999/xhtml";break}a+="<"+n;for(const i in t.attrs){const e=t.attrs[i];e&&(a+=` ${Ya.svgDict[i]||i}="${e.replace(/"/g,"")}"`)}if(t.children){a+=">";for(let a=0;a<t.children.length;a++)e(t.children[a]);a+="</"+n+">"}else a+="/>"}(e),e.name="img",e.attrs={src:"data:image/svg+xml;utf8,"+a.replace(/#/g,"%23"),style:n,ignore:"T"},e.children=void 0,this.xml=!1,void(Ya.ignoreTags.style=!0)}if(t.align&&("table"===e.name?"center"===t.align?o["margin-inline-start"]=o["margin-inline-end"]="auto":o.float=t.align:o["text-align"]=t.align,t.align=void 0),t.dir&&(o.direction=t.dir,t.dir=void 0),"font"===e.name&&(t.color&&(o.color=t.color,t.color=void 0),t.face&&(o["font-family"]=t.face,t.face=void 0),t.size)){let e=parseInt(t.size);isNaN(e)||(e<1?e=1:e>7&&(e=7),o["font-size"]=["x-small","small","medium","large","x-large","xx-large","xxx-large"][e-1]),t.size=void 0}if((t.class||"").includes("align-center")&&(o["text-align"]="center"),Object.assign(o,this.parseStyle(e)),"table"!==e.name&&parseInt(o.width)>Ka&&(o["max-width"]="100%",o["box-sizing"]="border-box"),Ya.blockTags[e.name]?e.name="div":Ya.trustTags[e.name]||this.xml||(e.name="span"),"a"===e.name||"ad"===e.name||"iframe"===e.name)this.expose();else if("video"===e.name){(o.height||"").includes("auto")&&(o.height=void 0);let a='<video style="width:100%;height:100%"';for(const e in t)t[e]&&(a+=" "+e+'="'+t[e]+'"');this.options.pauseVideo&&(a+=" onplay=\"this.dispatchEvent(new CustomEvent('vplay',{bubbles:!0}));for(var e=document.getElementsByTagName('video'),t=0;t<e.length;t++)e[t]!=this&&e[t].pause()\""),a+=">";for(let t=0;t<e.src.length;t++)a+='<source src="'+e.src[t]+'">';a+="</video>",e.html=a}else if("ul"!==e.name&&"ol"!==e.name||!e.c)if("table"===e.name){let n=parseFloat(t.cellpadding),i=parseFloat(t.cellspacing);const s=parseFloat(t.border),l=o["border-color"],r=o["border-style"];if(e.c&&(isNaN(n)&&(n=2),isNaN(i)&&(i=2)),s&&(t.style+=`;border:${s}px ${r||"solid"} ${l||"gray"}`),e.flag&&e.c){o.display="grid","collapse"===o["border-collapse"]&&(o["border-collapse"]=void 0,i=0),i?(o["grid-gap"]=i+"px",o.padding=i+"px"):s&&(t.style+=";border-left:0;border-top:0");const c=[],d=[],u=[],m={};!function e(t){for(let a=0;a<t.length;a++)if("tr"===t[a].name)d.push(t[a]);else if("colgroup"===t[a].name){let e=1;for(const n of t[a].children||[])if("col"===n.name){const t=n.attrs.style||"",a=t.indexOf("width")?t.indexOf(";width"):0;if(-1!==a){let n=t.indexOf(";",a+6);-1===n&&(n=t.length),c[e]=t.substring(a?a+7:6,n)}e+=1}}else e(t[a].children||[])}(a);for(let e=1;e<=d.length;e++){let t=1;for(let a=0;a<d[e-1].children.length;a++){const o=d[e-1].children[a];if("td"===o.name||"th"===o.name){for(;m[e+"."+t];)t++;let a=o.attrs.style||"",d=a.indexOf("width")?a.indexOf(";width"):0;if(-1!==d){let e=a.indexOf(";",d+6);-1===e&&(e=a.length),o.attrs.colspan||(c[t]=a.substring(d?d+7:6,e)),a=a.substr(0,d)+a.substr(e)}if(a+=";display:flex",d=a.indexOf("vertical-align"),-1!==d){const e=a.substr(d+15,10);e.includes("middle")?a+=";align-items:center":e.includes("bottom")&&(a+=";align-items:flex-end")}else a+=";align-items:center";if(d=a.indexOf("text-align"),-1!==d){const e=a.substr(d+11,10);e.includes("center")?a+=";justify-content: center":e.includes("right")&&(a+=";justify-content: right")}if(a=(s?`;border:${s}px ${r||"solid"} ${l||"gray"}`+(i?"":";border-right:0;border-bottom:0"):"")+(n?`;padding:${n}px`:"")+";"+a,o.attrs.colspan&&(a+=`;grid-column-start:${t};grid-column-end:${t+parseInt(o.attrs.colspan)}`,o.attrs.rowspan||(a+=`;grid-row-start:${e};grid-row-end:${e+1}`),t+=parseInt(o.attrs.colspan)-1),o.attrs.rowspan){a+=`;grid-row-start:${e};grid-row-end:${e+parseInt(o.attrs.rowspan)}`,o.attrs.colspan||(a+=`;grid-column-start:${t};grid-column-end:${t+1}`);for(let a=1;a<o.attrs.rowspan;a++)for(let n=0;n<(o.attrs.colspan||1);n++)m[e+a+"."+(t-n)]=1}a&&(o.attrs.style=a),u.push(o),t++}}if(1===e){let e="";for(let a=1;a<t;a++)e+=(c[a]?c[a]:"auto")+" ";o["grid-template-columns"]=e}}e.children=u}else e.c&&(o.display="table"),isNaN(i)||(o["border-spacing"]=i+"px"),(s||n)&&function e(t){for(let a=0;a<t.length;a++){const i=t[a];"th"===i.name||"td"===i.name?(s&&(i.attrs.style=`border:${s}px ${r||"solid"} ${l||"gray"};${i.attrs.style||""}`),n&&(i.attrs.style=`padding:${n}px;${i.attrs.style||""}`)):i.children&&e(i.children)}}(a);if(this.options.scrollTable&&!(t.style||"").includes("inline")){const a=Object.assign({},e);e.name="div",e.attrs={style:"overflow:auto"},e.children=[a],t=a.attrs}}else if(("tbody"===e.name||"tr"===e.name)&&e.flag&&e.c)e.flag=void 0,function e(t){for(let a=0;a<t.length;a++)if("td"===t[a].name)for(const e of["color","background","background-color"])o[e]&&(t[a].attrs.style=e+":"+o[e]+";"+(t[a].attrs.style||""));else e(t[a].children||[])}(a);else if("td"!==e.name&&"th"!==e.name||!t.colspan&&!t.rowspan)if("ruby"===e.name){e.name="span";for(let e=0;e<a.length-1;e++)"text"===a[e].type&&"rt"===a[e+1].name&&(a[e]={name:"div",attrs:{style:"display:inline-block;text-align:center"},children:[{name:"div",attrs:{style:"font-size:50%;"+(a[e+1].attrs.style||"")},children:a[e+1].children},a[e]]},a.splice(e+1,1))}else e.c&&function e(t){t.c=2;for(let a=t.children.length;a--;){const n=t.children[a];n.name&&(Ya.inlineTags[n.name]||(n.attrs.style||"").includes("inline")&&n.children)&&!n.c&&e(n),n.c&&"table"!==n.name||(t.c=1)}}(e);else for(let l=this.stack.length;l--;)"table"!==this.stack[l].name&&"tbody"!==this.stack[l].name&&"tr"!==this.stack[l].name||(this.stack[l].flag=1);else{const e={a:"lower-alpha",A:"upper-alpha",i:"lower-roman",I:"upper-roman"};e[t.type]&&(t.style+=";list-style-type:"+e[t.type],t.type=void 0);for(let t=a.length;t--;)"li"===a[t].name&&(a[t].c=1)}if((o.display||"").includes("flex")&&!e.c)for(let l=a.length;l--;){const e=a[l];e.f&&(e.attrs.style=(e.attrs.style||"")+e.f,e.f=void 0)}const s=n&&((n.attrs.style||"").includes("flex")||(n.attrs.style||"").includes("grid"))&&!e.c;s&&(e.f=";max-width:100%"),a.length>=50&&e.c&&!(o.display||"").includes("flex")&&tn(a);for(const l in o)if(o[l]){const a=`;${l}:${o[l].replace(" !important","")}`;s&&(l.includes("flex")&&"flex-direction"!==l||"align-self"===l||l.includes("grid")||"-"===o[l][0]||l.includes("width")&&a.includes("%"))?(e.f+=a,"width"===l&&(t.style+=";width:100%")):t.style+=a}t.style=t.style.substr(1)||void 0},an.prototype.onText=function(e){if(!this.pre){let t,a="";for(let n=0,i=e.length;n<i;n++)Qa[e[n]]?(" "!==a[a.length-1]&&(a+=" "),"\n"!==e[n]||t||(t=!0)):a+=e[n];if(" "===a){if(t)return;{const e=this.stack[this.stack.length-1];if(e&&"t"===e.name[0])return}}e=a}const t=Object.create(null);if(t.type="text",t.text=en(e),this.hook(t)){(this.stack.length?this.stack[this.stack.length-1].children:this.nodes).push(t)}},nn.prototype.parse=function(e){this.content=e||"",this.i=0,this.start=0,this.state=this.text;for(let t=this.content.length;-1!==this.i&&this.i<t;)this.state()},nn.prototype.checkClose=function(e){const t="/"===this.content[this.i];return!!(">"===this.content[this.i]||t&&">"===this.content[this.i+1])&&(e&&this.handler[e](this.content.substring(this.start,this.i)),this.i+=t?2:1,this.start=this.i,this.handler.onOpenTag(t),"script"===this.handler.tagName?(this.i=this.content.indexOf("</",this.i),-1!==this.i&&(this.i+=2,this.start=this.i),this.state=this.endTag):this.state=this.text,!0)},nn.prototype.text=function(){if(this.i=this.content.indexOf("<",this.i),-1===this.i)return void(this.start<this.content.length&&this.handler.onText(this.content.substring(this.start,this.content.length)));const e=this.content[this.i+1];if(e>="a"&&e<="z"||e>="A"&&e<="Z")this.start!==this.i&&this.handler.onText(this.content.substring(this.start,this.i)),this.start=++this.i,this.state=this.tagName;else if("/"===e||"!"===e||"?"===e){this.start!==this.i&&this.handler.onText(this.content.substring(this.start,this.i));const t=this.content[this.i+2];if("/"===e&&(t>="a"&&t<="z"||t>="A"&&t<="Z"))return this.i+=2,this.start=this.i,void(this.state=this.endTag);let a="--\x3e";"!"===e&&"-"===this.content[this.i+2]&&"-"===this.content[this.i+3]||(a=">"),this.i=this.content.indexOf(a,this.i),-1!==this.i&&(this.i+=a.length,this.start=this.i)}else this.i++},nn.prototype.tagName=function(){if(Qa[this.content[this.i]]){for(this.handler.onTagName(this.content.substring(this.start,this.i));Qa[this.content[++this.i]];);this.i<this.content.length&&!this.checkClose()&&(this.start=this.i,this.state=this.attrName)}else this.checkClose("onTagName")||this.i++},nn.prototype.attrName=function(){let e=this.content[this.i];if(Qa[e]||"="===e){this.handler.onAttrName(this.content.substring(this.start,this.i));let t="="===e;const a=this.content.length;for(;++this.i<a;)if(e=this.content[this.i],!Qa[e]){if(this.checkClose())return;if(t)return this.start=this.i,void(this.state=this.attrVal);if("="!==this.content[this.i])return this.start=this.i,void(this.state=this.attrName);t=!0}}else this.checkClose("onAttrName")||this.i++},nn.prototype.attrVal=function(){const e=this.content[this.i],t=this.content.length;if('"'===e||"'"===e){if(this.start=++this.i,this.i=this.content.indexOf(e,this.i),-1===this.i)return;this.handler.onAttrVal(this.content.substring(this.start,this.i))}else for(;this.i<t;this.i++){if(Qa[this.content[this.i]]){this.handler.onAttrVal(this.content.substring(this.start,this.i));break}if(this.checkClose("onAttrVal"))return}for(;Qa[this.content[++this.i]];);this.i<t&&!this.checkClose()&&(this.start=this.i,this.state=this.attrName)},nn.prototype.endTag=function(){const e=this.content[this.i];if(Qa[e]||">"===e||"/"===e){if(this.handler.onCloseTag(this.content.substring(this.start,this.i)),">"!==e&&(this.i=this.content.indexOf(">",this.i),-1===this.i))return;this.start=++this.i,this.state=this.text}else this.i++};const on=[];const sn=d({name:"mp-html",data:()=>({nodes:[]}),props:{containerStyle:{type:String,default:""},content:{type:String,default:""},copyLink:{type:[Boolean,String],default:!0},domain:String,errorImg:{type:String,default:""},lazyLoad:{type:[Boolean,String],default:!1},loadingImg:{type:String,default:""},pauseVideo:{type:[Boolean,String],default:!0},previewImg:{type:[Boolean,String],default:!0},scrollTable:[Boolean,String],selectable:[Boolean,String],setTitle:{type:[Boolean,String],default:!0},showImgMenu:{type:[Boolean,String],default:!0},tagStyle:Object,useAnchor:[Boolean,Number]},emits:["load","ready","imgtap","linktap","play","error"],components:{node:qa},watch:{content(e){this.setContent(e)}},created(){this.plugins=[];for(let e=on.length;e--;)this.plugins.push(new on[e](this))},mounted(){this.content&&!this.nodes.length&&this.setContent(this.content)},beforeDestroy(){this._hook("onDetached")},methods:{in(e,t,a){e&&t&&a&&(this._in={page:e,selector:t,scrollTop:a})},navigateTo(e,t){return new Promise(((a,n)=>{if(!this.useAnchor)return void n(Error("Anchor is disabled"));t=t||parseInt(this.useAnchor)||0;const i=uni.createSelectorQuery().in(this._in?this._in.page:this).select((this._in?this._in.selector:"._root")+(e?` #${e}`:"")).boundingClientRect();this._in?i.select(this._in.selector).scrollOffset().select(this._in.selector).boundingClientRect():i.selectViewport().scrollOffset(),i.exec((e=>{if(!e[0])return void n(Error("Label not found"));const i=e[1].scrollTop+e[0].top-(e[2]?e[2].top:0)+t;this._in?this._in.page[this._in.scrollTop]=i:uni.pageScrollTo({scrollTop:i,duration:300}),a()}))}))},getText(e){let t="";return function e(a){for(let n=0;n<a.length;n++){const i=a[n];if("text"===i.type)t+=i.text.replace(/&amp;/g,"&");else if("br"===i.name)t+="\n";else{const a="p"===i.name||"div"===i.name||"tr"===i.name||"li"===i.name||"h"===i.name[0]&&i.name[1]>"0"&&i.name[1]<"7";a&&t&&"\n"!==t[t.length-1]&&(t+="\n"),i.children&&e(i.children),a&&"\n"!==t[t.length-1]?t+="\n":"td"!==i.name&&"th"!==i.name||(t+="\t")}}}(e||this.nodes),t},getRect(){return new Promise(((e,t)=>{uni.createSelectorQuery().in(this).select("#_root").boundingClientRect().exec((a=>a[0]?e(a[0]):t(Error("Root label not found"))))}))},pauseMedia(){for(let t=(this._videos||[]).length;t--;)this._videos[t].pause();let e=this.$parent;for(;!e.$scope;)e=e.$parent;e.$scope.$getAppWebview().evalJS('for(var e=document.getElementsByTagName("video"),i=e.length;i--;)e[i].pause()')},setPlaybackRate(e){this.playbackRate=e;for(let n=(this._videos||[]).length;n--;)this._videos[n].playbackRate(e);const t='for(var e=document.getElementsByTagName("video"),i=e.length;i--;)e[i].playbackRate='+e;let a=this.$parent;for(;!a.$scope;)a=a.$parent;a.$scope.$getAppWebview().evalJS(t)},setContent(e,t){t&&this.imgList||(this.imgList=[]);const a=new an(this).parse(e);if(this.$set(this,"nodes",t?(this.nodes||[]).concat(a):a),this._videos=[],this.$nextTick((()=>{this._hook("onLoad"),this.$emit("load")})),this.lazyLoad||this.imgList._unloadimgs<this.imgList.length/2){let e=0;const t=a=>{a&&a.height||(a={}),a.height===e?this.$emit("ready",a):(e=a.height,setTimeout((()=>{this.getRect().then(t).catch(t)}),350))};this.getRect().then(t).catch(t)}else this.imgList._unloadimgs||this.getRect().then((e=>{this.$emit("ready",e)})).catch((()=>{this.$emit("ready",{})}))},_hook(e){for(let t=on.length;t--;)this.plugins[t][e]&&this.plugins[t][e]()}}},[["render",function(t,a,n,i,o,s){const l=e.resolveComponent("node");return e.openBlock(),e.createElementBlock("view",{id:"_root",class:e.normalizeClass((n.selectable?"_select ":"")+"_root"),style:e.normalizeStyle(n.containerStyle)},[o.nodes[0]?(e.openBlock(),e.createBlock(l,{key:1,childs:o.nodes,opts:[n.lazyLoad,n.loadingImg,n.errorImg,n.showImgMenu,n.selectable],name:"span"},null,8,["childs","opts"])):e.renderSlot(t.$slots,"default",{key:0},void 0,!0)],6)}],["__scopeId","data-v-59277af2"]]),ln=d(e.defineComponent({__name:"CommentItem",props:{data:{},isReply:{type:Boolean}},emits:["react","reply","edit","delete"],setup(t,{emit:n}){const i=t;Zt();const o=e.computed((()=>!0===i.data.isMe)),s={p:"font-size: 14px; line-height: 1.5; color: #374151; margin: 0; margin-bottom: 2px;",div:"font-size: 14px; line-height: 1.5; color: #374151;",span:"font-size: 14px; line-height: 1.5; color: #374151;",a:"color: #007aff; text-decoration: none; font-size: 14px;",img:"max-width: 100%; border-radius: 6px; margin-top: 4px;"},l=e=>{const t=e.href||e["data-src"]||e.src;t&&(a("log","at components/Todo/CommentItem.vue:137","Mở link:",t),Oa(t))},r=e.computed((()=>{const e=i.data.message||"";if("UPDATE_TODO"===i.data.type&&e.includes("->")){const t=e.lastIndexOf("->");if(-1!==t){const a=e.substring(0,t).trim(),n=e.substring(t+2).trim(),i=a.match(/^<p>(- .*?:)/)||a.match(/^(- .*?:)/);let o="",s=a;return i&&(o=i[1].replace(/<p>|:$/g,"").trim()+":",s=a.replace(i[0],"").trim(),s.startsWith("</p>")&&(s=s.substring(4))),{isUpdate:!0,label:o,oldRaw:s,newRaw:n}}}return{isUpdate:!1}}));return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"comment-thread"},[e.createElementVNode("view",{class:"flex gap-3 mb-4 items-start"},[e.createVNode(u,{name:t.data.senderName,"avatar-color":t.data.senderAvatarColor,size:t.isReply?30:40,class:e.normalizeClass(["shrink-0",t.isReply?"mr-2":"mr-3"])},null,8,["name","avatar-color","size","class"]),e.createElementVNode("view",{class:"flex-1 overflow-hidden"},[e.createElementVNode("view",{class:"bg-gray-50 rounded-2xl p-3 rounded-tl-none relative"},[e.createElementVNode("view",{class:"flex justify-between items-start mb-1"},[e.createElementVNode("text",{class:"font-bold text-sm text-gray-900"},e.toDisplayString(t.data.senderName),1),e.createElementVNode("view",{class:"flex items-center"},[e.createElementVNode("text",{class:"text-xs text-gray-400"},e.toDisplayString(t.data.timeDisplay),1),t.data.isEdited?(e.openBlock(),e.createElementBlock("text",{key:0,class:"text-xs text-gray-400 italic ml-1"}," • Đã sửa ")):e.createCommentVNode("",!0)])]),r.value.isUpdate?(e.openBlock(),e.createElementBlock("view",{key:0,class:"content-body"},[e.createElementVNode("text",{class:"font-bold text-sm text-gray-700 block mb-1"},e.toDisplayString(r.value.label),1),e.createElementVNode("view",{class:"change-flow"},[e.createElementVNode("view",{class:"part-container"},[e.createVNode(sn,{content:r.value.oldRaw,"copy-link":!1,"tag-style":s,"container-style":"font-size: 14px; color: #374151; line-height: 1.5;",onLinktap:l},null,8,["content"])]),e.createElementVNode("view",{class:"arrow-container"},[e.createElementVNode("text",{class:"arrow-text"},"→")]),e.createElementVNode("view",{class:"part-container"},[e.createVNode(sn,{content:r.value.newRaw,"copy-link":!1,"tag-style":s,"container-style":"font-size: 14px; color: #374151; line-height: 1.5;",onLinktap:l},null,8,["content"])])])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"content-body"},[e.createVNode(sn,{content:t.data.message,"copy-link":!1,"tag-style":s,"container-style":"font-size: 14px; color: #374151; line-height: 1.5;",onLinktap:l},null,8,["content"]),t.data.files?(e.openBlock(),e.createElementBlock("view",{key:0,class:"mt-2"},[e.createElementVNode("image",{src:t.data.files,mode:"widthFix",class:"comment-attachment-img",onClick:a[0]||(a[0]=e.withModifiers((e=>{var a;(a=t.data.files)&&uni.previewImage({urls:[a],current:0})}),["stop"]))},null,8,["src"])])):e.createCommentVNode("",!0)]))]),e.createElementVNode("view",{class:"c-footer-actions"},[e.createElementVNode("view",{class:"reaction-row"},[t.data.reactions&&t.data.reactions.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"flex gap-1 mt-1"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.data.reactions,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"emoji-tag"},e.toDisplayString(t.codeEmoji),1)))),128))])):e.createCommentVNode("",!0)]),"COMMENT"===t.data.type?(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-buttons-container"},[e.createElementVNode("view",{class:"btn-icon-action",onClick:a[1]||(a[1]=e=>t.$emit("react",t.data))},[e.createElementVNode("image",{src:"/static/reaction.png",class:"icon-action"})]),e.createElementVNode("view",{class:"btn-icon-action",onClick:a[2]||(a[2]=e=>t.$emit("reply",t.data))},[e.createElementVNode("image",{src:"/static/reply_comment.png",class:"icon-action"})]),o.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("view",{class:"btn-icon-action",onClick:a[3]||(a[3]=e=>t.$emit("edit",t.data))},[e.createElementVNode("image",{src:"/static/edit_comment.png",class:"icon-action"})]),e.createElementVNode("view",{class:"btn-icon-action",onClick:a[4]||(a[4]=e=>t.$emit("delete",t.data.id))},[e.createElementVNode("image",{src:"/static/delete.png",class:"icon-action"})])],64)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)])])]),t.data.children&&t.data.children.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"pl-12 mt-2 replies-wrapper"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.data.children,(n=>(e.openBlock(),e.createBlock(ln,{key:n.id,data:n,"is-reply":!0,onReact:a[5]||(a[5]=e=>t.$emit("react",e)),onReply:a[6]||(a[6]=e=>t.$emit("reply",e)),onEdit:a[7]||(a[7]=e=>t.$emit("edit",e)),onDelete:a[8]||(a[8]=e=>t.$emit("delete",e))},null,8,["data"])))),128))])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-05db9b4a"]]),rn=d(e.defineComponent({__name:"todo_detail",setup(t){const{isLoading:a,isLoadingCustomer:n,isLoadingHistory:i,historyList:o,form:s,statusOptions:l,sourceOptions:r,assigneeOptions:c,onStatusChange:d,onSourceChange:u,onAssigneeChange:m,saveTodo:h,historyFilterOptions:p,historyFilterIndex:g,onHistoryFilterChange:f,comments:v,isLoadingComments:_,newCommentText:y,isSubmittingComment:k,submitComment:b,isConfirmDeleteCommentOpen:w,onRequestDeleteComment:D,confirmDeleteComment:S,cancelDeleteComment:C,currentUserId:N,isEditingComment:T,onRequestEditComment:E,submitUpdateComment:x,onCancelEditComment:V,isConfirmCancelEditOpen:$,continueEditing:B,confirmCancelEdit:M,editingMemberName:I,isEmojiPickerOpen:R,emojiList:O,onToggleEmojiPicker:F,closeEmojiPicker:A,selectEmoji:L,isReplying:P,replyingMemberName:z,replyingCommentData:U,onRequestReply:j,onCancelReply:H,submitReply:W,isConfirmCancelReplyOpen:q,continueReplying:Y,confirmCancelReply:G,commentFilterIndex:K,commentFilterOptions:J,onCommentFilterChange:Q,isSavingDescription:X,onSaveDescription:Z,onDateUpdate:ee,isStatusDisabled:te,onSaveTitle:ae,replyingMessagePreview:ne,isHistoryOpen:ie,toggleHistory:oe}=ja(),se=e.ref(!1);e.ref("");const le=()=>{se.value=!se.value},re=e.ref(null),ce=()=>{se.value||(se.value=!0),setTimeout((()=>{uni.createSelectorQuery().select("#comment-input-anchor").boundingClientRect((e=>{e&&uni.createSelectorQuery().selectViewport().scrollOffset((t=>{if(t){let a=t.scrollTop+e.top-100;uni.pageScrollTo({scrollTop:a,duration:300})}})).exec()})).exec()}),150)};return(t,u)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.unref(a)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-bar"})):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"detail-header"},[e.createElementVNode("view",{class:"header-top"},[e.createElementVNode("text",{class:"header-code"},"#"+e.toDisplayString(e.unref(s).code||"..."),1)]),e.withDirectives(e.createElementVNode("textarea",{class:"header-title-input","onUpdate:modelValue":u[0]||(u[0]=t=>e.unref(s).title=t),placeholder:t.$t("todo.header_loading"),"auto-height":"",maxlength:"256","confirm-type":"done",onConfirm:u[1]||(u[1]=(...t)=>e.unref(ae)&&e.unref(ae)(...t)),onBlur:u[2]||(u[2]=(...t)=>e.unref(ae)&&e.unref(ae)(...t))},null,40,["placeholder"]),[[e.vModelText,e.unref(s).title]])]),e.createElementVNode("view",{class:"detail-body"},[e.createElementVNode("view",{class:"section-title"},e.toDisplayString(t.$t("todo.desc_section")),1),e.createElementVNode("view",{class:"section-block"},[e.createVNode(Aa,{modelValue:e.unref(s).desc,"onUpdate:modelValue":u[3]||(u[3]=t=>e.unref(s).desc=t),placeholder:t.$t("todo.desc_placeholder")},null,8,["modelValue","placeholder"]),e.createElementVNode("view",{class:"input-actions",style:{"margin-top":"10px"}},[e.createVNode(Sa,{type:"primary",size:"small",loading:e.unref(X),label:e.unref(X)?t.$t("common.saving"):t.$t("common.save"),onClick:e.unref(Z)},null,8,["loading","label","onClick"])])]),e.createElementVNode("view",{class:"section-title"},e.toDisplayString(t.$t("todo.info_section")),1),e.createElementVNode("view",{class:"info-group"},[e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"/static/checked-checkbox.png",class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(t.$t("todo.status")),1)]),e.createElementVNode("picker",{mode:"selector",range:e.unref(l),value:e.unref(s).statusIndex,disabled:e.unref(te),onChange:u[4]||(u[4]=(...t)=>e.unref(d)&&e.unref(d)(...t)),class:"item-picker-box"},[e.createElementVNode("view",{class:e.normalizeClass(["picker-text",{"disabled-text":e.unref(te)}])},[e.createTextVNode(e.toDisplayString(e.unref(l)[e.unref(s).statusIndex]||t.$t("common.loading"))+" ",1),e.unref(te)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("text",{key:0},"▾"))],2)],40,["range","value","disabled"])]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"/static/internet.png",class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(t.$t("todo.source")),1)]),e.createElementVNode("view",{class:"item-picker-box"},[e.createElementVNode("view",{class:"picker-text disabled-text"},e.toDisplayString(e.unref(r)[e.unref(s).sourceIndex]||"..."),1)])]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"/static/user.png",class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(t.$t("todo.assignee")),1)]),e.createElementVNode("picker",{mode:"selector",range:e.unref(c),value:e.unref(s).assigneeIndex,onChange:u[5]||(u[5]=(...t)=>e.unref(m)&&e.unref(m)(...t)),class:"item-picker-box"},[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(e.unref(c).length>0&&e.unref(s).assigneeIndex>-1?e.unref(c)[e.unref(s).assigneeIndex]:t.$t("common.loading"))+" ▾ ",1)],40,["range","value"])]),e.createVNode(La,{dueDate:e.unref(s).dueDate,"onUpdate:dueDate":u[6]||(u[6]=t=>e.unref(s).dueDate=t),notifyAt:e.unref(s).notifyAt,"onUpdate:notifyAt":u[7]||(u[7]=t=>e.unref(s).notifyAt=t),onChange:e.unref(ee)},null,8,["dueDate","notifyAt","onChange"])]),e.createElementVNode("view",{class:"section-title"},e.toDisplayString(t.$t("todo.customer_section")),1),e.createElementVNode("view",{class:"info-group customer-block"},[e.unref(n)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-row"},[e.createElementVNode("text",{class:"loading-text"},e.toDisplayString(t.$t("todo.loading_crm")),1)])):e.unref(s).customerCode?(e.openBlock(),e.createElementBlock("view",{key:2},[e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"/static/user-male-circle.png",class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(e.unref(s).customerNameLabel||t.$t("todo.customer_name_label")),1)]),e.createElementVNode("view",{class:"item-right-text"},e.toDisplayString(e.unref(s).customerName),1)]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"/static/phone.png",class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(e.unref(s).customerPhoneLabel||t.$t("todo.customer_phone_label")),1)]),e.createElementVNode("view",{class:"item-right-text phone-text"},e.toDisplayString(e.unref(s).customerPhone),1)]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"/static/manager.png",class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(e.unref(s).customerManagerLabel||t.$t("todo.customer_manager_label")),1)]),e.createElementVNode("view",{class:"item-right-text highlight-text"},e.toDisplayString(e.unref(s).customerManagerName||t.$t("todo.manager_none")),1)])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-row"},[e.createElementVNode("text",null,e.toDisplayString(t.$t("todo.no_customer_attached")),1)]))]),e.createElementVNode("view",{class:"section-header-row"},[e.createElementVNode("view",{class:"toggle-header",onClick:le},[e.createElementVNode("text",{class:"section-title no-margin"},e.toDisplayString(t.$t("todo.comments_activities")),1),e.createElementVNode("image",{src:za,class:e.normalizeClass(["toggle-icon",{open:se.value}])},null,2)]),e.createElementVNode("picker",{mode:"selector",range:e.unref(J),value:e.unref(K),onClick:u[8]||(u[8]=e.withModifiers((()=>{}),["stop"])),onChange:u[9]||(u[9]=(...t)=>e.unref(Q)&&e.unref(Q)(...t))},[e.createElementVNode("view",{class:"filter-badge"},e.toDisplayString(e.unref(J)[e.unref(K)])+" ▾",1)],40,["range","value"])]),se.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"comments-section"},[e.createElementVNode("view",{class:"comment-input-block",id:"comment-input-anchor"},[e.createElementVNode("view",{class:"editor-container"},[e.createVNode(Aa,{ref_key:"todoEditorRef",ref:re,modelValue:e.unref(y),"onUpdate:modelValue":u[10]||(u[10]=t=>e.isRef(y)?y.value=t:null),placeholder:e.unref(T)?t.$t("todo.comment_placeholder_edit"):e.unref(P)?t.$t("todo.comment_placeholder_reply"):t.$t("todo.comment_placeholder_write")},null,8,["modelValue","placeholder"])]),e.unref(T)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"editing-alert"},[e.createElementVNode("text",{class:"editing-text"},[e.createTextVNode(e.toDisplayString(t.$t("todo.editing_alert"))+" ",1),e.createElementVNode("text",{class:"editing-name"},e.toDisplayString(e.unref(I)),1)])])):e.createCommentVNode("",!0),e.unref(P)&&e.unref(U)?(e.openBlock(),e.createElementBlock("view",{key:1,class:"reply-alert"},[e.createElementVNode("view",{class:"reply-info"},[e.createElementVNode("text",{class:"reply-label"},e.toDisplayString(t.$t("todo.replying_alert")),1),e.createElementVNode("text",{class:"reply-name"},e.toDisplayString(e.unref(z)),1)]),e.createElementVNode("view",{class:"reply-quote"},[e.createElementVNode("text",{class:"quote-icon"},"“"),e.createElementVNode("rich-text",{nodes:e.unref(ne),class:"quote-content"},null,8,["nodes"]),e.createElementVNode("text",{class:"quote-icon"},"”")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"input-actions"},[e.unref(T)||e.unref(P)?e.unref(T)?(e.openBlock(),e.createElementBlock("view",{key:1,class:"edit-actions-row"},[e.createVNode(Sa,{type:"secondary",size:"small",label:t.$t("common.cancel"),disabled:e.unref(k),onClick:e.unref(V)},null,8,["label","disabled","onClick"]),e.createVNode(Sa,{type:"primary",size:"small",loading:e.unref(k),label:e.unref(k)?t.$t("common.saving"):t.$t("todo.update_btn"),onClick:e.unref(x)},null,8,["loading","label","onClick"])])):e.unref(P)?(e.openBlock(),e.createElementBlock("view",{key:2,class:"edit-actions-row"},[e.createVNode(Sa,{type:"secondary",size:"small",label:t.$t("common.cancel"),disabled:e.unref(k),onClick:e.unref(H)},null,8,["label","disabled","onClick"]),e.createVNode(Sa,{type:"primary",size:"small",loading:e.unref(k),label:e.unref(k)?t.$t("common.saving"):t.$t("todo.reply_btn"),onClick:e.unref(W)},null,8,["loading","label","onClick"])])):e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(Sa,{key:0,type:"primary",size:"small",loading:e.unref(k),label:e.unref(k)?t.$t("common.saving"):t.$t("common.save"),onClick:e.unref(b)},null,8,["loading","label","onClick"]))])]),e.createElementVNode("view",{class:"divider-line"}),e.unref(_)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-row"},[e.createElementVNode("text",null,e.toDisplayString(t.$t("todo.loading_comments")),1)])):0===e.unref(v).length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-row"},[e.createElementVNode("text",null,e.toDisplayString(t.$t("todo.no_comments")),1)])):(e.openBlock(),e.createElementBlock("view",{key:2},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(v),(t=>(e.openBlock(),e.createBlock(ln,{key:t.id,data:t,onReact:e.unref(F),onReply:u[11]||(u[11]=e=>(e=>{j(e),ce()})(e)),onEdit:u[12]||(u[12]=e=>(e=>{E(e.id),ce()})(e)),onDelete:u[13]||(u[13]=t=>e.unref(D)(t))},null,8,["data","onReact"])))),128))]))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"section-header-row"},[e.createElementVNode("view",{class:"toggle-header",onClick:u[14]||(u[14]=(...t)=>e.unref(oe)&&e.unref(oe)(...t))},[e.createElementVNode("text",{class:"section-title no-margin"},e.toDisplayString(t.$t("todo.history_section")),1),e.createElementVNode("image",{src:za,class:e.normalizeClass(["toggle-icon",{open:e.unref(ie)}])},null,2)]),e.createElementVNode("picker",{mode:"selector",range:e.unref(p),value:e.unref(g),onClick:u[15]||(u[15]=e.withModifiers((()=>{}),["stop"])),onChange:u[16]||(u[16]=(...t)=>e.unref(f)&&e.unref(f)(...t))},[e.createElementVNode("view",{class:"filter-badge"},e.toDisplayString(e.unref(p)[e.unref(g)])+" ▾",1)],40,["range","value"])]),e.unref(ie)?(e.openBlock(),e.createElementBlock("view",{key:1,class:"history-container"},[e.unref(i)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-row"},[e.createElementVNode("text",{class:"loading-text"},e.toDisplayString(t.$t("todo.loading_history")),1)])):0===e.unref(o).length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-row"},[e.createElementVNode("text",null,e.toDisplayString(t.$t("todo.no_history")),1)])):(e.openBlock(),e.createElementBlock("view",{key:2,class:"timeline-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"timeline-item"},[a!==e.unref(o).length-1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"timeline-line"})):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"timeline-dot"}),e.createElementVNode("view",{class:"timeline-content"},[e.createElementVNode("view",{class:"timeline-header"},[e.createElementVNode("text",{class:"t-actor"},e.toDisplayString(t.actorName),1),e.createElementVNode("text",{class:"t-time"},e.toDisplayString(t.timeStr),1)]),e.createElementVNode("text",{class:"t-action"},e.toDisplayString(t.content),1)])])))),128))]))])):e.createCommentVNode("",!0),e.createElementVNode("view",{style:{height:"50px"}})]),e.createVNode(Na,{visible:e.unref($),"onUpdate:visible":u[17]||(u[17]=t=>e.isRef($)?$.value=t:null),title:t.$t("todo.cancel_edit_title"),message:t.$t("todo.cancel_edit_msg"),"cancel-label":t.$t("todo.continue_edit"),"confirm-label":t.$t("common.cancel_action"),"confirm-type":"danger",onCancel:e.unref(B),onConfirm:e.unref(M)},null,8,["visible","title","message","cancel-label","confirm-label","onCancel","onConfirm"]),e.createVNode(Na,{visible:e.unref(q),"onUpdate:visible":u[18]||(u[18]=t=>e.isRef(q)?q.value=t:null),title:t.$t("todo.cancel_reply_title"),message:t.$t("todo.cancel_reply_msg"),"cancel-label":t.$t("todo.continue_reply"),"confirm-label":t.$t("common.cancel_action"),"confirm-type":"danger",onCancel:e.unref(Y),onConfirm:e.unref(G)},null,8,["visible","title","message","cancel-label","confirm-label","onCancel","onConfirm"]),e.createVNode(Na,{visible:e.unref(w),"onUpdate:visible":u[19]||(u[19]=t=>e.isRef(w)?w.value=t:null),title:t.$t("todo.delete_comment_title"),message:t.$t("todo.delete_comment_msg"),"confirm-type":"danger",onConfirm:e.unref(S),onCancel:e.unref(C)},null,8,["visible","title","message","onConfirm","onCancel"]),e.unref(R)?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal-overlay",onClick:u[21]||(u[21]=(...t)=>e.unref(A)&&e.unref(A)(...t))},[e.createElementVNode("view",{class:"emoji-picker-container",onClick:u[20]||(u[20]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"emoji-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(O),((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"emoji-item",onClick:a=>e.unref(L)(t)},e.toDisplayString(t),9,["onClick"])))),128))])])])):e.createCommentVNode("",!0),e.createVNode(Ca),e.createVNode(Ea)]))}}),[["__scopeId","data-v-69ba562f"]]);__definePage("pages/todo/list_todo",xa),__definePage("pages/todo/create_todo",Pa),__definePage("pages/todo/todo_detail",rn);const cn=e.defineComponent({__name:"App",setup:e=>(l((async e=>{a("log","at App.vue:6","App Launch");const t=Zt();try{if(await t.initialize(e),t.isLoggedIn){const e=Xt();a("log","at App.vue:13","Auth OK -> Connecting Socket..."),e.connect()}}catch(n){a("error","at App.vue:17","Lỗi khởi tạo App:",n)}})),o((()=>{a("log","at App.vue:22","App Show");const e=Zt(),t=Xt();e.isLoggedIn&&!t.isConnected&&t.connect()})),s((()=>{a("log","at App.vue:31","App Hide")})),()=>{})});const{app:dn,Vuex:un,Pinia:mn}=function(){const t=e.createVueApp(cn);t.use(ft()),t.use(Qt);const a=Qt.global.locale.value||Qt.global.locale;return uni.setLocale(a),{app:t,Pinia:xt}}();uni.Vuex=un,uni.Pinia=mn,dn.provide("__globalStyles",__uniConfig.styles),dn._component.mpType="app",dn._component.render=()=>{},dn.mount("#app")}(Vue);
